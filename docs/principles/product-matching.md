# 제품 매칭 원리

> 분석 결과 기반 제품 추천의 과학적/도메인 근거
> **모듈**: PC-1, S-1, C-1, H-1, M-1 공통

---

## 1. 핵심 개념

### 1.1 분석-제품 매칭이란

사용자의 AI 분석 결과(피부타입, 퍼스널컬러, 체형 등)를 제품 속성과 교차하여
**개인에게 가장 적합한 제품을 점수화**하는 과정.

```
분석 결과 (UserProfile)
  + 제품 속성 (ProductAttributes)
  = 매칭 점수 (0-100)
  + 매칭 사유 (MatchReasons[])
```

### 1.2 매칭의 2축

| 축                | 설명                                           | 예시                    |
| ----------------- | ---------------------------------------------- | ----------------------- |
| **도메인 적합도** | 과학적/도메인 근거에 기반한 제품-사용자 호환성 | 건성 피부 → 보습 세럼   |
| **대중 신뢰도**   | 실제 구매자 평가에 기반한 제품 품질            | 리뷰 15,000개, 평점 4.5 |

두 축의 균형이 핵심. 도메인 적합도만 높으면 검증 안 된 제품이 추천되고,
대중 신뢰도만 높으면 개인 맞춤이 아닌 베스트셀러 나열이 됨.

---

## 2. 모듈별 매칭 원리

### 2.1 PC-1 퍼스널컬러 → 메이크업

**원리**: 4계절 색채 이론 (Seasonal Color Analysis)

사용자의 퍼스널컬러 시즌(Spring/Summer/Autumn/Winter)은
피부 언더톤(웜/쿨)과 명도/채도 조합으로 결정됨.

```
매칭 근거:
Spring (웜, 밝음) → 코랄, 피치, 골드 계열
Summer (쿨, 부드러움) → 로즈, 라벤더, 실버 계열
Autumn (웜, 깊음) → 테라코타, 브릭, 브론즈 계열
Winter (쿨, 선명) → 버건디, 와인, 플럼 계열
```

**제품 속성 매칭 필드**: `personal_color_seasons TEXT[]`
**과학적 근거**: [docs/principles/color-science.md](./color-science.md)

### 2.2 S-1 피부 → 스킨케어

**원리**: 피부 생리학 기반 성분 적합도

피부 타입(건성/지성/복합/민감/중성)과 피부 고민(여드름/노화/미백 등)에 따라
필요한 성분과 제형이 달라짐.

```
매칭 근거:
건성 → 세라마이드, 히알루론산, 크림 제형
지성 → 나이아신아마이드, BHA, 젤 제형
민감 → 판테놀, 센텔라, 무향 제형
여드름 → 살리실산, 티트리, 저자극 제형
```

**제품 속성 매칭 필드**: `skin_types TEXT[]`, `concerns TEXT[]`
**과학적 근거**: [docs/principles/skin-physiology.md](./skin-physiology.md)

### 2.3 C-1 체형 → 운동 기구

**원리**: 체형 역학 기반 근육군 타겟팅

체형 타입(X/A/V/H/O 등)에 따라 균형 잡힌 실루엣을 위한
우선 타겟 근육군이 다름.

```
매칭 근거:
A형 (하체 발달) → 어깨/등/가슴 강화 기구
V형 (상체 발달) → 하체/코어 강화 기구
H형 (일자) → 코어/하체/어깨 기구
O형 (중심 집중) → 전신/코어 기구
```

**제품 속성 매칭 필드**: `target_muscles TEXT[]`, `exercise_types TEXT[]`
**과학적 근거**: [docs/principles/body-mechanics.md](./body-mechanics.md)

### 2.4 H-1 헤어 → 헤어케어 (신규)

**원리**: 모발/두피 생리학

모발 타입(직모/곱슬/웨이브)과 두피 상태(건성/지성/민감)에 따라
필요한 세정력, 보습력, 성분이 다름.

```
매칭 근거:
건조모 + 건성두피 → 보습 샴푸, 오일 트리트먼트
손상모 → 케라틴/단백질 트리트먼트
지성두피 → 약산성 클렌징, 두피 스케일링
탈모 고민 → 탈모 방지 성분 (비오틴, 카페인)
```

**제품 속성 매칭 필드**: `hair_types TEXT[]`, `scalp_types TEXT[]`, `concerns TEXT[]`
**참고**: 현재 cosmetic_products에 헤어케어 카테고리 추가 필요

### 2.5 M-1 메이크업 → 메이크업 (상세)

**원리**: 색상 조화 + 얼굴 형태학

PC-1과 달리 M-1은 퍼스널컬러 외에도 얼굴형, 피부톤 분석 결과를 활용하여
더 세밀한 메이크업 제품 추천.

```
매칭 근거:
파운데이션 → 피부톤(undertone) + 커버력 니즈
컨투어링 → 얼굴형(둥근/긴/각진)에 따른 셰이딩 위치
립 → 퍼스널컬러 + 피부톤 보정
아이섀도 → 퍼스널컬러 + 눈 형태
```

**PC-1과의 차이**: PC-1은 "시즌 기반 전체 메이크업", M-1은 "부위별 세밀 추천"

---

## 3. 대중성 보정 원리

### 3.1 왜 필요한가

도메인 적합도만으로는 "성분은 맞지만 아무도 안 쓰는 제품"이 추천될 수 있음.
실제 구매 데이터(리뷰 수, 평점, 브랜드 인지도)로 보정하면
**검증된 제품 중에서 개인에게 맞는 것**을 추천.

### 3.2 보정 공식

```
최종 점수 = 도메인 점수(0-50) + 대중성 점수(0-50)

도메인 점수:
  피부타입 매칭: +30
  피부고민 매칭: +30 (매칭 비율 * 30)
  퍼스널컬러 매칭: +20

대중성 점수:
  가격 접근성: budget +15, mid +8, premium +0
  인기 브랜드: +12 (올리브영/화해 인기 브랜드)
  리뷰 수: 10K+ → +15, 5K+ → +12, 1K+ → +8
  평점: 4.5+ → +10, 4.0+ → +7, 3.5+ → +4
```

### 3.3 설명 가능성 (XAI)

모든 추천에는 **매칭 사유**가 함께 제공됨:

- "건성 피부에 적합해요"
- "가성비 좋은 제품이에요"
- "리뷰 15,000개 베스트셀러"

이는 RECOMMENDATION-ENGINE-RESEARCH.md의 XAI 연구 결과(신뢰도 M=4.1 vs 3.2)에 기반.

---

## 4. 어필리에이트 연동 시 원리

### 4.1 추천 독립성 원칙

**어필리에이트 커미션이 매칭 점수에 영향을 주지 않는다.**

```
금지: 커미션 높은 제품 점수 부풀리기
허용: 동점일 때 커미션 높은 제품 우선 (tiebreaker)
```

이 원칙은 사용자 신뢰를 위한 핵심 원칙이며,
"분석 결과에 맞는 제품"이라는 가치 제안의 기반.

### 4.2 데이터 소싱 우선순위

```
1. 파트너 API (실시간 가격, 이미지, 재고)
2. 시드 데이터 (수동 큐레이션, 검증된 제품)
3. 사용자 리뷰 데이터 (커뮤니티 기반)
```

---

## 5. 검증 방법

| 검증 항목     | 방법                            | 기준                 |
| ------------- | ------------------------------- | -------------------- |
| 매칭 정확도   | A/B 테스트 (추천 vs 랜덤)       | CTR 2x 이상          |
| 사용자 만족도 | 추천 평가 (좋아요/싫어요)       | 75%+ 긍정            |
| 설명 가능성   | 사유 표시 여부와 클릭률 상관    | XAI 있을 때 CTR +7%  |
| 다양성        | 추천 목록 내 브랜드/가격대 분포 | 단일 브랜드 50% 미만 |

---

## 6. 참고 자료

- [docs/principles/color-science.md](./color-science.md) — 색채학 원리
- [docs/principles/skin-physiology.md](./skin-physiology.md) — 피부 생리학
- [docs/principles/body-mechanics.md](./body-mechanics.md) — 체형 역학
- [RECOMMENDATION-ENGINE-RESEARCH.md](../research/claude-ai-research/RECOMMENDATION-ENGINE-RESEARCH.md) — 추천 엔진 리서치
- [AFFILIATE-API-COMPARISON-RESEARCH.md](../research/claude-ai-research/AFFILIATE-API-COMPARISON-RESEARCH.md) — 어필리에이트 API 비교

---

**Version**: 1.0 | **Created**: 2026-02-10
