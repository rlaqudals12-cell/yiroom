# 16. Claude 4.x 프롬프트 패턴 가이드

> version: 1.0
> last_updated: 2026-01-14
> source: Anthropic 2025-2026 베스트 프랙티스

---

## 🎯 Claude 4.x 핵심 특성

### 리터럴 해석 (Literal Interpretation)

Claude 4.x는 지시사항을 **문자 그대로** 해석합니다.

| 이전 버전 | Claude 4.x |
|----------|-----------|
| 의도를 추론하여 추가 기능 제공 | 명시된 것만 정확히 수행 |
| 모호한 지시도 "좋은 방향으로" 해석 | 모호하면 질문하거나 최소 해석 |
| 과소 트리거 경향 | 과잉 트리거 가능성 |

### 명시적 지시 필요

```
❌ 나쁜 예: "좋은 코드 작성해줘"
✅ 좋은 예: "TypeScript strict 모드, 에러 핸들링 포함, 
           한국어 주석으로 코드 작성해줘"

❌ 나쁜 예: "개선해줘"
✅ 좋은 예: "성능 최적화를 위해 불필요한 리렌더링 제거하고,
           React.memo 적용해줘"
```

---

## 📐 XML 태그 구조화

### 권장 태그 패턴

```xml
<!-- 역할 정의 -->
<role>시니어 풀스택 개발자</role>

<!-- 컨텍스트 제공 -->
<context>
  프로젝트: 이룸
  기술 스택: Next.js, Supabase
  현재 상태: Phase N 진행 중
</context>

<!-- 가이드라인 -->
<guidelines>
  - Spec-First 원칙
  - 한국어 주석 필수
</guidelines>

<!-- 제약사항 -->
<constraints>
  - 기존 코드 수정 시 승인 필요
  - 영구 제외 기능 재제안 금지
</constraints>

<!-- 출력 형식 -->
<output_format>
  1. 계획
  2. 코드
  3. 테스트
</output_format>

<!-- 예시 -->
<examples>
  <example>
    <input>...</input>
    <o>...</o>
  </example>
</examples>
```

### 태그 사용 원칙

1. **일관된 이름**: 전체 지침에서 동일한 태그명 사용
2. **자기 설명적**: `<code_style>` > `<cs>`
3. **중첩 최소화**: 2단계 이하 권장
4. **참조 시 태그명 사용**: "위 <constraints>에 따라..."

---

## 🎨 예시(Examples)의 힘

### Claude 4.x에서 예시가 중요한 이유

> "Examples are your secret weapon shortcut" - Anthropic

Claude 4.x는 예시의 **세부 패턴까지 학습**합니다:
- 코드 스타일
- 응답 길이
- 포맷팅 방식
- 어조와 톤

### 효과적인 예시 작성

```xml
<examples>
<example>
<input>운동 루틴 추천해줘</input>
<o>
## 📋 분석
- 체형: 역삼각형 (08-body-correction.md 참조)
- 목표: 하체 강화
- 보유 기구: 덤벨 5kg, 요가매트

## 🏋️ 추천 루틴 (캡슐 적용)
| 운동 | 세트 | 대체 옵션 |
|------|------|----------|
| 스쿼트 | 4x12 | 월 스쿼트 |
| 런지 | 3x10 | 스텝업 |

## ⚡ 다음 단계
상세 루틴표를 생성할까요?
</o>
</example>
</examples>
```

### 예시 체크리스트

- [ ] 실제 사용 케이스 반영
- [ ] 원하는 출력 형식 정확히 표현
- [ ] 엣지 케이스 포함 (3-5개 권장)
- [ ] 의도하지 않은 패턴 없는지 확인

---

## 🔄 "~하지 마" vs "~해라"

### 긍정형 지시가 효과적

```
❌ "마크다운 사용하지 마"
✅ "자연스러운 산문체로 작성해"

❌ "길게 쓰지 마"
✅ "3문장 이내로 요약해"

❌ "코드에 버그 만들지 마"
✅ "모든 에러 케이스에 대한 핸들링 포함해"
```

### 이룸 프로젝트 적용

```
❌ "신조어 쓰지 마"
✅ "모든 UI 텍스트는 일반적인 한국어로 작성해 (예: GMG → 목표 달성)"

❌ "기존 코드 건드리지 마"
✅ "기존 코드 수정이 필요하면 먼저 승인을 요청해"
```

---

## 📊 컨텍스트 엔지니어링

### 토큰은 유한한 자원

> "Every token competes for Claude's attention" - Anthropic

| 원칙 | 설명 |
|------|------|
| **최소 토큰** | 필요한 정보만 포함 |
| **고신호 토큰** | 중요한 정보는 명확하게 |
| **구조화** | 섹션 분리로 파싱 용이하게 |
| **우선순위** | 중요한 것을 앞에 |

### Context Rot 방지

긴 대화에서 초기 지시가 희석되는 현상:
- 주기적으로 `/clear` 또는 `/compact` 사용
- 중요 지시는 반복하거나 강조
- 파일 참조로 지침 외부화

---

## 🛠️ 트러블슈팅

### Claude가 지시를 무시할 때

1. **컨텍스트 포화 확인**
   - 대화가 너무 길어졌는가?
   - `/compact` 실행

2. **지시 명확성 확인**
   - 구체적인가?
   - 모호한 표현 없는가?

3. **예시 확인**
   - 예시가 의도한 행동을 보여주는가?
   - 의도하지 않은 패턴이 있는가?

### 디버깅 체크리스트

```
□ 지시가 충분히 구체적인가?
□ 컨텍스트가 신선한가? (오래된 대화 아닌가?)
□ 예시가 원하는 행동과 일치하는가?
□ 출력 형식이 명시되어 있는가?
□ "~하지 마" 대신 "~해라"로 표현했는가?
□ context, constraints, output이 분리되어 있는가?
```

---

## 📎 이룸 프로젝트 적용 요약

### 프롬프트 작성 시

1. **역할 명시**: "이룸 프로젝트의 시니어 개발자로서..."
2. **파일 참조**: "09-capsule-engine.md에 따라..."
3. **구체적 요청**: "TypeScript, 한국어 주석, 에러 핸들링 포함"
4. **출력 형식**: "표 형식으로 비교해줘"
5. **예시 제공**: 복잡한 요청 시 기대 출력 예시 포함

### 피해야 할 패턴

- ❌ "알아서 해줘"
- ❌ "좋은 방향으로"
- ❌ "적절하게"
- ❌ 모호한 단독 명령 ("개선해줘", "수정해줘")

---

## 🔗 관련 문서

- `13-coding-rules.md` - 코딩 규칙
- `_index.md` - 파일 참조 가이드
