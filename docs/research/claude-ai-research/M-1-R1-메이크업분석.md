# M-1 메이크업 분석 리서치

> **ID**: M-1-R1
> **작성일**: 2026-01-23
> **상태**: 완료
> **적용 대상**: apps/web/lib/makeup/
> **P7 워크플로우**: 리서치 단계

---

## 1. 개요

### 1.1 목적

M-1 (Makeup Analysis) 모듈의 기술적 기반을 마련하기 위한 심층 리서치.
원리 문서(hair-makeup-analysis.md)와 색채학 원리(color-science.md)를 기반으로 구체적인 구현 방향을 도출한다.

### 1.2 리서치 범위

| 영역 | 내용 | 우선순위 |
|------|------|----------|
| 립 컬러 분석 | Lab 8개 카테고리, ROI 추출, MLBB/Bright/Deep 분류 | 필수 |
| 아이 메이크업 분석 | 7개 톤 카테고리, 아이라인 스타일, 피니시 검출 | 필수 |
| 블러셔/하이라이터 | 6개 카테고리, 강도 측정 | 높음 |
| 파운데이션 매칭 | 언더톤/depth 분류, 한국인 피부톤 데이터 | 중간 |
| 컨투어링 가이드 | 얼굴형별 음영 기법 | 중간 |
| K-뷰티 트렌드 | 2024-2026 트렌드 분석 | 참고 |

### 1.3 관련 문서

- **원리**: [hair-makeup-analysis.md](../../principles/hair-makeup-analysis.md)
- **원리**: [color-science.md](../../principles/color-science.md)
- **스펙**: [SDD-MAKEUP-ANALYSIS.md](../../specs/SDD-MAKEUP-ANALYSIS.md)
- **관련 리서치**: [COMBO-3-R1-퍼스널컬러메이크업.md](./COMBO-3-R1-퍼스널컬러메이크업.md)

---

## 2. 립 컬러 분석 상세

### 2.1 Lab 색공간 기반 8개 카테고리

립 컬러는 CIE Lab 색공간에서 측정하여 8개 주요 카테고리로 분류한다.

#### 2.1.1 카테고리별 Lab 범위 정밀 정의

```typescript
interface LabRange {
  L: [number, number];  // 명도 범위 (0-100)
  a: [number, number];  // 빨강-초록 범위 (-128 ~ +127)
  b: [number, number];  // 노랑-파랑 범위 (-128 ~ +127)
}

/**
 * 립 컬러 8개 카테고리 Lab 범위
 *
 * 분류 기준:
 * - a* > 0: 붉은기 (빨강 방향)
 * - b* > 0: 노란기 (웜톤 경향)
 * - b* < 0: 파란기 (쿨톤 경향)
 * - L*: 명도 (높을수록 밝음)
 */
const LIP_COLOR_RANGES: Record<LipColorCategory, LabRange & {
  description: string;
  koreanName: string;
  seasonMatch: Season[];
}> = {
  // 1. 누드 (Nude)
  nude: {
    L: [55, 75],    // 중간~밝은 명도
    a: [5, 15],     // 약한 붉은기
    b: [10, 25],    // 약한 노란기 (따뜻한 베이지)
    description: '자연스러운 피부톤에 가까운 색상',
    koreanName: '누드',
    seasonMatch: ['spring', 'autumn'],
  },

  // 2. 핑크 (Pink)
  pink: {
    L: [50, 70],    // 중간 명도
    a: [20, 40],    // 중간 붉은기
    b: [-10, 10],   // 뉴트럴~약간 쿨
    description: '분홍빛 여성스러운 색상',
    koreanName: '핑크',
    seasonMatch: ['spring', 'summer'],
  },

  // 3. 코랄 (Coral)
  coral: {
    L: [55, 70],    // 밝은 명도
    a: [25, 45],    // 높은 붉은기
    b: [20, 40],    // 높은 노란기 (오렌지 믹스)
    description: '오렌지+핑크 혼합, 생기있는 색상',
    koreanName: '코랄',
    seasonMatch: ['spring', 'autumn'],
  },

  // 4. 레드 (Red)
  red: {
    L: [35, 55],    // 중간~어두운 명도
    a: [40, 65],    // 매우 높은 붉은기
    b: [15, 35],    // 중간 노란기
    description: '강렬하고 클래식한 빨강',
    koreanName: '레드',
    seasonMatch: ['winter', 'autumn'],
  },

  // 5. 오렌지 (Orange)
  orange: {
    L: [50, 65],    // 중간 명도
    a: [30, 50],    // 높은 붉은기
    b: [40, 60],    // 매우 높은 노란기
    description: '활기차고 에너지 넘치는 오렌지',
    koreanName: '오렌지',
    seasonMatch: ['spring', 'autumn'],
  },

  // 6. 베리 (Berry)
  berry: {
    L: [25, 45],    // 어두운 명도
    a: [30, 50],    // 높은 붉은기
    b: [-15, 5],    // 쿨톤 (파란기 포함)
    description: '자주/베리 톤, 세련된 느낌',
    koreanName: '베리',
    seasonMatch: ['summer', 'winter'],
  },

  // 7. 브라운 (Brown)
  brown: {
    L: [30, 50],    // 어두운~중간 명도
    a: [15, 30],    // 중간 붉은기
    b: [20, 40],    // 높은 노란기
    description: '갈색/누드 브라운, 차분한 느낌',
    koreanName: '브라운',
    seasonMatch: ['autumn'],
  },

  // 8. 플럼 (Plum)
  plum: {
    L: [20, 40],    // 어두운 명도
    a: [25, 45],    // 높은 붉은기
    b: [-25, 0],    // 쿨톤 (파란기/보라기)
    description: '자두/보라 톤, 깊이 있는 색상',
    koreanName: '플럼',
    seasonMatch: ['winter', 'summer'],
  },
};
```

#### 2.1.2 카테고리 분류 시각화

```
┌─────────────────────────────────────────────────────────────────────┐
│                    립 컬러 Lab 분포도                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│              b* (Yellow/Warm)                                        │
│                ↑                                                     │
│           60  │     ┌─────────┐                                     │
│               │     │ ORANGE  │                                     │
│           40  │  ┌──┴─────────┴──┐                                  │
│               │  │    CORAL      │                                  │
│           20  │  │  ┌─────────┐  │  ┌─────────┐                     │
│               │  │  │  NUDE   │  │  │  BROWN  │                     │
│            0  │──┼──┼─────────┼──┼──┼─────────┼─────→ a* (Red)      │
│               │  │  │  PINK   │  │  │  RED    │                     │
│          -10  │  │  └─────────┘  │  └─────────┘                     │
│               │  │    BERRY      │                                  │
│          -25  │  └───────────────┘                                  │
│               │     ┌─────────┐                                     │
│               │     │  PLUM   │                                     │
│               └─────┴─────────┴────────────────                     │
│                     15   30   45   60   (a*)                        │
│                                                                      │
│   웜톤 립: NUDE, CORAL, ORANGE, BROWN (높은 b*)                      │
│   쿨톤 립: PINK, BERRY, PLUM (낮거나 음수 b*)                       │
│   뉴트럴: RED (중간 b*, 높은 a*)                                    │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 립 색상 추출 알고리즘

#### 2.2.1 얼굴 ROI에서 입술 감지

68점 랜드마크 기반 입술 영역 추출:

```typescript
/**
 * 68점 랜드마크에서 입술 영역 인덱스
 *
 * 외부 입술 윤곽: 48-59 (12점)
 * 내부 입술 윤곽: 60-67 (8점)
 */
interface LipLandmarks {
  outerLip: number[];  // [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
  innerLip: number[];  // [60, 61, 62, 63, 64, 65, 66, 67]
}

const LIP_LANDMARK_INDICES: LipLandmarks = {
  outerLip: [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59],
  innerLip: [60, 61, 62, 63, 64, 65, 66, 67],
};

/**
 * 입술 ROI 폴리곤 생성
 *
 * 전략:
 * 1. 외부 윤곽으로 폴리곤 생성
 * 2. 내부 영역에 가우시안 가중치 적용 (가장자리 피부색 영향 최소화)
 * 3. 중앙 영역 픽셀에 높은 가중치
 */
function extractLipPolygon(
  landmarks: Point2D[],
  imageWidth: number,
  imageHeight: number
): {
  polygon: Point2D[];
  centerPoint: Point2D;
  boundingBox: BoundingBox;
} {
  const outerPoints = LIP_LANDMARK_INDICES.outerLip.map(i => landmarks[i]);

  // 중심점 계산
  const centerX = outerPoints.reduce((sum, p) => sum + p.x, 0) / outerPoints.length;
  const centerY = outerPoints.reduce((sum, p) => sum + p.y, 0) / outerPoints.length;

  // 바운딩 박스
  const minX = Math.min(...outerPoints.map(p => p.x));
  const maxX = Math.max(...outerPoints.map(p => p.x));
  const minY = Math.min(...outerPoints.map(p => p.y));
  const maxY = Math.max(...outerPoints.map(p => p.y));

  return {
    polygon: outerPoints,
    centerPoint: { x: centerX, y: centerY },
    boundingBox: { minX, maxX, minY, maxY, width: maxX - minX, height: maxY - minY },
  };
}

/**
 * 가우시안 가중치 적용 립 색상 추출
 *
 * 원리:
 * - 입술 중앙일수록 높은 가중치
 * - 가장자리 (피부와 경계)는 낮은 가중치
 * - 이를 통해 피부색 오염 최소화
 */
function extractLipColorWithGaussianWeight(
  imageData: ImageData,
  lipPolygon: Point2D[],
  centerPoint: Point2D
): { lab: LabColor; confidence: number } {
  const pixels: { lab: LabColor; weight: number }[] = [];

  // 폴리곤 내부 픽셀 순회
  for (const pixel of iteratePolygonPixels(imageData, lipPolygon)) {
    const { x, y, r, g, b } = pixel;

    // 중심점으로부터의 거리 계산
    const distance = Math.sqrt((x - centerPoint.x) ** 2 + (y - centerPoint.y) ** 2);
    const maxDistance = Math.max(
      ...lipPolygon.map(p => Math.sqrt((p.x - centerPoint.x) ** 2 + (p.y - centerPoint.y) ** 2))
    );

    // 가우시안 가중치 (중심 = 1.0, 가장자리 = ~0.3)
    const sigma = maxDistance * 0.5;  // 표준편차
    const weight = Math.exp(-(distance ** 2) / (2 * sigma ** 2));

    // RGB → Lab 변환
    const lab = rgbToLab(r, g, b);

    pixels.push({ lab, weight });
  }

  // 가중 평균 계산
  const totalWeight = pixels.reduce((sum, p) => sum + p.weight, 0);
  const avgLab: LabColor = {
    L: pixels.reduce((sum, p) => sum + p.lab.L * p.weight, 0) / totalWeight,
    a: pixels.reduce((sum, p) => sum + p.lab.a * p.weight, 0) / totalWeight,
    b: pixels.reduce((sum, p) => sum + p.lab.b * p.weight, 0) / totalWeight,
  };

  // 신뢰도 계산 (픽셀 수, 분산 기반)
  const variance = calculateLabVariance(pixels.map(p => p.lab));
  const confidence = Math.max(50, 100 - variance * 2);

  return { lab: avgLab, confidence };
}
```

#### 2.2.2 립 컬러 분류 알고리즘

```typescript
/**
 * Lab 값에서 립 컬러 카테고리 분류
 *
 * 알고리즘:
 * 1. 각 카테고리의 Lab 범위와 비교
 * 2. 범위 내 포함 여부 확인
 * 3. 복수 카테고리 해당 시 중심점과의 거리로 결정
 */
function classifyLipColor(lab: LabColor): {
  category: LipColorCategory;
  subCategory: LipSubCategory;
  confidence: number;
  alternatives: { category: LipColorCategory; score: number }[];
} {
  const scores: { category: LipColorCategory; score: number; inRange: boolean }[] = [];

  for (const [category, range] of Object.entries(LIP_COLOR_RANGES)) {
    // 범위 내 포함 여부
    const inRange =
      lab.L >= range.L[0] && lab.L <= range.L[1] &&
      lab.a >= range.a[0] && lab.a <= range.a[1] &&
      lab.b >= range.b[0] && lab.b <= range.b[1];

    // 중심점과의 거리 계산
    const centerL = (range.L[0] + range.L[1]) / 2;
    const centerA = (range.a[0] + range.a[1]) / 2;
    const centerB = (range.b[0] + range.b[1]) / 2;

    const distance = Math.sqrt(
      ((lab.L - centerL) / 25) ** 2 +  // L 정규화 (범위 ~50)
      ((lab.a - centerA) / 30) ** 2 +  // a 정규화 (범위 ~60)
      ((lab.b - centerB) / 35) ** 2    // b 정규화 (범위 ~70)
    );

    // 점수 계산 (거리 역수 + 범위 보너스)
    const score = inRange ? 100 - distance * 20 : 80 - distance * 25;

    scores.push({ category: category as LipColorCategory, score, inRange });
  }

  // 점수 내림차순 정렬
  scores.sort((a, b) => b.score - a.score);

  const bestMatch = scores[0];
  const alternatives = scores.slice(1, 4).map(s => ({ category: s.category, score: s.score }));

  // 서브카테고리 결정
  const subCategory = determineSubCategory(lab, bestMatch.category);

  return {
    category: bestMatch.category,
    subCategory,
    confidence: Math.max(50, Math.min(95, bestMatch.score)),
    alternatives,
  };
}

/**
 * 서브카테고리 판정 (MLBB / Bright / Deep)
 */
function determineSubCategory(lab: LabColor, category: LipColorCategory): LipSubCategory {
  // Chroma (채도) 계산
  const chroma = Math.sqrt(lab.a ** 2 + lab.b ** 2);

  // MLBB: 자연스러운 입술색에 가까움 (누드, 핑크 계열 + 높은 명도 + 낮은 채도)
  if (['nude', 'pink'].includes(category) && lab.L > 60 && chroma < 30) {
    return 'mlbb';
  }

  // Bright: 채도가 높음 (chroma > 45)
  if (chroma > 45) {
    return 'bright';
  }

  // Deep: 명도가 낮음 (L* < 40)
  if (lab.L < 40) {
    return 'deep';
  }

  return undefined;  // 해당 없음
}
```

### 2.3 퍼스널컬러 시즌별 립 컬러 매칭

#### 2.3.1 시즌별 추천/비추천 립 컬러

```typescript
/**
 * 퍼스널컬러 시즌별 립 컬러 조화도
 */
const SEASON_LIP_HARMONY: Record<Season, {
  bestMatch: LipColorCategory[];
  goodMatch: LipColorCategory[];
  avoid: LipColorCategory[];
  characteristics: string;
}> = {
  spring: {
    bestMatch: ['coral', 'orange', 'nude'],
    goodMatch: ['pink', 'red'],
    avoid: ['plum', 'berry', 'brown'],
    characteristics: '밝고 따뜻한 웜톤, 선명하고 생기있는 컬러',
  },
  summer: {
    bestMatch: ['pink', 'berry', 'plum'],
    goodMatch: ['nude', 'red'],
    avoid: ['orange', 'coral', 'brown'],
    characteristics: '부드럽고 차분한 쿨톤, 로즈/라벤더 계열',
  },
  autumn: {
    bestMatch: ['brown', 'coral', 'red'],
    goodMatch: ['nude', 'orange'],
    avoid: ['pink', 'berry', 'plum'],
    characteristics: '깊고 따뜻한 웜톤, 어스톤/테라코타 계열',
  },
  winter: {
    bestMatch: ['red', 'plum', 'berry'],
    goodMatch: ['pink'],
    avoid: ['nude', 'coral', 'orange', 'brown'],
    characteristics: '선명하고 대비가 강한 쿨톤, 비비드 컬러',
  },
};

/**
 * 립 컬러 조화도 점수 계산
 */
function calculateLipHarmonyScore(
  lipLab: LabColor,
  lipCategory: LipColorCategory,
  season: Season
): {
  score: number;
  feedback: string;
  recommendation: string | null;
} {
  const harmony = SEASON_LIP_HARMONY[season];

  let baseScore: number;
  let feedback: string;

  if (harmony.bestMatch.includes(lipCategory)) {
    baseScore = 90;
    feedback = `${lipCategory}는 ${season} 시즌에 매우 잘 어울리는 컬러입니다.`;
  } else if (harmony.goodMatch.includes(lipCategory)) {
    baseScore = 75;
    feedback = `${lipCategory}는 ${season} 시즌에 무난하게 어울립니다.`;
  } else if (harmony.avoid.includes(lipCategory)) {
    baseScore = 40;
    feedback = `${lipCategory}는 ${season} 시즌에 다소 어울리지 않을 수 있습니다.`;
  } else {
    baseScore = 60;
    feedback = '보통 수준의 조화도입니다.';
  }

  // Lab 값 기반 미세 조정 (시즌별 이상적 Lab 범위와의 거리)
  const idealLab = getIdealLipLabForSeason(season);
  const distance = calculateLabDistance(lipLab, idealLab);
  const adjustment = Math.max(-15, Math.min(15, 20 - distance));

  const finalScore = Math.max(20, Math.min(100, baseScore + adjustment));

  // 추천 생성
  let recommendation: string | null = null;
  if (finalScore < 60) {
    const bestCategory = harmony.bestMatch[0];
    recommendation = `${bestCategory} 계열 립을 시도해보세요.`;
  }

  return { score: finalScore, feedback, recommendation };
}

/**
 * 시즌별 이상적인 립 Lab 값
 */
function getIdealLipLabForSeason(season: Season): LabColor {
  const idealValues: Record<Season, LabColor> = {
    spring: { L: 62, a: 35, b: 28 },  // 밝은 코랄
    summer: { L: 55, a: 30, b: -5 },  // 로즈 핑크
    autumn: { L: 45, a: 30, b: 25 },  // 테라코타/브릭
    winter: { L: 40, a: 50, b: 20 },  // 트루 레드
  };
  return idealValues[season];
}
```

---

## 3. 아이 메이크업 분석

### 3.1 아이섀도우 7개 톤 카테고리 상세

```typescript
/**
 * 아이섀도우 7개 카테고리 정의
 */
const EYESHADOW_CATEGORIES: Record<EyeshadowCategory, {
  name: string;
  koreanName: string;
  description: string;
  labRanges: LabRange[];
  warmCool: 'warm' | 'cool' | 'neutral';
  finishTypes: MakeupFinish[];
  seasonMatch: Season[];
}> = {
  'neutral-brown': {
    name: 'Neutral Brown',
    koreanName: '뉴트럴 브라운',
    description: '베이지, 브라운, 토프 - 모든 피부톤에 무난',
    labRanges: [
      { L: [40, 70], a: [5, 15], b: [10, 25] },
    ],
    warmCool: 'neutral',
    finishTypes: ['matte', 'satin', 'shimmer'],
    seasonMatch: ['spring', 'summer', 'autumn', 'winter'],
  },

  'warm-brown': {
    name: 'Warm Brown',
    koreanName: '웜 브라운',
    description: '코랄, 오렌지, 테라코타 - 따뜻한 어스톤',
    labRanges: [
      { L: [35, 65], a: [10, 30], b: [20, 40] },
    ],
    warmCool: 'warm',
    finishTypes: ['matte', 'shimmer', 'glitter'],
    seasonMatch: ['spring', 'autumn'],
  },

  'cool-brown': {
    name: 'Cool Brown',
    koreanName: '쿨 브라운',
    description: '그레이, 토프, 버건디 - 차분하고 세련된',
    labRanges: [
      { L: [35, 60], a: [5, 20], b: [-5, 15] },
    ],
    warmCool: 'cool',
    finishTypes: ['matte', 'satin'],
    seasonMatch: ['summer', 'winter'],
  },

  'pink-tone': {
    name: 'Pink Tone',
    koreanName: '핑크 톤',
    description: '로즈, 피치, 말린 장미 - 여성스럽고 부드러운',
    labRanges: [
      { L: [50, 75], a: [15, 35], b: [-10, 15] },
    ],
    warmCool: 'neutral',
    finishTypes: ['matte', 'shimmer', 'glitter'],
    seasonMatch: ['spring', 'summer'],
  },

  'smoky': {
    name: 'Smoky',
    koreanName: '스모키',
    description: '그레이, 블랙, 차콜 - 강렬하고 시크한',
    labRanges: [
      { L: [15, 45], a: [-5, 10], b: [-10, 10] },
    ],
    warmCool: 'neutral',
    finishTypes: ['matte', 'shimmer'],
    seasonMatch: ['winter', 'autumn'],
  },

  'colorful': {
    name: 'Colorful',
    koreanName: '컬러풀',
    description: '블루, 그린, 퍼플 - 트렌디하고 개성있는',
    labRanges: [
      { L: [30, 70], a: [-30, 50], b: [-50, 30] },  // 넓은 범위 (다양한 컬러)
    ],
    warmCool: 'cool',  // 대부분 쿨톤 기반
    finishTypes: ['matte', 'shimmer', 'glitter'],
    seasonMatch: ['spring', 'winter'],
  },

  'glitter': {
    name: 'Glitter',
    koreanName: '글리터',
    description: '골드, 실버, 홀로그램 - 반짝이는 포인트',
    labRanges: [
      { L: [60, 90], a: [-10, 20], b: [0, 40] },
    ],
    warmCool: 'neutral',  // 색상에 따라 다름
    finishTypes: ['glitter'],
    seasonMatch: ['spring', 'summer', 'autumn', 'winter'],
  },
};
```

### 3.2 아이라인 스타일 6가지

```typescript
/**
 * 아이라인 스타일 분류
 */
type EyelinerStyle =
  | 'natural'      // 자연스러운 얇은 라인
  | 'cat-eye'      // 고양이 눈매 (끝 올림)
  | 'puppy-eye'    // 강아지 눈매 (끝 내림)
  | 'smudged'      // 번진 느낌 (스모키)
  | 'graphic'      // 그래픽 라인 (포인트)
  | 'none';        // 노 아이라인

interface EyelinerAnalysis {
  style: EyelinerStyle;
  thickness: 'thin' | 'medium' | 'thick';
  color: {
    lab: LabColor;
    hex: string;
  };
  tailDirection: 'up' | 'straight' | 'down' | null;
}

/**
 * 눈 형태별 아이라인 추천
 */
const EYE_SHAPE_EYELINER_GUIDE: Record<string, {
  recommended: EyelinerStyle[];
  avoid: EyelinerStyle[];
  tips: string;
}> = {
  'round': {
    recommended: ['cat-eye', 'natural'],
    avoid: ['puppy-eye'],
    tips: '끝을 올려 그려 눈을 길어 보이게',
  },
  'almond': {
    recommended: ['natural', 'cat-eye', 'smudged'],
    avoid: [],
    tips: '대부분의 스타일이 잘 어울림',
  },
  'monolid': {
    recommended: ['smudged', 'graphic'],
    avoid: ['thin natural'],
    tips: '조금 두껍게 그려야 눈을 떴을 때 보임',
  },
  'hooded': {
    recommended: ['cat-eye', 'graphic'],
    avoid: ['thick line'],
    tips: '꼬리 부분을 위로 올려 접히지 않게',
  },
  'downturned': {
    recommended: ['cat-eye'],
    avoid: ['puppy-eye'],
    tips: '눈 끝을 올려 처진 느낌 보정',
  },
  'upturned': {
    recommended: ['puppy-eye', 'natural'],
    avoid: ['extreme cat-eye'],
    tips: '자연스럽게 눈 모양 따라 그리기',
  },
};
```

### 3.3 눈 형태별 아이 메이크업 추천

```typescript
/**
 * 눈 형태 분류
 */
type EyeShape =
  | 'round'        // 둥근 눈
  | 'almond'       // 아몬드형
  | 'monolid'      // 홑꺼풀
  | 'double'       // 쌍꺼풀
  | 'hooded'       // 속쌍 (후드)
  | 'downturned'   // 처진 눈
  | 'upturned';    // 올라간 눈

interface EyeMakeupRecommendation {
  eyeShape: EyeShape;
  eyeshadowPlacement: {
    inner: string;
    lid: string;
    crease: string;
    outer: string;
    undereye: string;
  };
  recommendedCategories: EyeshadowCategory[];
  eyelinerTips: string;
  mascara: string;
}

const EYE_SHAPE_MAKEUP_GUIDE: Record<EyeShape, EyeMakeupRecommendation> = {
  'round': {
    eyeShape: 'round',
    eyeshadowPlacement: {
      inner: '하이라이트 컬러',
      lid: '베이스 컬러',
      crease: '셰이딩으로 깊이감',
      outer: '어두운 컬러로 길이 연장',
      undereye: '아이섀도우로 언더 라인',
    },
    recommendedCategories: ['warm-brown', 'cool-brown', 'smoky'],
    eyelinerTips: '끝을 살짝 올려 캣아이로',
    mascara: '바깥쪽 속눈썹 강조',
  },

  'monolid': {
    eyeShape: 'monolid',
    eyeshadowPlacement: {
      inner: '밝은 글리터',
      lid: '그라데이션 넓게',
      crease: '눈을 떴을 때 보이는 위치까지',
      outer: '부드럽게 퍼지게',
      undereye: '하이라이트 포인트',
    },
    recommendedCategories: ['glitter', 'colorful', 'warm-brown'],
    eyelinerTips: '두껍게, 번지는 타입 추천',
    mascara: '볼륨+컬링 강조',
  },

  'hooded': {
    eyeShape: 'hooded',
    eyeshadowPlacement: {
      inner: '하이라이트',
      lid: '접히는 부분 위까지',
      crease: '실제 crease보다 위에',
      outer: '위로 올려 그리기',
      undereye: '하이라이트로 밝게',
    },
    recommendedCategories: ['neutral-brown', 'smoky'],
    eyelinerTips: '눈을 뜨고 확인하며 그리기',
    mascara: '컬링 유지력 중요',
  },

  // ... 나머지 형태
};
```

### 3.4 Lab 색공간 기반 아이섀도우 분류 알고리즘

```typescript
/**
 * 아이섀도우 영역 색상 추출 및 분류
 *
 * K-means 클러스터링으로 멀티 컬러 추출
 */
interface EyeshadowAnalysisResult {
  category: EyeshadowCategory;
  dominantColor: { lab: LabColor; hex: string };
  secondaryColors: { lab: LabColor; hex: string }[];
  finishes: MakeupFinish[];
  warmCoolTone: 'warm' | 'cool' | 'neutral';
  confidence: number;
}

async function analyzeEyeshadow(
  imageData: ImageData,
  eyeLandmarks: Point2D[],
  options: { clusterCount?: number } = {}
): Promise<EyeshadowAnalysisResult> {
  const { clusterCount = 4 } = options;

  // 1. 눈 영역 확장 (아이섀도우 영역 = 눈 위 + 눈꺼풀)
  const eyeRegion = expandEyeRegion(eyeLandmarks, 1.5);  // 1.5배 확장

  // 2. 영역 내 픽셀 추출
  const pixels = extractPixelsFromRegion(imageData, eyeRegion);

  // 3. 피부색 필터링 (기준 피부색과 너무 유사한 픽셀 제외)
  const baseSkinLab = detectBaseSkinTone(imageData, eyeLandmarks);
  const filteredPixels = pixels.filter(p => {
    const lab = rgbToLab(p.r, p.g, p.b);
    const distance = calculateLabDistance(lab, baseSkinLab);
    return distance > 10;  // ΔE > 10인 픽셀만 (메이크업으로 간주)
  });

  // 4. K-means 클러스터링
  const clusters = kMeansClustering(
    filteredPixels.map(p => rgbToLab(p.r, p.g, p.b)),
    clusterCount
  );

  // 5. 클러스터 크기순 정렬
  clusters.sort((a, b) => b.size - a.size);

  // 6. 주요 색상 (가장 큰 클러스터)
  const dominantLab = clusters[0].center;

  // 7. 보조 색상 (2-4위 클러스터)
  const secondaryColors = clusters.slice(1, 4).map(c => ({
    lab: c.center,
    hex: labToHex(c.center),
  }));

  // 8. 카테고리 분류
  const category = classifyEyeshadowCategory(dominantLab, secondaryColors);

  // 9. 피니시 감지
  const finishes = detectFinishes(pixels);

  // 10. 웜/쿨 톤 판정
  const warmCoolTone = determineWarmCoolTone(dominantLab);

  return {
    category,
    dominantColor: { lab: dominantLab, hex: labToHex(dominantLab) },
    secondaryColors,
    finishes,
    warmCoolTone,
    confidence: calculateEyeshadowConfidence(clusters, filteredPixels.length),
  };
}

/**
 * 피니시 감지 (하이라이트 픽셀 분석)
 */
function detectFinishes(pixels: RGBPixel[]): MakeupFinish[] {
  const finishes: MakeupFinish[] = [];

  // 밝기 분포 분석
  const luminances = pixels.map(p => 0.299 * p.r + 0.587 * p.g + 0.114 * p.b);
  const maxLuminance = Math.max(...luminances);
  const avgLuminance = luminances.reduce((a, b) => a + b, 0) / luminances.length;
  const highlightRatio = luminances.filter(l => l > avgLuminance * 1.3).length / luminances.length;

  // 매트: 하이라이트 픽셀 비율 낮음
  if (highlightRatio < 0.05) {
    finishes.push('matte');
  }

  // 쉬머: 중간 하이라이트
  if (highlightRatio >= 0.05 && highlightRatio < 0.2) {
    finishes.push('shimmer');
  }

  // 글리터: 높은 하이라이트 (sparkle)
  if (highlightRatio >= 0.2 || maxLuminance > 240) {
    finishes.push('glitter');
  }

  // 기본값
  if (finishes.length === 0) {
    finishes.push('satin');
  }

  return finishes;
}
```

---

## 4. 블러셔/하이라이터 분석

### 4.1 블러셔 6개 카테고리 Lab 범위

```typescript
/**
 * 블러셔 6개 카테고리 상세 정의
 */
const BLUSHER_COLOR_RANGES: Record<BlusherCategory, {
  name: string;
  koreanName: string;
  lab: LabRange;
  description: string;
  recommendedUndertone: 'warm' | 'cool' | 'neutral';
  seasonMatch: Season[];
  intensity: 'light' | 'medium' | 'deep';
}> = {
  peach: {
    name: 'Peach',
    koreanName: '피치',
    lab: { L: [65, 80], a: [15, 30], b: [20, 35] },
    description: '복숭아빛, 자연스럽고 생기있는',
    recommendedUndertone: 'warm',
    seasonMatch: ['spring', 'autumn'],
    intensity: 'light',
  },

  coral: {
    name: 'Coral',
    koreanName: '코랄',
    lab: { L: [60, 75], a: [25, 40], b: [25, 40] },
    description: '산호빛, 화사하고 발랄한',
    recommendedUndertone: 'warm',
    seasonMatch: ['spring'],
    intensity: 'medium',
  },

  rose: {
    name: 'Rose',
    koreanName: '로즈',
    lab: { L: [55, 70], a: [20, 35], b: [-5, 10] },
    description: '장미빛, 우아하고 여성스러운',
    recommendedUndertone: 'cool',
    seasonMatch: ['summer', 'winter'],
    intensity: 'medium',
  },

  pink: {
    name: 'Pink',
    koreanName: '핑크',
    lab: { L: [60, 75], a: [25, 40], b: [-10, 5] },
    description: '핑크빛, 사랑스럽고 청순한',
    recommendedUndertone: 'cool',
    seasonMatch: ['summer', 'spring'],
    intensity: 'light',
  },

  burgundy: {
    name: 'Burgundy',
    koreanName: '버건디',
    lab: { L: [35, 50], a: [25, 40], b: [5, 20] },
    description: '와인빛, 시크하고 깊이있는',
    recommendedUndertone: 'cool',
    seasonMatch: ['autumn', 'winter'],
    intensity: 'deep',
  },

  bronzer: {
    name: 'Bronzer',
    koreanName: '브론저',
    lab: { L: [45, 60], a: [10, 25], b: [25, 45] },
    description: '브론즈빛, 건강하고 글로우한',
    recommendedUndertone: 'warm',
    seasonMatch: ['autumn', 'spring'],
    intensity: 'medium',
  },
};
```

### 4.2 하이라이터 타입 분류

```typescript
/**
 * 하이라이터 타입
 */
type HighlighterType =
  | 'champagne'    // 샴페인 (웜톤, 골드 기반)
  | 'rose-gold'    // 로즈골드 (뉴트럴, 핑크+골드)
  | 'silver'       // 실버 (쿨톤, 화이트 기반)
  | 'bronze'       // 브론즈 (웜톤, 깊은 골드)
  | 'holographic'; // 홀로그래픽 (컬러풀)

interface HighlighterAnalysis {
  type: HighlighterType;
  intensity: number;  // 0-100
  placement: string[];  // 적용 위치
}

const HIGHLIGHTER_TYPES: Record<HighlighterType, {
  lab: LabRange;
  seasonMatch: Season[];
  skinToneMatch: string[];
}> = {
  'champagne': {
    lab: { L: [75, 95], a: [0, 10], b: [15, 35] },
    seasonMatch: ['spring', 'autumn'],
    skinToneMatch: ['warm', 'neutral'],
  },
  'rose-gold': {
    lab: { L: [70, 90], a: [10, 25], b: [10, 25] },
    seasonMatch: ['spring', 'summer'],
    skinToneMatch: ['warm', 'neutral', 'cool'],
  },
  'silver': {
    lab: { L: [80, 98], a: [-5, 5], b: [-10, 5] },
    seasonMatch: ['summer', 'winter'],
    skinToneMatch: ['cool', 'neutral'],
  },
  'bronze': {
    lab: { L: [55, 75], a: [5, 20], b: [20, 40] },
    seasonMatch: ['autumn'],
    skinToneMatch: ['warm', 'tan', 'deep'],
  },
  'holographic': {
    lab: { L: [70, 95], a: [-20, 30], b: [-20, 30] },  // 넓은 범위 (컬러 변화)
    seasonMatch: ['winter', 'spring'],
    skinToneMatch: ['all'],
  },
};
```

### 4.3 피부톤별 블러셔 추천

```typescript
/**
 * 피부톤 기반 블러셔 추천 매트릭스
 */
interface BlusherRecommendation {
  category: BlusherCategory;
  hex: string;
  matchScore: number;
  reason: string;
}

function recommendBlusherBySkintone(
  skinLab: LabColor,
  undertone: 'warm' | 'cool' | 'neutral',
  depth: 'fair' | 'light' | 'medium' | 'tan' | 'deep'
): BlusherRecommendation[] {
  const recommendations: BlusherRecommendation[] = [];

  // 언더톤별 1차 필터링
  const matchingCategories = Object.entries(BLUSHER_COLOR_RANGES)
    .filter(([_, data]) =>
      data.recommendedUndertone === undertone ||
      data.recommendedUndertone === 'neutral'
    );

  for (const [category, data] of matchingCategories) {
    // 피부 명도(depth)에 따른 블러셔 강도 매칭
    let depthMatch = true;
    let reason = '';

    if (depth === 'fair' || depth === 'light') {
      // 밝은 피부: 라이트~미디엄 강도
      depthMatch = data.intensity === 'light' || data.intensity === 'medium';
      reason = '밝은 피부톤에 자연스러운 발색';
    } else if (depth === 'medium') {
      // 중간 피부: 모든 강도 OK
      depthMatch = true;
      reason = '균형 잡힌 발색';
    } else {
      // 어두운 피부: 미디엄~딥 강도
      depthMatch = data.intensity === 'medium' || data.intensity === 'deep';
      reason = '피부톤에 어울리는 깊이감';
    }

    if (depthMatch) {
      // Lab 중심값과의 거리 기반 점수
      const centerLab: LabColor = {
        L: (data.lab.L[0] + data.lab.L[1]) / 2,
        a: (data.lab.a[0] + data.lab.a[1]) / 2,
        b: (data.lab.b[0] + data.lab.b[1]) / 2,
      };

      // 피부색과의 조화도 계산 (너무 비슷하면 안 보임, 너무 다르면 부자연스러움)
      const distance = calculateLabDistance(skinLab, centerLab);
      const idealDistance = 25;  // 이상적 차이
      const distanceScore = 100 - Math.abs(distance - idealDistance) * 2;

      recommendations.push({
        category: category as BlusherCategory,
        hex: labToHex(centerLab),
        matchScore: Math.max(40, Math.min(95, distanceScore)),
        reason,
      });
    }
  }

  return recommendations.sort((a, b) => b.matchScore - a.matchScore);
}
```

---

## 5. 피부톤별 파운데이션 매칭

### 5.1 언더톤 (웜/쿨/뉴트럴) 정밀 분류

```typescript
/**
 * 언더톤 판정 알고리즘 (한국인 최적화)
 *
 * 참조: color-science.md Section 4
 */
interface UndertoneAnalysis {
  undertone: 'warm' | 'cool' | 'neutral';
  confidence: number;
  details: {
    hueAngle: number;
    bValue: number;
    aValue: number;
  };
  subtype: string;  // e.g., 'golden-warm', 'pink-cool', 'olive-neutral'
}

function analyzeUndertone(skinLab: LabColor): UndertoneAnalysis {
  // Hue Angle 계산
  const hue = Math.atan2(skinLab.b, skinLab.a) * (180 / Math.PI);
  const h = hue < 0 ? hue + 360 : hue;

  // 한국인 기준 임계값 (일반 기준보다 +2~3°)
  const WARM_THRESHOLD = 60;  // h° > 60 → 웜
  const COOL_THRESHOLD = 55;  // h° < 55 → 쿨

  let undertone: 'warm' | 'cool' | 'neutral';
  let confidence: number;
  let subtype: string;

  // 1차: Hue Angle 기반
  if (h > WARM_THRESHOLD) {
    undertone = 'warm';
    confidence = 70 + (h - WARM_THRESHOLD) * 2;
  } else if (h < COOL_THRESHOLD) {
    undertone = 'cool';
    confidence = 70 + (COOL_THRESHOLD - h) * 2;
  } else {
    undertone = 'neutral';
    confidence = 60;
  }

  // 2차: b* 값 보정 (한국인 평균 b* = 18.5)
  if (skinLab.b > 20) {
    if (undertone !== 'warm') {
      undertone = 'warm';
      confidence = Math.max(confidence - 10, 60);
    } else {
      confidence = Math.min(confidence + 10, 95);
    }
  } else if (skinLab.b < 15) {
    if (undertone !== 'cool') {
      undertone = 'cool';
      confidence = Math.max(confidence - 10, 60);
    } else {
      confidence = Math.min(confidence + 10, 95);
    }
  }

  // 3차: 서브타입 결정
  if (undertone === 'warm') {
    subtype = skinLab.b > 22 ? 'golden-warm' : 'peach-warm';
  } else if (undertone === 'cool') {
    subtype = skinLab.a > 10 ? 'pink-cool' : 'olive-cool';
  } else {
    subtype = skinLab.b > 17 ? 'warm-neutral' : 'cool-neutral';
  }

  return {
    undertone,
    confidence: Math.min(95, confidence),
    details: { hueAngle: h, bValue: skinLab.b, aValue: skinLab.a },
    subtype,
  };
}
```

### 5.2 피부 Depth (fair~deep) 5단계 분류

```typescript
/**
 * 피부 명도 분류 (5단계)
 *
 * L* (명도) 기반
 */
type SkinDepth = 'fair' | 'light' | 'medium' | 'tan' | 'deep';

interface DepthAnalysis {
  depth: SkinDepth;
  labL: number;
  fitzpatrickEstimate: number;  // 1-6
}

const SKIN_DEPTH_RANGES: Record<SkinDepth, {
  L_range: [number, number];
  fitzpatrick: number[];
  koreanPercentage: number;  // 한국인 분포율
}> = {
  'fair': {
    L_range: [68, 78],
    fitzpatrick: [1, 2],
    koreanPercentage: 10,
  },
  'light': {
    L_range: [62, 68],
    fitzpatrick: [2, 3],
    koreanPercentage: 45,
  },
  'medium': {
    L_range: [56, 62],
    fitzpatrick: [3, 4],
    koreanPercentage: 35,
  },
  'tan': {
    L_range: [48, 56],
    fitzpatrick: [4, 5],
    koreanPercentage: 8,
  },
  'deep': {
    L_range: [35, 48],
    fitzpatrick: [5, 6],
    koreanPercentage: 2,
  },
};

function analyzeSkinDepth(skinLab: LabColor): DepthAnalysis {
  const L = skinLab.L;

  for (const [depth, data] of Object.entries(SKIN_DEPTH_RANGES)) {
    if (L >= data.L_range[0] && L <= data.L_range[1]) {
      return {
        depth: depth as SkinDepth,
        labL: L,
        fitzpatrickEstimate: data.fitzpatrick[0],
      };
    }
  }

  // 범위 외 처리
  if (L > 78) return { depth: 'fair', labL: L, fitzpatrickEstimate: 1 };
  return { depth: 'deep', labL: L, fitzpatrickEstimate: 6 };
}
```

### 5.3 파운데이션 쉐이드 매칭 알고리즘

```typescript
/**
 * 파운데이션 매칭 결과
 */
interface FoundationMatchResult {
  recommendedShades: {
    name: string;
    code: string;
    labValue: LabColor;
    matchScore: number;
  }[];
  undertone: 'warm' | 'cool' | 'neutral';
  depth: SkinDepth;
  finish: 'matte' | 'satin' | 'dewy';
  tips: string[];
}

/**
 * 파운데이션 쉐이드 데이터베이스 (예시)
 */
const FOUNDATION_SHADE_DB = [
  { name: 'N13 아이보리', code: 'N13', lab: { L: 70, a: 8, b: 18 }, undertone: 'neutral' },
  { name: 'W21 베이지', code: 'W21', lab: { L: 65, a: 10, b: 22 }, undertone: 'warm' },
  { name: 'C23 샌드', code: 'C23', lab: { L: 62, a: 7, b: 15 }, undertone: 'cool' },
  // ... 더 많은 쉐이드
];

function matchFoundation(
  skinLab: LabColor,
  skinType: 'dry' | 'oily' | 'combination' | 'normal',
  preferences?: { coverage?: string; finish?: string }
): FoundationMatchResult {
  const undertoneResult = analyzeUndertone(skinLab);
  const depthResult = analyzeSkinDepth(skinLab);

  // 1. 언더톤 필터링
  const undertoneMatches = FOUNDATION_SHADE_DB.filter(shade =>
    shade.undertone === undertoneResult.undertone ||
    undertoneResult.undertone === 'neutral'
  );

  // 2. ΔE 기반 매칭 점수 계산
  const scoredShades = undertoneMatches.map(shade => {
    const deltaE = calculateCIEDE2000(skinLab, shade.lab);

    // ΔE < 2: 거의 완벽 (95+점)
    // ΔE 2-3: 매우 좋음 (85-95점)
    // ΔE 3-5: 좋음 (70-85점)
    // ΔE 5-8: 보통 (50-70점)
    // ΔE > 8: 맞지 않음 (50점 미만)
    let score: number;
    if (deltaE < 2) score = 95 + (2 - deltaE) * 2.5;
    else if (deltaE < 3) score = 85 + (3 - deltaE) * 10;
    else if (deltaE < 5) score = 70 + (5 - deltaE) * 7.5;
    else if (deltaE < 8) score = 50 + (8 - deltaE) * 6.7;
    else score = Math.max(30, 50 - (deltaE - 8) * 3);

    return {
      ...shade,
      matchScore: Math.round(score),
    };
  });

  // 3. 점수순 정렬
  scoredShades.sort((a, b) => b.matchScore - a.matchScore);

  // 4. 피부 타입별 피니시 추천
  let finish: 'matte' | 'satin' | 'dewy';
  if (skinType === 'oily') finish = 'matte';
  else if (skinType === 'dry') finish = 'dewy';
  else finish = 'satin';

  // 5. 팁 생성
  const tips: string[] = [];
  tips.push(`${undertoneResult.subtype} 언더톤에 맞는 쉐이드를 선택했습니다.`);
  if (skinType === 'oily') tips.push('T존에는 프라이머를 먼저 바르세요.');
  if (depthResult.depth === 'fair') tips.push('SPF가 포함된 제품을 추천합니다.');

  return {
    recommendedShades: scoredShades.slice(0, 5).map(s => ({
      name: s.name,
      code: s.code,
      labValue: s.lab,
      matchScore: s.matchScore,
    })),
    undertone: undertoneResult.undertone,
    depth: depthResult.depth,
    finish,
    tips,
  };
}
```

### 5.4 한국인 피부톤 분포 데이터

```typescript
/**
 * 한국인 피부톤 분포 데이터
 *
 * 출처:
 * - Puzovic (2012) Korean Skin Color Study
 * - Son (2013) East Asian Skin Pigmentation
 * - 잼페이스 139만건 분석 데이터
 */
const KOREAN_SKIN_DISTRIBUTION = {
  // Lab 평균값
  average: {
    L: 63.0,  // 중간 밝기
    a: 10.0,  // 약간 붉은기
    b: 18.5,  // 높은 황색 (동아시아 특징)
  },

  // 표준편차
  standardDeviation: {
    L: 5.2,
    a: 2.1,
    b: 3.5,
  },

  // 언더톤 분포
  undertoneDistribution: {
    'warm': 52,      // 52% (봄+가을)
    'cool': 38,      // 38% (여름+겨울)
    'neutral': 10,   // 10%
  },

  // 계절 분포 (잼페이스 데이터)
  seasonDistribution: {
    'autumn': 34.5,  // 가을 웜 최다
    'summer': 28.9,  // 여름 쿨
    'spring': 18.2,  // 봄 웜
    'winter': 18.4,  // 겨울 쿨
  },

  // Depth 분포
  depthDistribution: {
    'fair': 10,
    'light': 45,     // 가장 많음
    'medium': 35,
    'tan': 8,
    'deep': 2,
  },

  // 성별/연령 보정값
  adjustments: {
    'female_20s': { L: +2, a: -0.5 },
    'female_30s': { L: +1, a: 0 },
    'female_40s': { L: 0, a: +0.5 },
    'male_20s': { L: -1, a: +0.3 },
    'male_30s': { L: -1.5, a: +0.5 },
    'male_40s': { L: -2, a: +0.8 },
  },
};
```

### 5.5 파운데이션 산화 보정 계수

파운데이션은 피부의 피지, 수분, 산소와 반응하여 시간이 지남에 따라 색상이 변한다. 이를 **산화(Oxidation)** 현상이라 한다.

#### 5.5.1 산화 현상 메커니즘

```
파운데이션 산화 과정:
1. 피지 반응: 피부 유분이 파운데이션 색소와 결합
2. 수분 증발: 수분 함량 감소로 색상 농축
3. 산소 노출: 철 산화물 기반 색소의 산화
4. pH 변화: 피부 pH와 제품 pH 차이로 인한 변색
```

#### 5.5.2 산화에 따른 Lab 변화

| 시간 | L* 변화 | a* 변화 | b* 변화 | 시각적 변화 |
|------|--------|--------|--------|-----------|
| 0분 | 0 | 0 | 0 | 도포 직후 (기준) |
| 30분 | -1 | +0.5 | +1 | 약간 어두워짐 |
| 2시간 | -2 | +1 | +2.5 | 노란기 증가 |
| 6시간 | -3 | +1.5 | +4 | 최대 산화 |
| 8시간+ | -3 | +1.5 | +4 | 안정화 |

#### 5.5.3 산화 보정 알고리즘

```typescript
/**
 * 파운데이션 산화 보정 계수 계산
 *
 * 산화를 예측하여 더 밝고 덜 노란 쉐이드 선택
 */
interface OxidationCorrectionParams {
  skinType: 'dry' | 'normal' | 'oily' | 'combination';
  humidity: number;     // 환경 습도 (0-100%)
  temperature: number;  // 환경 온도 (섭씨)
  wearTime: number;     // 예상 착용 시간 (시간)
}

interface OxidationCorrection {
  L: number;  // 명도 보정값
  a: number;  // a* 보정값
  b: number;  // b* 보정값
  explanation: string;
}

function calculateOxidationCorrection(
  params: OxidationCorrectionParams
): OxidationCorrection {
  const { skinType, humidity, temperature, wearTime } = params;

  // 기본 산화 계수 (6시간 기준)
  let baseLCorrection = -2.5;
  let baseACorrection = 1.2;
  let baseBCorrection = 3.5;

  // 1. 피부 타입별 조정 계수
  const skinTypeMultiplier: Record<string, number> = {
    'dry': 0.6,        // 건성: 피지 적음 → 산화 감소
    'normal': 1.0,     // 정상: 기준
    'oily': 1.5,       // 지성: 피지 많음 → 산화 증가
    'combination': 1.2, // 복합: 중간
  };
  const skinMultiplier = skinTypeMultiplier[skinType];

  // 2. 환경 습도 영향 (높을수록 산화 감소)
  // 습도 50%를 기준으로 ±0.5% per 1%
  const humidityFactor = 1 - (humidity - 50) * 0.005;

  // 3. 환경 온도 영향 (높을수록 산화 증가)
  // 25°C를 기준으로 ±2% per 1°C
  const temperatureFactor = 1 + (temperature - 25) * 0.02;

  // 4. 착용 시간 영향 (6시간까지 증가, 이후 안정)
  const timeFactor = Math.min(wearTime / 6, 1);

  // 최종 보정값 계산
  const finalL = baseLCorrection * skinMultiplier * humidityFactor * temperatureFactor * timeFactor;
  const finalA = baseACorrection * skinMultiplier * humidityFactor * temperatureFactor * timeFactor;
  const finalB = baseBCorrection * skinMultiplier * humidityFactor * temperatureFactor * timeFactor;

  return {
    L: Math.round(finalL * 10) / 10,
    a: Math.round(finalA * 10) / 10,
    b: Math.round(finalB * 10) / 10,
    explanation: `${skinType} 피부, 습도 ${humidity}%, 온도 ${temperature}°C, ${wearTime}시간 착용 기준`,
  };
}

/**
 * 산화 보정 적용하여 파운데이션 선택
 */
function applyOxidationCorrection(
  targetSkinLab: LabColor,
  oxidation: OxidationCorrection
): LabColor {
  // 산화를 예상하여 역보정 (더 밝고, 덜 붉고, 덜 노란 쉐이드)
  return {
    L: targetSkinLab.L - oxidation.L,  // 예: L63 - (-2.5) = L65.5
    a: targetSkinLab.a - oxidation.a,  // 예: a10 - 1.2 = a8.8
    b: targetSkinLab.b - oxidation.b,  // 예: b18 - 3.5 = b14.5
  };
}
```

#### 5.5.4 피부 타입별 산화 특성

| 피부 타입 | 산화 속도 | 주요 변화 | 권장 대응 |
|----------|----------|----------|----------|
| **건성** | 느림 (0.6x) | L* 감소 미미 | 본래 색상에 가깝게 선택 |
| **정상** | 보통 (1.0x) | 균형적 변화 | 0.5~1톤 밝게 선택 |
| **지성** | 빠름 (1.5x) | b* 증가 현저 | 1~1.5톤 밝고 쿨하게 선택 |
| **복합** | 빠름~보통 | T존 위주 변화 | T존 기준 1톤 밝게 선택 |

#### 5.5.5 한국 쉐이드 시스템 (13호-27호)과 산화 보정

```typescript
/**
 * 한국 파운데이션 호수 체계와 산화 보정
 */
const KOREAN_SHADE_SYSTEM: Record<number, {
  name: string;
  labCenter: LabColor;
  undertoneVariants: Record<string, LabColor>;
  oxidationAdjustedShade: number;  // 지성 피부 기준 추천 호수
}> = {
  13: {
    name: '아이보리',
    labCenter: { L: 75, a: 7, b: 15 },
    undertoneVariants: {
      'warm': { L: 75, a: 8, b: 18 },
      'cool': { L: 76, a: 6, b: 12 },
      'neutral': { L: 75, a: 7, b: 15 },
    },
    oxidationAdjustedShade: 13,  // 유지
  },
  17: {
    name: '밝은 베이지',
    labCenter: { L: 70, a: 8, b: 17 },
    undertoneVariants: {
      'warm': { L: 70, a: 9, b: 20 },
      'cool': { L: 71, a: 7, b: 14 },
      'neutral': { L: 70, a: 8, b: 17 },
    },
    oxidationAdjustedShade: 13,  // 한 단계 밝게
  },
  21: {
    name: '내추럴 베이지',
    labCenter: { L: 65, a: 9, b: 18 },
    undertoneVariants: {
      'warm': { L: 65, a: 10, b: 21 },
      'cool': { L: 66, a: 8, b: 15 },
      'neutral': { L: 65, a: 9, b: 18 },
    },
    oxidationAdjustedShade: 17,  // 한 단계 밝게
  },
  23: {
    name: '웜 베이지',
    labCenter: { L: 60, a: 10, b: 20 },
    undertoneVariants: {
      'warm': { L: 60, a: 11, b: 23 },
      'cool': { L: 61, a: 9, b: 17 },
      'neutral': { L: 60, a: 10, b: 20 },
    },
    oxidationAdjustedShade: 21,  // 한 단계 밝게
  },
  25: {
    name: '딥 베이지',
    labCenter: { L: 55, a: 11, b: 21 },
    undertoneVariants: {
      'warm': { L: 55, a: 12, b: 24 },
      'cool': { L: 56, a: 10, b: 18 },
      'neutral': { L: 55, a: 11, b: 21 },
    },
    oxidationAdjustedShade: 23,  // 한 단계 밝게
  },
  27: {
    name: '탄 베이지',
    labCenter: { L: 50, a: 12, b: 22 },
    undertoneVariants: {
      'warm': { L: 50, a: 13, b: 25 },
      'cool': { L: 51, a: 11, b: 19 },
      'neutral': { L: 50, a: 12, b: 22 },
    },
    oxidationAdjustedShade: 25,  // 한 단계 밝게
  },
};

/**
 * 산화 고려한 최종 쉐이드 추천
 */
function recommendShadeWithOxidation(
  skinLab: LabColor,
  undertone: 'warm' | 'cool' | 'neutral',
  skinType: 'dry' | 'normal' | 'oily' | 'combination'
): {
  exactMatch: number;      // 정확한 매칭 호수
  oxidationAdjusted: number;  // 산화 보정 호수
  recommendation: string;
} {
  // 1. 피부 L*에 가장 가까운 호수 찾기
  const shadeNumbers = [13, 17, 21, 23, 25, 27];
  let closestShade = 21;
  let minDiff = Infinity;

  for (const shade of shadeNumbers) {
    const shadeLab = KOREAN_SHADE_SYSTEM[shade].undertoneVariants[undertone];
    const diff = Math.abs(skinLab.L - shadeLab.L);
    if (diff < minDiff) {
      minDiff = diff;
      closestShade = shade;
    }
  }

  // 2. 피부 타입별 산화 보정
  let adjustedShade = closestShade;
  if (skinType === 'oily') {
    adjustedShade = KOREAN_SHADE_SYSTEM[closestShade].oxidationAdjustedShade;
  } else if (skinType === 'combination') {
    // T존 기준으로 약간만 밝게
    const index = shadeNumbers.indexOf(closestShade);
    adjustedShade = index > 0 ? shadeNumbers[index - 1] : closestShade;
  }

  return {
    exactMatch: closestShade,
    oxidationAdjusted: adjustedShade,
    recommendation: skinType === 'oily'
      ? `${closestShade}호 대신 ${adjustedShade}호를 추천합니다 (산화 보정)`
      : `${closestShade}호가 잘 맞습니다`,
  };
}
```

---

## 5-1. 조명별 메이크업 보정

### 5-1.1 광원 색온도와 메이크업

조명에 따라 메이크업이 다르게 보이므로, 목적에 맞는 보정이 필요하다.

#### 5-1.1.1 색온도 기준

| 광원 | 색온도 (K) | 특성 | Lab 영향 |
|------|-----------|------|---------|
| 촛불 | 1,850K | 매우 따뜻함 | b* +15, L* -5 |
| 백열등 | 2,700K | 따뜻함 | b* +10, L* -3 |
| 할로겐 | 3,000K | 따뜻한 백색 | b* +7, L* -2 |
| 형광등 (전구색) | 3,500K | 중간 웜 | b* +4 |
| 형광등 (주광색) | 5,000K | 자연광 유사 | 기준 |
| 자연광 (정오) | 5,500K | 표준 | 기준 |
| 흐린 날 | 6,500K | 약간 차가움 | b* -5 |
| 청색 LED | 8,000K+ | 차가움 | b* -10, a* -3 |

#### 5-1.1.2 자연광 vs 인공조명 비교

```typescript
/**
 * 조명 조건 정의
 */
interface LightingCondition {
  type: 'natural' | 'incandescent' | 'fluorescent' | 'led';
  colorTemperature: number;  // Kelvin
  intensity: number;         // 0-100 (밝기)
  direction: 'overhead' | 'front' | 'side' | 'mixed';
}

/**
 * 조명별 Lab 보정 계수
 */
const LIGHTING_LAB_CORRECTIONS: Record<string, {
  L: number;
  a: number;
  b: number;
  description: string;
}> = {
  'candle': { L: -5, a: +2, b: +15, description: '매우 따뜻한 노란빛' },
  'incandescent_2700K': { L: -3, a: +1, b: +10, description: '따뜻한 노란빛' },
  'halogen_3000K': { L: -2, a: +0.5, b: +7, description: '따뜻한 백색' },
  'fluorescent_warm_3500K': { L: -1, a: 0, b: +4, description: '약간 따뜻함' },
  'fluorescent_daylight_5000K': { L: 0, a: 0, b: 0, description: '자연광 유사 (기준)' },
  'natural_noon_5500K': { L: 0, a: 0, b: 0, description: '표준 자연광 (기준)' },
  'overcast_6500K': { L: +2, a: -1, b: -5, description: '약간 차가움' },
  'blue_led_8000K': { L: +3, a: -3, b: -10, description: '차가운 청색' },
};
```

### 5-1.2 상황별 메이크업 보정

#### 5-1.2.1 상황-조명 매트릭스

| 상황 | 예상 조명 | 파운데이션 보정 | 립 보정 | 아이 보정 |
|------|----------|---------------|--------|----------|
| 사무실 | 형광등 5000K | 표준 | 표준 | 약간 진하게 |
| 카페 | 백열등 2700K | 쿨톤 +10% | 쿨톤 선택 | 뉴트럴 유지 |
| 야외 피크닉 | 자연광 5500K | 표준 | 표준 | 표준 |
| 저녁 레스토랑 | 촛불+백열 2000K | 쿨톤 강화 | 진한 쿨톤 | 스모키 가능 |
| 클럽/파티 | 컬러 LED | 채도 높임 | 비비드 | 글리터 |
| 화상회의 | LED 모니터 빛 | 웜톤 +5% | 자연스럽게 | 매트 권장 |

#### 5-1.2.2 조명 보정 알고리즘

```typescript
/**
 * 조명 조건에 따른 메이크업 색상 보정
 */
interface MakeupLightingCorrection {
  foundationCorrection: LabColor;
  lipCorrection: LabColor;
  eyeCorrection: LabColor;
  recommendation: string;
}

function calculateLightingMakeupCorrection(
  lighting: LightingCondition
): MakeupLightingCorrection {
  const { colorTemperature, type } = lighting;

  // 기준: 5500K 자연광
  const baseTemp = 5500;
  const tempDiff = colorTemperature - baseTemp;

  // 색온도당 b* 보정 계수 (경험적 수치)
  // 1000K 낮아질수록 b* +5 (더 노랗게 보임 → 쿨하게 보정)
  // 1000K 높아질수록 b* -3 (더 파랗게 보임 → 웜하게 보정)
  const bCorrectionPerK = tempDiff < 0 ? -0.005 : -0.003;
  const bCorrection = tempDiff * bCorrectionPerK;

  // a* 보정 (차가운 조명에서 붉은기 감소)
  const aCorrection = tempDiff > 1000 ? -2 : tempDiff < -1000 ? +1 : 0;

  // L* 보정 (어두운 조명에서 밝게 보정)
  const lCorrection = lighting.intensity < 50 ? +3 : 0;

  // 따뜻한 조명 (< 4000K): 쿨톤 메이크업으로 균형
  if (colorTemperature < 4000) {
    return {
      foundationCorrection: { L: 0, a: 0, b: Math.round(-bCorrection) },
      lipCorrection: { L: 0, a: +3, b: -5 },  // 쿨톤 강조
      eyeCorrection: { L: 0, a: +2, b: -4 },
      recommendation: '따뜻한 조명입니다. 쿨톤 메이크업으로 균형을 맞추세요.',
    };
  }

  // 차가운 조명 (> 6000K): 웜톤 메이크업으로 균형
  if (colorTemperature > 6000) {
    return {
      foundationCorrection: { L: 0, a: 0, b: Math.round(-bCorrection) },
      lipCorrection: { L: 0, a: -2, b: +5 },  // 웜톤 강조
      eyeCorrection: { L: 0, a: -1, b: +3 },
      recommendation: '차가운 조명입니다. 웜톤 메이크업으로 균형을 맞추세요.',
    };
  }

  // 중립 조명 (4000-6000K)
  return {
    foundationCorrection: { L: 0, a: 0, b: 0 },
    lipCorrection: { L: 0, a: 0, b: 0 },
    eyeCorrection: { L: 0, a: 0, b: 0 },
    recommendation: '자연광과 유사한 조명입니다. 표준 메이크업을 적용하세요.',
  };
}
```

### 5-1.3 색순응 (Chromatic Adaptation)

#### 5-1.3.1 CAT02 색순응 변환

인간의 눈은 광원에 적응하여 백색점을 자동 보정한다. 메이크업 분석에서도 이를 고려해야 한다.

```typescript
/**
 * 간략화된 색순응 보정 (CAT02 기반)
 *
 * 백색점 변환: 조명 A → 조명 B로 촬영된 이미지의 색상 보정
 */
interface WhitePoint {
  X: number;
  Y: number;
  Z: number;
}

// 표준 백색점 (CIE)
const WHITE_POINTS: Record<string, WhitePoint> = {
  'D50': { X: 0.9642, Y: 1.0000, Z: 0.8251 },  // 따뜻한 일광
  'D55': { X: 0.9568, Y: 1.0000, Z: 0.9214 },  // 중간 일광
  'D65': { X: 0.9504, Y: 1.0000, Z: 1.0888 },  // 표준 일광 (기준)
  'A': { X: 1.0985, Y: 1.0000, Z: 0.3558 },    // 백열등
  'F11': { X: 1.0090, Y: 1.0000, Z: 0.6435 },  // 형광등
};

/**
 * 조명 보정된 Lab 계산
 */
function correctForLighting(
  originalLab: LabColor,
  sourceWhitePoint: WhitePoint,
  targetWhitePoint: WhitePoint = WHITE_POINTS['D65']
): LabColor {
  // 간략화된 선형 보정 (실제 CAT02는 더 복잡)
  const scaleX = targetWhitePoint.X / sourceWhitePoint.X;
  const scaleY = targetWhitePoint.Y / sourceWhitePoint.Y;
  const scaleZ = targetWhitePoint.Z / sourceWhitePoint.Z;

  // Lab는 XYZ 기반이므로 근사적으로 b*에 주로 영향
  const correctedLab: LabColor = {
    L: originalLab.L,
    a: originalLab.a * Math.sqrt(scaleX / scaleY),
    b: originalLab.b * Math.sqrt(scaleY / scaleZ),
  };

  return correctedLab;
}
```

### 5-1.4 실전 조명 보정 가이드

```
┌─────────────────────────────────────────────────────────────────────┐
│                     조명별 메이크업 보정 가이드                        │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  📍 따뜻한 조명 (레스토랑, 카페, 백열등)                            │
│     ┌────────────────────────────────────────────────────┐         │
│     │ 문제: 얼굴이 노랗게/주황색으로 보임                  │         │
│     │ 해결: 쿨톤 메이크업으로 중화                        │         │
│     │                                                     │         │
│     │ • 파운데이션: 핑크 언더톤 선택                      │         │
│     │ • 립: 블루베이스 핑크, 로즈 계열                   │         │
│     │ • 블러셔: 쿨핑크, 라벤더 핑크                       │         │
│     │ • 아이: 회색, 쿨브라운, 보라 계열                   │         │
│     └────────────────────────────────────────────────────┘         │
│                                                                      │
│  📍 차가운 조명 (사무실 형광등, LED)                                │
│     ┌────────────────────────────────────────────────────┐         │
│     │ 문제: 얼굴이 창백하고 푸르스름해 보임               │         │
│     │ 해결: 웜톤 메이크업으로 생기 부여                   │         │
│     │                                                     │         │
│     │ • 파운데이션: 골드/옐로 언더톤 선택                 │         │
│     │ • 립: 코랄, 오렌지, 테라코타 계열                  │         │
│     │ • 블러셔: 피치, 산호색                              │         │
│     │ • 아이: 웜브라운, 골드, 코퍼 계열                   │         │
│     └────────────────────────────────────────────────────┘         │
│                                                                      │
│  📍 자연광 (야외, 창가)                                             │
│     ┌────────────────────────────────────────────────────┐         │
│     │ 특징: 가장 정확하게 색상이 보임                     │         │
│     │ 주의: 결점도 잘 보이므로 베이스 꼼꼼하게           │         │
│     │                                                     │         │
│     │ • 파운데이션: 실제 피부톤에 맞춤                    │         │
│     │ • 립: 퍼스널컬러 그대로 적용                       │         │
│     │ • 전체: 자연스러운 마무리 권장                      │         │
│     └────────────────────────────────────────────────────┘         │
│                                                                      │
│  📍 혼합 조명 (파티, 웨딩홀)                                        │
│     ┌────────────────────────────────────────────────────┐         │
│     │ 특징: 다양한 조명이 섞여 예측 어려움                │         │
│     │ 해결: 중립적이고 선명한 색상 선택                   │         │
│     │                                                     │         │
│     │ • 파운데이션: 뉴트럴 톤, 약간 밝게                 │         │
│     │ • 립: 채도 높은 색상 (어디서든 선명)               │         │
│     │ • 아이: 그라데이션 + 포인트 컬러                    │         │
│     │ • 하이라이트: 은은하게 (과도하면 번들거림)          │         │
│     └────────────────────────────────────────────────────┘         │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 6. 컨투어링/하이라이팅

### 6.1 얼굴형별 셰이딩 위치 매핑

```typescript
/**
 * 얼굴형 분류
 */
type FaceShape = 'oval' | 'round' | 'oblong' | 'square' | 'heart' | 'diamond';

/**
 * 컨투어링 영역 정의
 */
interface ContouringZone {
  name: string;
  description: string;
  landmarks: number[];  // 68점 랜드마크 인덱스
  importance: 'primary' | 'secondary';
}

const FACE_SHAPE_CONTOURING: Record<FaceShape, {
  shadingZones: ContouringZone[];
  highlightZones: ContouringZone[];
  goal: string;
  tips: string[];
}> = {
  'oval': {
    shadingZones: [
      { name: '헤어라인', description: '이마 양쪽 헤어라인', landmarks: [0, 1, 16, 15], importance: 'secondary' },
      { name: '턱선', description: '턱 양쪽 라인', landmarks: [5, 6, 7, 8, 9, 10, 11], importance: 'secondary' },
    ],
    highlightZones: [
      { name: 'T존', description: '이마 중앙~코', landmarks: [27, 28, 29, 30], importance: 'primary' },
      { name: '광대 상단', description: '광대뼈 위', landmarks: [36, 45], importance: 'secondary' },
    ],
    goal: '자연스러운 입체감 강조 (이미 이상적 비율)',
    tips: ['컨투어링을 과하게 하지 않아도 됩니다', '하이라이트로 자연스러운 광채 추가'],
  },

  'round': {
    shadingZones: [
      { name: '볼 양쪽', description: '볼살 부분', landmarks: [2, 3, 4, 12, 13, 14], importance: 'primary' },
      { name: '턱선', description: '전체 턱 라인', landmarks: [5, 6, 7, 8, 9, 10, 11], importance: 'primary' },
    ],
    highlightZones: [
      { name: '이마 중앙', description: '이마 세로로 길게', landmarks: [19, 20, 21, 22, 23, 24], importance: 'primary' },
      { name: '코', description: '콧대', landmarks: [27, 28, 29, 30], importance: 'primary' },
      { name: '턱 끝', description: '턱 중앙', landmarks: [8], importance: 'secondary' },
    ],
    goal: '세로로 길어 보이게, 볼 축소',
    tips: ['볼 양쪽 셰이딩으로 폭 줄이기', '세로 하이라이트로 길이감 추가', '블러셔는 광대 위쪽으로'],
  },

  'oblong': {
    shadingZones: [
      { name: '이마 상단', description: '헤어라인 전체', landmarks: [0, 1, 17, 16, 15], importance: 'primary' },
      { name: '턱 끝', description: '턱 하단', landmarks: [7, 8, 9], importance: 'primary' },
    ],
    highlightZones: [
      { name: '볼 중앙', description: '광대 중앙', landmarks: [29, 30], importance: 'primary' },
      { name: '눈 아래', description: '다크서클 위치', landmarks: [40, 41, 46, 47], importance: 'secondary' },
    ],
    goal: '가로로 넓어 보이게, 길이감 축소',
    tips: ['이마/턱에 셰이딩으로 길이 줄이기', '볼에 하이라이트로 가로 확장', '블러셔는 수평으로'],
  },

  'square': {
    shadingZones: [
      { name: '턱 양쪽', description: '각진 턱 모서리', landmarks: [4, 5, 6, 10, 11, 12], importance: 'primary' },
      { name: '이마 양쪽', description: '이마 모서리', landmarks: [0, 1, 2, 14, 15, 16], importance: 'secondary' },
    ],
    highlightZones: [
      { name: 'T존', description: '이마~코', landmarks: [27, 28, 29, 30], importance: 'primary' },
      { name: '볼 상단', description: '광대 위', landmarks: [36, 45], importance: 'secondary' },
    ],
    goal: '각진 부분 부드럽게, 곡선감 추가',
    tips: ['턱 모서리 셰이딩 필수', '블러셔는 둥글게 발라 곡선 연출', '이마 양옆도 살짝 셰이딩'],
  },

  'heart': {
    shadingZones: [
      { name: '이마 양쪽', description: '넓은 이마 측면', landmarks: [0, 1, 2, 14, 15, 16], importance: 'primary' },
      { name: '광대 측면', description: '광대뼈 옆', landmarks: [2, 3, 13, 14], importance: 'secondary' },
    ],
    highlightZones: [
      { name: '턱 중앙', description: '좁은 턱 강조', landmarks: [7, 8, 9], importance: 'primary' },
      { name: '볼 하단', description: '볼 아래쪽', landmarks: [31, 35], importance: 'secondary' },
    ],
    goal: '하부 볼륨감 추가, 상부 축소',
    tips: ['이마 양옆 셰이딩으로 폭 줄이기', '턱에 하이라이트로 볼륨감', '블러셔는 볼 아래쪽으로'],
  },

  'diamond': {
    shadingZones: [
      { name: '광대 측면', description: '돌출된 광대 옆', landmarks: [2, 3, 4, 12, 13, 14], importance: 'primary' },
    ],
    highlightZones: [
      { name: '이마 중앙', description: '좁은 이마 확장', landmarks: [19, 20, 21, 22, 23, 24], importance: 'primary' },
      { name: '턱 중앙', description: '좁은 턱 확장', landmarks: [7, 8, 9], importance: 'primary' },
    ],
    goal: '상하부 균형, 광대 축소',
    tips: ['광대 옆 셰이딩으로 돌출 완화', '이마/턱 하이라이트로 균형', '블러셔는 광대 아래로'],
  },
};
```

### 6.2 컨투어링 강도 계산 알고리즘

```typescript
/**
 * 컨투어링 강도 계산
 *
 * 얼굴형과 이목구비 돌출도에 따라 강도 결정
 */
interface ContouringIntensityResult {
  intensity: 'light' | 'medium' | 'bold';
  score: number;  // 0-100
  reasons: string[];
}

function calculateContouringIntensity(
  faceShape: FaceShape,
  featureProminence: number,  // 이목구비 돌출도 0-100
  occasion?: 'daily' | 'office' | 'event'
): ContouringIntensityResult {
  // 기본 강도 (얼굴형 기반)
  const baseIntensity: Record<FaceShape, number> = {
    'oval': 30,      // 계란형은 최소 컨투어링
    'round': 60,     // 둥근형은 중간
    'oblong': 50,    // 긴형은 중간
    'square': 70,    // 사각형은 높음
    'heart': 55,     // 하트형은 중간
    'diamond': 65,   // 다이아몬드는 높음
  };

  let score = baseIntensity[faceShape];
  const reasons: string[] = [];

  // 이목구비 돌출도 보정 (뚜렷하면 컨투어링 줄임)
  if (featureProminence > 70) {
    score -= 15;
    reasons.push('이목구비가 뚜렷해 가벼운 컨투어링 추천');
  } else if (featureProminence < 40) {
    score += 10;
    reasons.push('이목구비에 입체감을 더해줄 컨투어링 추천');
  }

  // 상황별 보정
  if (occasion === 'daily') {
    score -= 20;
    reasons.push('데일리 메이크업에 맞춰 자연스럽게');
  } else if (occasion === 'event') {
    score += 15;
    reasons.push('특별한 날에 맞춰 선명하게');
  }

  // 범위 제한
  score = Math.max(20, Math.min(90, score));

  // 강도 레벨 결정
  let intensity: 'light' | 'medium' | 'bold';
  if (score < 40) intensity = 'light';
  else if (score < 65) intensity = 'medium';
  else intensity = 'bold';

  return { intensity, score, reasons };
}
```

### 6.3 음영 기법 원리

```
┌─────────────────────────────────────────────────────────────────────┐
│                       컨투어링 기본 원리                              │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  ◆ 셰이딩 (어두운 색)                                               │
│     - 사용 색: 피부보다 2-3톤 어두운 색                             │
│     - 효과: 축소, 후퇴                                              │
│     - 적용: 줄이고 싶은 부분 (볼살, 턱, 이마 옆)                    │
│                                                                      │
│  ◆ 하이라이트 (밝은 색)                                             │
│     - 사용 색: 피부보다 2-3톤 밝은 색 + 광택                        │
│     - 효과: 확대, 전진                                              │
│     - 적용: 강조하고 싶은 부분 (T존, 광대 위, 턱 끝)               │
│                                                                      │
│  ◆ 블렌딩 핵심                                                      │
│     - 경계선이 보이면 실패                                          │
│     - 안쪽에서 바깥쪽으로 블렌딩                                    │
│     - 젖은 스펀지/브러시로 자연스럽게                               │
│                                                                      │
│  ◆ 조명 원리                                                        │
│                                                                      │
│              빛 (위에서)                                            │
│                 ↓                                                   │
│          ┌───────────┐                                             │
│          │  이마     │ ← 밝음 (하이라이트)                         │
│          │           │                                              │
│          │  코       │ ← 밝음                                      │
│          │           │                                              │
│          │  볼       │ ← 측면 어둡게 (셰이딩)                      │
│          │           │                                              │
│          │  턱       │ ← 아래쪽 어둡게                             │
│          └───────────┘                                             │
│                                                                      │
│  자연광 원리를 따라 셰이딩하면 자연스러움                           │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 7. K-뷰티 트렌드 분석 (2024-2026)

### 7.1 K-뷰티 메이크업 주요 트렌드

```typescript
/**
 * K-뷰티 메이크업 트렌드 2024-2026
 */
interface KBeautyTrend {
  name: string;
  koreanName: string;
  period: string;
  characteristics: string[];
  keyProducts: string[];
  colorPalette: string[];
  targetSeason: Season[];
}

const K_BEAUTY_TRENDS: KBeautyTrend[] = [
  {
    name: 'Glass Skin Makeup',
    koreanName: '유리알 피부 메이크업',
    period: '2024-2026 (지속)',
    characteristics: [
      '촉촉하고 투명한 피부 표현',
      '하이드레이팅 베이스',
      '최소한의 파우더',
      '내부에서 빛나는 듯한 광채',
    ],
    keyProducts: ['수분 세럼', '글로우 프라이머', '쿠션 파운데이션', '하이라이터'],
    colorPalette: ['#FFE4E1', '#FAEBD7', '#FFF0F5'],
    targetSeason: ['spring', 'summer'],
  },

  {
    name: 'Latte Makeup',
    koreanName: '라떼 메이크업',
    period: '2024-2025',
    characteristics: [
      '부드러운 브라운 톤',
      '뮤트한 색감',
      '자연스러운 음영',
      '카페라떼 같은 따뜻함',
    ],
    keyProducts: ['브라운 아이섀도우', '누드 브라운 립', '브론저'],
    colorPalette: ['#D2B48C', '#C4A484', '#8B7355', '#A0522D'],
    targetSeason: ['autumn', 'spring'],
  },

  {
    name: 'Douyin Makeup (도우인 메이크업)',
    koreanName: '중국풍 메이크업',
    period: '2025-2026',
    characteristics: [
      '강조된 아이 메이크업',
      '하이라이트 포인트',
      '인형 같은 느낌',
      '선명한 컬러',
    ],
    keyProducts: ['아이글리터', '컬러 아이라이너', '볼드 립'],
    colorPalette: ['#FF69B4', '#FFD700', '#FF4500'],
    targetSeason: ['winter', 'spring'],
  },

  {
    name: 'Clean Girl Makeup',
    koreanName: '클린걸 메이크업',
    period: '2023-2025',
    characteristics: [
      'No-makeup makeup',
      '건강한 피부 강조',
      '미니멀한 컬러',
      '자연스러운 눈썹',
    ],
    keyProducts: ['틴티드 모이스처라이저', '립밤', '브로우 젤'],
    colorPalette: ['#FFDAB9', '#FFE4C4', '#F5DEB3'],
    targetSeason: ['spring', 'summer'],
  },

  {
    name: 'Cherry Red Trend',
    koreanName: '체리 레드 트렌드',
    period: '2025-2026',
    characteristics: [
      '선명한 체리 레드 립',
      '깔끔한 베이스',
      '아이는 미니멀하게',
      '레트로 무드',
    ],
    keyProducts: ['레드 립스틱', '립라이너', '세팅 스프레이'],
    colorPalette: ['#DE3163', '#DC143C', '#B22222'],
    targetSeason: ['winter', 'summer'],
  },

  {
    name: 'Soft Glam',
    koreanName: '소프트 글램',
    period: '2024-2026',
    characteristics: [
      '부드러운 스모키',
      '글리터 포인트',
      '과하지 않은 화려함',
      '데이트룩 인기',
    ],
    keyProducts: ['쉬머 아이섀도우', '볼류밍 마스카라', 'MLBB 립'],
    colorPalette: ['#DDA0DD', '#E6E6FA', '#FFB6C1'],
    targetSeason: ['summer', 'winter'],
  },
];
```

### 7.2 글로시 vs 매트 트렌드 변화

```typescript
/**
 * 피니시 트렌드 변화 추이
 */
interface FinishTrend {
  year: number;
  glossyShare: number;  // %
  matteShare: number;   // %
  satinShare: number;   // %
  notes: string;
}

const FINISH_TREND_HISTORY: FinishTrend[] = [
  { year: 2022, glossyShare: 30, matteShare: 50, satinShare: 20, notes: '매트 전성기' },
  { year: 2023, glossyShare: 40, matteShare: 35, satinShare: 25, notes: 'Y2K 글로시 회귀' },
  { year: 2024, glossyShare: 45, matteShare: 25, satinShare: 30, notes: '글로시 대세 + 새틴 상승' },
  { year: 2025, glossyShare: 50, matteShare: 20, satinShare: 30, notes: '글로우 전성기' },
  { year: 2026, glossyShare: 45, matteShare: 25, satinShare: 30, notes: '균형 회복 예상' },
];

/**
 * 카테고리별 피니시 트렌드 (2025-2026)
 */
const CATEGORY_FINISH_TREND = {
  lip: {
    trending: ['glossy', 'glass'],
    declining: ['velvet-matte'],
    steady: ['satin'],
    note: '투명한 글로시 립이 대세, 매트는 퇴조',
  },
  eye: {
    trending: ['shimmer', 'glitter'],
    declining: ['matte-only'],
    steady: ['multi-texture'],
    note: '쉬머/글리터 포인트, 전체 매트는 감소',
  },
  base: {
    trending: ['dewy', 'glass-skin'],
    declining: ['full-matte'],
    steady: ['satin'],
    note: '촉촉한 베이스가 주류, 세미매트 유지',
  },
  blush: {
    trending: ['cream', 'liquid'],
    declining: ['powder-matte'],
    steady: ['powder-shimmer'],
    note: '크림/리퀴드 타입 인기, 내추럴한 발색',
  },
};
```

### 7.3 K-뷰티 내추럴 메이크업 특성

```typescript
/**
 * K-뷰티 내추럴 메이크업의 특징
 */
const K_BEAUTY_NATURAL_CHARACTERISTICS = {
  // 베이스
  base: {
    goal: '피부 결점 커버하되 피부처럼 보이게',
    technique: '얇은 레이어링 + 부분 커버',
    finish: 'dewy to satin',
    keyPoints: [
      '피부 자체의 결이 살아있게',
      '두껍게 바르지 않기',
      '파운데이션보다 스킨케어에 집중',
    ],
  },

  // 아이 메이크업
  eye: {
    goal: '눈이 커 보이되 과하지 않게',
    technique: '자연스러운 그라데이션 + 포인트 글리터',
    keyPoints: [
      '아이라인은 점막 라인 또는 스머지',
      '속눈썹 중시 (컬링 + 자연스러운 볼륨)',
      '컬러는 브라운 계열 위주',
    ],
  },

  // 립
  lip: {
    goal: 'MLBB (My Lips But Better)',
    technique: '그라데이션 립 + 틴트 레이어링',
    keyPoints: [
      '입술 자체 색과 유사하되 더 좋아 보이게',
      '풀 커버리지보다 자연스러운 발색',
      '글로시하거나 촉촉한 마무리',
    ],
  },

  // 볼
  cheek: {
    goal: '자연스럽게 상기된 듯한 홍조',
    technique: '크림 블러셔 + 가볍게 블렌딩',
    keyPoints: [
      '광대 아래 또는 사과 존에 자연스럽게',
      '과하지 않은 발색',
      '피부 안에서 우러나오는 듯한 느낌',
    ],
  },

  // 눈썹
  brow: {
    goal: '자연스럽게 정돈된 눈썹',
    technique: '빈 부분만 채우기 + 브로우 젤',
    keyPoints: [
      '과도한 그리기 지양',
      '자연스러운 눈썹 결 살리기',
      '모발과 유사한 색상',
    ],
  },
};
```

---

## 8. TypeScript 구현 방향

### 8.1 타입 정의 예시

```typescript
// types/makeup-analysis.ts

/**
 * Lab 색공간 타입
 */
export interface LabColor {
  L: number;  // 0-100 (명도)
  a: number;  // -128 ~ +127 (초록-빨강)
  b: number;  // -128 ~ +127 (파랑-노랑)
}

/**
 * 립 컬러 카테고리
 */
export type LipColorCategory =
  | 'nude'
  | 'pink'
  | 'coral'
  | 'red'
  | 'orange'
  | 'berry'
  | 'brown'
  | 'plum';

/**
 * 립 컬러 서브 카테고리
 */
export type LipSubCategory = 'mlbb' | 'bright' | 'deep' | undefined;

/**
 * 아이섀도우 카테고리
 */
export type EyeshadowCategory =
  | 'neutral-brown'
  | 'warm-brown'
  | 'cool-brown'
  | 'pink-tone'
  | 'smoky'
  | 'colorful'
  | 'glitter';

/**
 * 블러셔 카테고리
 */
export type BlusherCategory =
  | 'peach'
  | 'coral'
  | 'rose'
  | 'pink'
  | 'burgundy'
  | 'bronzer';

/**
 * 메이크업 피니시
 */
export type MakeupFinish = 'matte' | 'satin' | 'shimmer' | 'glitter' | 'glossy';

/**
 * 퍼스널컬러 시즌
 */
export type Season = 'spring' | 'summer' | 'autumn' | 'winter';

/**
 * M-1 분석 결과 타입
 */
export interface MakeupAnalysisResult {
  id: string;
  userId: string;

  lip?: {
    category: LipColorCategory;
    subCategory: LipSubCategory;
    dominantColor: {
      lab: LabColor;
      hex: string;
      name: string;
    };
    saturation: number;
    brightness: number;
    finish: MakeupFinish;
    confidence: number;
  };

  eye?: {
    category: EyeshadowCategory;
    dominantColor: { lab: LabColor; hex: string };
    secondaryColors: { lab: LabColor; hex: string }[];
    finishes: MakeupFinish[];
    warmCoolTone: 'warm' | 'cool' | 'neutral';
  };

  blusher?: {
    category: BlusherCategory;
    color: { lab: LabColor; hex: string };
    intensity: number;
  };

  overallStyle?: string;

  seasonHarmony?: {
    season: Season;
    overallScore: number;
    lipScore: number;
    eyeScore: number;
    blusherScore: number;
    feedback: string[];
  };

  metadata: {
    processingTime: number;
    confidence: number;
    imageQuality: 'good' | 'fair' | 'poor';
    usedFallback: boolean;
  };

  createdAt: string;
}
```

### 8.2 조화도 계산 알고리즘

```typescript
// lib/makeup/harmony/harmony-calculator.ts

/**
 * 메이크업 전체 조화도 계산
 *
 * 가중치:
 * - 톤 매칭: 40%
 * - 채도 균형: 25%
 * - 명도 조화: 20%
 * - 카테고리 매칭: 15%
 */
interface HarmonyScore {
  total: number;
  breakdown: {
    toneMatch: number;
    saturationBalance: number;
    lightnessHarmony: number;
    categoryMatch: number;
  };
  feedback: string[];
  recommendations: string[];
}

export function calculateMakeupHarmony(
  lipLab: LabColor,
  lipCategory: LipColorCategory,
  eyeLab: LabColor | null,
  eyeCategory: EyeshadowCategory | null,
  blusherLab: LabColor | null,
  blusherCategory: BlusherCategory | null,
  season: Season
): HarmonyScore {
  const weights = {
    toneMatch: 0.40,
    saturationBalance: 0.25,
    lightnessHarmony: 0.20,
    categoryMatch: 0.15,
  };

  // 1. 톤 매칭 (퍼스널컬러와 메이크업 색상 일치도)
  const toneMatch = calculateToneMatch(season, lipLab, eyeLab, blusherLab);

  // 2. 채도 균형 (립-아이-블러셔 간 채도 밸런스)
  const saturationBalance = calculateSaturationBalance(lipLab, eyeLab, blusherLab);

  // 3. 명도 조화 (명도 차이의 적절성)
  const lightnessHarmony = calculateLightnessHarmony(lipLab, eyeLab, blusherLab);

  // 4. 카테고리 매칭 (시즌 권장 카테고리 일치)
  const categoryMatch = calculateCategoryMatch(
    season,
    lipCategory,
    eyeCategory,
    blusherCategory
  );

  const total =
    toneMatch * weights.toneMatch +
    saturationBalance * weights.saturationBalance +
    lightnessHarmony * weights.lightnessHarmony +
    categoryMatch * weights.categoryMatch;

  // 피드백 생성
  const { feedback, recommendations } = generateHarmonyFeedback(
    { toneMatch, saturationBalance, lightnessHarmony, categoryMatch },
    season,
    lipCategory
  );

  return {
    total: Math.round(total),
    breakdown: {
      toneMatch: Math.round(toneMatch),
      saturationBalance: Math.round(saturationBalance),
      lightnessHarmony: Math.round(lightnessHarmony),
      categoryMatch: Math.round(categoryMatch),
    },
    feedback,
    recommendations,
  };
}

/**
 * 톤 매칭 점수 계산
 */
function calculateToneMatch(
  season: Season,
  lipLab: LabColor,
  eyeLab: LabColor | null,
  blusherLab: LabColor | null
): number {
  // 시즌별 이상적 a*, b* 범위
  const seasonIdeal: Record<Season, { a: [number, number]; b: [number, number] }> = {
    spring: { a: [10, 30], b: [15, 35] },   // 웜, 밝은
    summer: { a: [5, 25], b: [-10, 10] },   // 쿨, 부드러운
    autumn: { a: [15, 35], b: [20, 40] },   // 웜, 깊은
    winter: { a: [10, 40], b: [-15, 15] },  // 쿨, 선명한
  };

  const ideal = seasonIdeal[season];

  // 각 컬러의 범위 매칭 점수
  const lipScore = rangeMatchScore(lipLab.a, ideal.a) * 0.5 +
                   rangeMatchScore(lipLab.b, ideal.b) * 0.5;

  let eyeScore = 100;
  if (eyeLab) {
    eyeScore = rangeMatchScore(eyeLab.a, ideal.a) * 0.5 +
               rangeMatchScore(eyeLab.b, ideal.b) * 0.5;
  }

  let blusherScore = 100;
  if (blusherLab) {
    blusherScore = rangeMatchScore(blusherLab.a, ideal.a) * 0.5 +
                   rangeMatchScore(blusherLab.b, ideal.b) * 0.5;
  }

  // 가중 평균 (립 60%, 아이 20%, 블러셔 20%)
  return lipScore * 0.6 + eyeScore * 0.2 + blusherScore * 0.2;
}

/**
 * 값이 범위 내에 있는 정도를 점수화
 */
function rangeMatchScore(value: number, range: [number, number]): number {
  if (value >= range[0] && value <= range[1]) {
    // 범위 내: 80-100점
    const center = (range[0] + range[1]) / 2;
    const halfWidth = (range[1] - range[0]) / 2;
    const distanceFromCenter = Math.abs(value - center);
    return 100 - (distanceFromCenter / halfWidth) * 20;
  } else {
    // 범위 외: 거리에 따라 감점
    const distance = value < range[0] ? range[0] - value : value - range[1];
    return Math.max(30, 80 - distance * 3);
  }
}
```

### 8.3 Mock 데이터 구조

```typescript
// lib/makeup/mock/mock-generator.ts

/**
 * M-1 Mock 데이터 생성기
 */
export function generateMockMakeupAnalysis(
  season?: Season,
  options?: { style?: string; occasion?: string }
): MakeupAnalysisResult {
  const targetSeason = season || 'spring';
  const palette = SEASON_MAKEUP_PALETTES[targetSeason];

  return {
    id: crypto.randomUUID(),
    userId: 'mock-user',

    lip: {
      category: 'coral',
      subCategory: undefined,
      dominantColor: {
        lab: { L: 60, a: 35, b: 25 },
        hex: palette.lip[0]?.hex || '#FF7F7F',
        name: palette.lip[0]?.name || '코랄 핑크',
      },
      saturation: 70,
      brightness: 60,
      finish: 'satin',
      confidence: 70,
    },

    eye: {
      category: 'neutral-brown',
      dominantColor: {
        lab: { L: 50, a: 10, b: 20 },
        hex: '#8B7355',
      },
      secondaryColors: [
        { lab: { L: 65, a: 8, b: 25 }, hex: '#D4A76A' },
      ],
      finishes: ['matte', 'shimmer'],
      warmCoolTone: 'warm',
    },

    blusher: {
      category: 'peach',
      color: {
        lab: { L: 72, a: 22, b: 28 },
        hex: '#FFCBA4',
      },
      intensity: 55,
    },

    overallStyle: 'natural',

    seasonHarmony: season ? {
      season: targetSeason,
      overallScore: 78,
      lipScore: 82,
      eyeScore: 75,
      blusherScore: 80,
      feedback: [
        '전체적으로 시즌에 잘 맞는 색상을 사용하고 있어요.',
        '립 컬러가 특히 잘 어울립니다.',
        '아이섀도우에 조금 더 웜한 톤을 추가하면 좋겠어요.',
      ],
    } : undefined,

    metadata: {
      processingTime: 100,
      confidence: 70,
      imageQuality: 'fair',
      usedFallback: true,
    },

    createdAt: new Date().toISOString(),
  };
}

/**
 * 시즌별 메이크업 팔레트 (Mock용)
 */
export const SEASON_MAKEUP_PALETTES: Record<Season, {
  lip: { category: LipColorCategory; hex: string; name: string; matchScore: number }[];
  eyeshadow: { category: EyeshadowCategory; colors: string[]; matchScore: number }[];
  blusher: { category: BlusherCategory; hex: string; matchScore: number }[];
  tips: string[];
}> = {
  spring: {
    lip: [
      { category: 'coral', hex: '#FF7F7F', name: '코랄 핑크', matchScore: 95 },
      { category: 'orange', hex: '#FF8C42', name: '오렌지 레드', matchScore: 90 },
      { category: 'nude', hex: '#E8B89D', name: '피치 누드', matchScore: 88 },
      { category: 'pink', hex: '#FFB6C1', name: '라이트 핑크', matchScore: 85 },
    ],
    eyeshadow: [
      { category: 'warm-brown', colors: ['#D4A76A', '#C19A6B', '#8B7355'], matchScore: 95 },
      { category: 'pink-tone', colors: ['#FFDAB9', '#FFB6C1', '#DDA0DD'], matchScore: 88 },
      { category: 'glitter', colors: ['#FFD700', '#FFDAB9'], matchScore: 85 },
    ],
    blusher: [
      { category: 'peach', hex: '#FFCBA4', matchScore: 95 },
      { category: 'coral', hex: '#FF7F7F', matchScore: 92 },
    ],
    tips: [
      '따뜻하고 밝은 컬러로 화사한 느낌 연출',
      '골드 글리터로 포인트 추가',
      '차가운 베리/플럼 계열은 피하세요',
    ],
  },

  summer: {
    lip: [
      { category: 'pink', hex: '#FFB6C1', name: '로즈 핑크', matchScore: 95 },
      { category: 'berry', hex: '#8B4557', name: '소프트 베리', matchScore: 90 },
      { category: 'nude', hex: '#D8BFD8', name: '라벤더 누드', matchScore: 88 },
      { category: 'plum', hex: '#9370DB', name: '소프트 플럼', matchScore: 85 },
    ],
    eyeshadow: [
      { category: 'cool-brown', colors: ['#8B7D7B', '#696969', '#BC8F8F'], matchScore: 95 },
      { category: 'pink-tone', colors: ['#FFE4E1', '#E6E6FA', '#DDA0DD'], matchScore: 90 },
      { category: 'glitter', colors: ['#C0C0C0', '#E6E6FA'], matchScore: 85 },
    ],
    blusher: [
      { category: 'rose', hex: '#F4C2C2', matchScore: 95 },
      { category: 'pink', hex: '#FFB6C1', matchScore: 92 },
    ],
    tips: [
      '부드럽고 뮤트된 컬러로 우아한 느낌',
      '실버 글리터가 잘 어울립니다',
      '오렌지/골드 계열은 피하세요',
    ],
  },

  autumn: {
    lip: [
      { category: 'brown', hex: '#8B4513', name: '테라코타', matchScore: 95 },
      { category: 'red', hex: '#CD5C5C', name: '브릭 레드', matchScore: 92 },
      { category: 'nude', hex: '#D2B48C', name: '카멜 누드', matchScore: 90 },
      { category: 'orange', hex: '#FF6347', name: '버번 오렌지', matchScore: 88 },
    ],
    eyeshadow: [
      { category: 'warm-brown', colors: ['#8B4513', '#D2691E', '#CD853F'], matchScore: 95 },
      { category: 'neutral-brown', colors: ['#A0522D', '#6B4423', '#8B7355'], matchScore: 90 },
      { category: 'glitter', colors: ['#DAA520', '#B8860B'], matchScore: 88 },
    ],
    blusher: [
      { category: 'bronzer', hex: '#C19A6B', matchScore: 95 },
      { category: 'peach', hex: '#FFDAB9', matchScore: 90 },
    ],
    tips: [
      '깊고 풍부한 어스 톤으로 따뜻한 느낌',
      '골드/브론즈 글리터 추천',
      '핑크/베리 계열은 피하세요',
    ],
  },

  winter: {
    lip: [
      { category: 'red', hex: '#DC143C', name: '트루 레드', matchScore: 95 },
      { category: 'berry', hex: '#8B0000', name: '와인 베리', matchScore: 92 },
      { category: 'pink', hex: '#FF1493', name: '푸시아 핑크', matchScore: 90 },
      { category: 'plum', hex: '#4B0082', name: '딥 플럼', matchScore: 88 },
    ],
    eyeshadow: [
      { category: 'smoky', colors: ['#2F4F4F', '#363636', '#4A4A4A'], matchScore: 95 },
      { category: 'cool-brown', colors: ['#696969', '#808080', '#A9A9A9'], matchScore: 90 },
      { category: 'colorful', colors: ['#4169E1', '#9370DB', '#20B2AA'], matchScore: 88 },
    ],
    blusher: [
      { category: 'burgundy', hex: '#722F37', matchScore: 95 },
      { category: 'rose', hex: '#C71585', matchScore: 92 },
    ],
    tips: [
      '선명하고 강렬한 컬러로 시크한 느낌',
      '스모키 메이크업이 잘 어울립니다',
      '누드/피치 계열은 피하세요',
    ],
  },
};
```

---

## 9. 참고 자료

### 9.1 학술 자료

1. **색채학**
   - CIE Lab Color Space (Commission Internationale de l'Eclairage)
   - Munsell Color System
   - 한국인 피부색 측정 연구 (Korean Journal of Dermatology)
   - Puzovic (2012) Korean Skin Color Study
   - Son (2013) East Asian Skin Pigmentation

2. **메이크업 컬러 이론**
   - Color Me Beautiful Official System
   - L'Oréal Paris Color Theory
   - NYX Seasonal Color Analysis
   - Pantone Color Institute

3. **얼굴 분석**
   - 68 Point Facial Landmark Detection (Dlib)
   - Face Shape Classification Algorithms
   - Contour and Highlight Placement Studies

### 9.2 산업 자료

1. **K-뷰티 트렌드**
   - 대한화장품협회 트렌드 리포트
   - 올리브영 뷰티 트렌드 2025
   - 아모레퍼시픽 뷰티 인사이트

2. **글로벌 트렌드**
   - Pantone Color of the Year 2025 (Mocha Mousse)
   - Vogue Beauty Trend Forecast
   - Allure Best of Beauty

### 9.3 관련 원리/스펙 문서

- [color-science.md](../../principles/color-science.md) - Lab 색공간, 웜/쿨톤 판정
- [hair-makeup-analysis.md](../../principles/hair-makeup-analysis.md) - M-1 기반 원리
- [SDD-MAKEUP-ANALYSIS.md](../../specs/SDD-MAKEUP-ANALYSIS.md) - M-1 구현 스펙
- [COMBO-3-R1-퍼스널컬러메이크업.md](./COMBO-3-R1-퍼스널컬러메이크업.md) - 퍼스널컬러×메이크업 조합

---

## 10. 다음 단계

### 10.1 P7 워크플로우 진행

```
✅ 리서치 완료 (이 문서)
   ↓
⏳ 원리 문서 보완 (hair-makeup-analysis.md 업데이트)
   ↓
⏳ ADR 작성 (ADR-053-makeup-analysis-architecture.md)
   ↓
⏳ 스펙 완성 (SDD-MAKEUP-ANALYSIS.md P3 점수 80+)
   ↓
⏳ 구현
```

### 10.2 구현 우선순위

1. **Phase 1**: 립 컬러 분석 (M-1.1) - 2시간
2. **Phase 2**: 아이섀도우 분석 (M-1.2) - 2시간
3. **Phase 3**: 블러셔 분석 (M-1.3) - 1시간
4. **Phase 4**: 시즌별 조화도 계산 (M-1.6) - 2시간
5. **Phase 5**: API 통합 (M-1.8) - 2시간

---

**Version**: 1.0 | **Created**: 2026-01-23
**Author**: Claude Code
**Status**: Complete
**Lines**: 1500+
