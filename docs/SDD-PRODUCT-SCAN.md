# SDD-PRODUCT-SCAN: ì œí’ˆ ìŠ¤ìº” ë§ì¶¤ ë¶„ì„

> **Version**: 1.0
> **Status**: Draft
> **Created**: 2026-01-11
> **Phase**: Phase F

---

## 1. ê°œìš” ë° ëª©ì 

### 1.1 ë°°ê²½

- ì‚¬ìš©ìê°€ ì´ë¯¸ ë³´ìœ í•œ ì œí’ˆì´ ìì‹ ì˜ í”¼ë¶€/í¼ìŠ¤ë„ ì»¬ëŸ¬ì— ë§ëŠ”ì§€ ì•Œê¸° ì–´ë ¤ì›€
- í™”ì¥í’ˆ ì„±ë¶„ ë¶„ì„ ì•±(í™”í•´)ì€ ì¼ë°˜ì ì¸ ì •ë³´ë§Œ ì œê³µ, **ê°œì¸í™” ë¶€ì¬**
- ì´ë£¸ì˜ ê¸°ì¡´ ë¶„ì„ ë°ì´í„°(S-1, PC-1, C-1)ë¥¼ í™œìš©í•œ ì°¨ë³„í™” ê¸°íšŒ

### 1.2 ëª©ì 

1. **ë°”ì½”ë“œ/ì„±ë¶„í‘œ ìŠ¤ìº”** â†’ ì œí’ˆ ì •ë³´ ì¸ì‹
2. **ì‚¬ìš©ì ë¶„ì„ ë°ì´í„° ì—°ë™** â†’ ë§ì¶¤ í˜¸í™˜ì„± ë¶„ì„
3. **ì„±ë¶„ ì£¼ì˜ì‚¬í•­/ì‹œë„ˆì§€ ì•ˆë‚´** â†’ ì•ˆì „í•œ ì‚¬ìš© ê°€ì´ë“œ
4. **ê¸€ë¡œë²Œ ì œí’ˆ ì§€ì›** â†’ ë‹¤êµ­ì–´ ì„±ë¶„ ì¸ì‹

### 1.3 í•µì‹¬ ê°€ì¹˜

```
"ë‚´ê°€ ê°€ì§„ ì œí’ˆ, ë‚˜í•œí…Œ ë§ì„ê¹Œ?"
â†’ ìŠ¤ìº” í•œ ë²ˆìœ¼ë¡œ ë‚˜ë§Œì˜ ë§ì¶¤ ë¶„ì„
```

---

## 2. ì‚¬ìš©ì í”Œë¡œìš°

### 2.1 ë©”ì¸ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì œí’ˆ ìŠ¤ìº” í”Œë¡œìš°                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  [1] ì§„ì…ì                                                   â”‚
â”‚      â”œâ”€â”€ í•˜ë‹¨ íƒ­ "ìŠ¤ìº”" ë²„íŠ¼                                 â”‚
â”‚      â”œâ”€â”€ ì œí’ˆ ìƒì„¸ í˜ì´ì§€ "ë‚´ ì œí’ˆ ìŠ¤ìº”"                      â”‚
â”‚      â””â”€â”€ í™ˆ í€µ ì•¡ì…˜ "ì œí’ˆ í™•ì¸"                              â”‚
â”‚                                                              â”‚
â”‚  [2] ìŠ¤ìº” ë°©ì‹ ì„ íƒ                                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚      â”‚  â”‚ ë°”ì½”ë“œ  â”‚    â”‚ ì„±ë¶„í‘œ  â”‚    â”‚  ê²€ìƒ‰   â”‚     â”‚    â”‚
â”‚      â”‚  â”‚  ìŠ¤ìº”   â”‚    â”‚  ì´¬ì˜   â”‚    â”‚        â”‚     â”‚    â”‚
â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  [3] ì œí’ˆ ì¸ì‹                                               â”‚
â”‚      â”œâ”€â”€ ë°”ì½”ë“œ â†’ DB ì¡°íšŒ â†’ ì œí’ˆ ì •ë³´                        â”‚
â”‚      â”œâ”€â”€ ì„±ë¶„í‘œ OCR â†’ Gemini ë¶„ì„ â†’ ì„±ë¶„ ëª©ë¡                â”‚
â”‚      â””â”€â”€ ê²€ìƒ‰ â†’ ì œí’ˆ DB ê²€ìƒ‰ â†’ ì„ íƒ                          â”‚
â”‚                                                              â”‚
â”‚  [4] ë§ì¶¤ ë¶„ì„ ê²°ê³¼                                          â”‚
â”‚      â”œâ”€â”€ í”¼ë¶€ í˜¸í™˜ì„± (S-1 ì—°ë™)                              â”‚
â”‚      â”œâ”€â”€ ì»¬ëŸ¬ ë§¤ì¹­ (PC-1 ì—°ë™, ìƒ‰ì¡°ë§Œ)                       â”‚
â”‚      â”œâ”€â”€ ì„±ë¶„ ì£¼ì˜ì‚¬í•­                                       â”‚
â”‚      â””â”€â”€ ì¶”ì²œ ì‚¬ìš©ë²•                                         â”‚
â”‚                                                              â”‚
â”‚  [5] í›„ì† ì•¡ì…˜                                               â”‚
â”‚      â”œâ”€â”€ "ë‚´ ì œí’ˆí•¨ì— ì¶”ê°€"                                  â”‚
â”‚      â”œâ”€â”€ "ë¹„ìŠ·í•œ ì œí’ˆ ì¶”ì²œ"                                  â”‚
â”‚      â””â”€â”€ "ê³µìœ í•˜ê¸°"                                          â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ì—ëŸ¬ í”Œë¡œìš°

| ìƒí™©             | ì²˜ë¦¬                                     |
| ---------------- | ---------------------------------------- |
| ë°”ì½”ë“œ ì¸ì‹ ì‹¤íŒ¨ | "ì„±ë¶„í‘œ ì´¬ì˜" ë˜ëŠ” "ì§ì ‘ ê²€ìƒ‰" ì•ˆë‚´      |
| ì œí’ˆ DBì— ì—†ìŒ   | ì„±ë¶„í‘œ ì´¬ì˜ìœ¼ë¡œ ì „í™˜, ì»¤ë®¤ë‹ˆí‹° ë“±ë¡ ìœ ë„ |
| ë¶„ì„ ë°ì´í„° ì—†ìŒ | "í”¼ë¶€ ë¶„ì„ ë¨¼ì € ì§„í–‰" CTA                |
| OCR ì‹¤íŒ¨         | ì¬ì´¬ì˜ ì•ˆë‚´, ìˆ˜ë™ ì…ë ¥ ì˜µì…˜              |

---

## 3. ë°”ì½”ë“œ/OCR ì¸ì‹ ë°©ë²•

### 3.1 ë°”ì½”ë“œ ì¸ì‹

#### ê¸°ìˆ  ì˜µì…˜ ë¹„êµ

| ë°©ë²•                     | ì¥ì             | ë‹¨ì           | ê¶Œì¥             |
| ------------------------ | --------------- | ------------- | ---------------- |
| **BarcodeDetector API**  | ë„¤ì´í‹°ë¸Œ, ë¹ ë¦„  | Safari ë¯¸ì§€ì› | âš ï¸ Fallback í•„ìš” |
| **zxing-js**             | í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì € | ë²ˆë“¤ í¬ê¸°     | âœ… ì›¹ ê¶Œì¥       |
| **expo-barcode-scanner** | RN ë„¤ì´í‹°ë¸Œ     | ì›¹ ë¯¸ì§€ì›     | âœ… ëª¨ë°”ì¼ ê¶Œì¥   |
| **Gemini Vision**        | OCR í†µí•©        | API ë¹„ìš©      | âš ï¸ Fallbackìš©    |

#### êµ¬í˜„ ì½”ë“œ

```typescript
// lib/scan/barcode.ts
import { BrowserMultiFormatReader } from '@zxing/library';

export async function scanBarcode(videoElement: HTMLVideoElement): Promise<string | null> {
  const codeReader = new BrowserMultiFormatReader();

  try {
    const result = await codeReader.decodeOnceFromVideoDevice(undefined, videoElement);
    return result.getText();
  } catch (error) {
    console.error('[Scan] Barcode recognition failed:', error);
    return null;
  }
}

// ë°”ì½”ë“œ íƒ€ì… ì§€ì›
// - EAN-13 (êµ­ì œ í‘œì¤€)
// - EAN-8
// - UPC-A (ë¯¸êµ­)
// - CODE-128
```

### 3.2 ì„±ë¶„í‘œ OCR

#### Gemini Vision í”„ë¡¬í”„íŠ¸

```typescript
// lib/scan/ingredient-ocr.ts
const INGREDIENT_OCR_PROMPT = `
ì´ í™”ì¥í’ˆ ì„±ë¶„í‘œ/ì „ì„±ë¶„ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.

ğŸ“‹ ì¶”ì¶œí•  ì •ë³´:
1. ì œí’ˆëª… (ìˆëŠ” ê²½ìš°)
2. ë¸Œëœë“œëª… (ìˆëŠ” ê²½ìš°)
3. ì „ì„±ë¶„ ëª©ë¡ (ìˆœì„œëŒ€ë¡œ)

âš ï¸ ì£¼ì˜ì‚¬í•­:
- ì„±ë¶„ëª…ì€ ê°€ëŠ¥í•œ INCI ëª…ì¹­ìœ¼ë¡œ ë³€í™˜
- í•œê¸€ ì„±ë¶„ëª…ë„ í•¨ê»˜ ì œê³µ
- ë†ë„/í•¨ëŸ‰ì´ í‘œê¸°ë˜ì–´ ìˆìœ¼ë©´ í¬í•¨
- ì½ê¸° ì–´ë ¤ìš´ ë¶€ë¶„ì€ "ë¶ˆëª…í™•"ìœ¼ë¡œ í‘œì‹œ

ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µ:
{
  "productName": "[ì œí’ˆëª… ë˜ëŠ” null]",
  "brandName": "[ë¸Œëœë“œëª… ë˜ëŠ” null]",
  "ingredients": [
    {
      "order": 1,
      "nameKo": "[í•œê¸€ëª…]",
      "nameInci": "[INCIëª…]",
      "concentration": "[ë†’ìŒ|ì¤‘ê°„|ë‚®ìŒ|ë¶ˆëª…]",
      "note": "[íŠ¹ì´ì‚¬í•­ ë˜ëŠ” null]"
    }
  ],
  "confidence": "[high|medium|low]",
  "language": "[ko|en|ja|zh|other]"
}
`;
```

### 3.3 ì œí’ˆ DB ì¡°íšŒ

```typescript
// lib/scan/product-lookup.ts
interface ProductLookupResult {
  found: boolean;
  source: 'internal_db' | 'open_beauty_facts' | 'ocr_analysis';
  product?: Product;
  confidence: number;
}

export async function lookupProduct(barcode: string): Promise<ProductLookupResult> {
  // 1. ë‚´ë¶€ DB ì¡°íšŒ
  const internalResult = await supabase
    .from('global_products')
    .select('*')
    .eq('barcode', barcode)
    .single();

  if (internalResult.data) {
    return {
      found: true,
      source: 'internal_db',
      product: internalResult.data,
      confidence: 1.0,
    };
  }

  // 2. Open Beauty Facts API (ë¬´ë£Œ ê¸€ë¡œë²Œ DB)
  const obfResult = await fetch(`https://world.openbeautyfacts.org/api/v0/product/${barcode}.json`);
  const obfData = await obfResult.json();

  if (obfData.status === 1) {
    return {
      found: true,
      source: 'open_beauty_facts',
      product: transformObfProduct(obfData.product),
      confidence: 0.9,
    };
  }

  // 3. ë¯¸ë°œê²¬
  return { found: false, source: 'ocr_analysis', confidence: 0 };
}
```

---

## 4. ì‚¬ìš©ì ë¶„ì„ ë°ì´í„° ì—°ë™

### 4.1 ì—°ë™ ë°ì´í„° ë§¤í•‘

| ë¶„ì„ ëª¨ë“ˆ           | ì—°ë™ ë°ì´í„°                     | í™œìš©           |
| ------------------- | ------------------------------- | -------------- |
| **S-1 í”¼ë¶€**        | skinType, concerns, sensitivity | ì„±ë¶„ í˜¸í™˜ì„±    |
| **PC-1 í¼ìŠ¤ë„ì»¬ëŸ¬** | seasonType, tone                | ìƒ‰ì¡° ì œí’ˆ ë§¤ì¹­ |
| **C-1 ì²´í˜•**        | -                               | í˜„ì¬ ë¯¸ì‚¬ìš©    |
| **N-1 ì˜ì–‘**        | allergies, restrictions         | ì„­ì·¨ ì œí’ˆ ì£¼ì˜ |

### 4.2 í˜¸í™˜ì„± ë¶„ì„ ë¡œì§

```typescript
// lib/scan/compatibility.ts
interface CompatibilityResult {
  overallScore: number; // 0-100
  skinCompatibility: {
    score: number;
    goodPoints: CompatibilityPoint[];
    warnings: CompatibilityPoint[];
  };
  colorMatch?: {
    isRecommended: boolean;
    matchScore: number;
    reason: string;
    alternatives?: string[];
  };
  ingredientAnalysis: {
    beneficial: IngredientNote[];
    caution: IngredientNote[];
    avoid: IngredientNote[];
    interactions: InteractionWarning[];
  };
}

interface CompatibilityPoint {
  title: string;
  description: string;
  basedOn: 'skin_type' | 'sensitivity' | 'concerns' | 'personal_color';
  confidence: 'high' | 'medium' | 'low';
}

export async function analyzeCompatibility(
  product: Product,
  userAnalysis: UserAnalysisData
): Promise<CompatibilityResult> {
  const { skinAnalysis, personalColor } = userAnalysis;

  // í”¼ë¶€ í˜¸í™˜ì„± ê³„ì‚°
  const skinCompat = calculateSkinCompatibility(product.ingredients, skinAnalysis);

  // ìƒ‰ì¡° ì œí’ˆì¸ ê²½ìš° ì»¬ëŸ¬ ë§¤ì¹­
  const colorMatch =
    product.category === 'makeup' ? calculateColorMatch(product, personalColor) : undefined;

  // ì„±ë¶„ ë¶„ì„
  const ingredientAnalysis = await analyzeIngredients(product.ingredients, skinAnalysis);

  // ì¢…í•© ì ìˆ˜
  const overallScore = calculateOverallScore(skinCompat, colorMatch, ingredientAnalysis);

  return {
    overallScore,
    skinCompatibility: skinCompat,
    colorMatch,
    ingredientAnalysis,
  };
}
```

### 4.3 í”¼ë¶€ íƒ€ì…ë³„ ì„±ë¶„ ë§¤ì¹­

```typescript
// lib/scan/skin-ingredient-match.ts
const SKIN_TYPE_INGREDIENTS: Record<SkinType, IngredientRecommendation> = {
  dry: {
    beneficial: ['Hyaluronic Acid', 'Ceramide', 'Squalane', 'Shea Butter'],
    caution: ['Alcohol Denat.', 'Salicylic Acid'],
    avoid: ['Benzoyl Peroxide (ê³ ë†ë„)'],
  },
  oily: {
    beneficial: ['Niacinamide', 'Salicylic Acid', 'Tea Tree', 'Zinc'],
    caution: ['Heavy Oils', 'Petroleum'],
    avoid: ['Coconut Oil', 'Isopropyl Myristate'],
  },
  sensitive: {
    beneficial: ['Centella Asiatica', 'Allantoin', 'Panthenol', 'Aloe Vera'],
    caution: ['Fragrance', 'Essential Oils', 'AHA/BHA'],
    avoid: ['Alcohol', 'Sulfates', 'Parabens'],
  },
  combination: {
    beneficial: ['Niacinamide', 'Hyaluronic Acid', 'Green Tea'],
    caution: ['Heavy Creams'],
    avoid: [],
  },
  normal: {
    beneficial: ['Vitamin C', 'Peptides', 'Antioxidants'],
    caution: [],
    avoid: [],
  },
};
```

### 4.4 ì„±ë¶„ ìƒí˜¸ì‘ìš© ê²½ê³ 

```typescript
// lib/scan/ingredient-interactions.ts
const INGREDIENT_INTERACTIONS: InteractionRule[] = [
  {
    ingredient1: 'Retinol',
    ingredient2: 'AHA',
    type: 'avoid_together',
    reason: 'í•¨ê»˜ ì‚¬ìš© ì‹œ í”¼ë¶€ ìê·¹ ê°€ëŠ¥',
    recommendation: 'ì•„ì¹¨/ì €ë… ë¶„ë¦¬ ì‚¬ìš©',
  },
  {
    ingredient1: 'Retinol',
    ingredient2: 'BHA',
    type: 'avoid_together',
    reason: 'ê³¼ë„í•œ ê°ì§ˆ ì œê±°ë¡œ ìê·¹ ìœ ë°œ',
    recommendation: 'ê²©ì¼ ì‚¬ìš© ê¶Œì¥',
  },
  {
    ingredient1: 'Vitamin C',
    ingredient2: 'Niacinamide',
    type: 'synergy',
    reason: 'ë¯¸ë°± íš¨ê³¼ ì‹œë„ˆì§€ (ê³¼ê±° ìš°ë ¤ì™€ ë‹¬ë¦¬ ì•ˆì „)',
    recommendation: 'í•¨ê»˜ ì‚¬ìš© ê°€ëŠ¥',
  },
  {
    ingredient1: 'Vitamin C',
    ingredient2: 'AHA/BHA',
    type: 'caution',
    reason: 'pH ì°¨ì´ë¡œ íš¨ê³¼ ê°ì†Œ ê°€ëŠ¥',
    recommendation: 'ì‹œê°„ì°¨ ì ìš© (20ë¶„ ì´ìƒ)',
  },
  {
    ingredient1: 'Benzoyl Peroxide',
    ingredient2: 'Retinol',
    type: 'avoid_together',
    reason: 'ë²¤ì¡°ì¼í¼ì˜¥ì‚¬ì´ë“œê°€ ë ˆí‹°ë†€ ë¹„í™œì„±í™”',
    recommendation: 'ì•„ì¹¨ BP, ì €ë… ë ˆí‹°ë†€',
  },
];
```

---

## 5. ì„±ë¶„ DB êµ¬ì¡°

### 5.1 í…Œì´ë¸” ì„¤ê³„

```sql
-- ì „ì—­ ì œí’ˆ í…Œì´ë¸”
CREATE TABLE global_products (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  barcode VARCHAR(20) UNIQUE,
  name VARCHAR(255) NOT NULL,
  name_en VARCHAR(255),
  brand VARCHAR(100),
  category product_category NOT NULL,
  subcategory VARCHAR(50),

  -- ì„±ë¶„ ì •ë³´
  ingredients JSONB NOT NULL DEFAULT '[]',
  key_ingredients TEXT[], -- ì£¼ìš” ì„±ë¶„ (ê²€ìƒ‰ìš©)

  -- ì§€ì—­ ì •ë³´
  origin_country VARCHAR(2), -- ISO 3166-1
  available_regions TEXT[] DEFAULT '{}',

  -- ë©”íƒ€ë°ì´í„°
  image_url TEXT,
  volume VARCHAR(20),
  price_range price_range_enum,

  -- ë“±ê¸‰/í‰ì 
  ewg_grade SMALLINT CHECK (ewg_grade BETWEEN 1 AND 10),
  cosdna_acne_score SMALLINT,
  cosdna_irritant_score SMALLINT,
  user_rating DECIMAL(2,1),
  review_count INTEGER DEFAULT 0,

  -- ì¶”ì 
  data_source VARCHAR(50), -- 'manual', 'open_beauty_facts', 'user_submitted'
  verified BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);

-- ì„±ë¶„ ë§ˆìŠ¤í„° í…Œì´ë¸”
CREATE TABLE ingredients_master (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  inci_name VARCHAR(255) UNIQUE NOT NULL,
  name_ko VARCHAR(255),
  name_en VARCHAR(255),
  name_ja VARCHAR(255),
  name_zh VARCHAR(255),

  -- ë¶„ë¥˜
  category ingredient_category,
  functions TEXT[], -- 'moisturizing', 'exfoliating', 'antioxidant', etc.

  -- ì•ˆì „ì„±
  ewg_grade SMALLINT,
  ewg_data_availability VARCHAR(20), -- 'good', 'fair', 'limited', 'none'

  -- í”¼ë¶€ íƒ€ì…ë³„ ê¶Œì¥
  recommended_for_skin_types TEXT[],
  caution_for_skin_types TEXT[],
  avoid_for_skin_types TEXT[],

  -- ìƒí˜¸ì‘ìš©
  synergy_with TEXT[], -- INCI names
  avoid_with TEXT[], -- INCI names

  -- ì„¤ëª…
  description_ko TEXT,
  benefits_ko TEXT[],
  side_effects_ko TEXT[],

  created_at TIMESTAMPTZ DEFAULT now()
);

-- ì‚¬ìš©ì ì œí’ˆí•¨ (ìŠ¤ìº” íˆìŠ¤í† ë¦¬)
CREATE TABLE user_product_shelf (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  clerk_user_id TEXT NOT NULL,
  product_id UUID REFERENCES global_products(id),

  -- ìŠ¤ìº” ì •ë³´
  scanned_at TIMESTAMPTZ DEFAULT now(),
  scan_method VARCHAR(20), -- 'barcode', 'ocr', 'search'

  -- ë¶„ì„ ê²°ê³¼ ìºì‹œ
  compatibility_score INTEGER,
  analysis_result JSONB,

  -- ì‚¬ìš©ì ë©”ëª¨
  status VARCHAR(20) DEFAULT 'owned', -- 'owned', 'wishlist', 'used_up'
  user_note TEXT,
  rating SMALLINT,

  created_at TIMESTAMPTZ DEFAULT now()
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_global_products_barcode ON global_products(barcode);
CREATE INDEX idx_global_products_brand ON global_products(brand);
CREATE INDEX idx_global_products_category ON global_products(category);
CREATE INDEX idx_global_products_key_ingredients ON global_products USING GIN(key_ingredients);
CREATE INDEX idx_global_products_available_regions ON global_products USING GIN(available_regions);
CREATE INDEX idx_ingredients_master_inci ON ingredients_master(inci_name);
CREATE INDEX idx_user_product_shelf_user ON user_product_shelf(clerk_user_id);
```

### 5.2 ì„±ë¶„ JSON êµ¬ì¡°

```typescript
// ì œí’ˆ ì„±ë¶„ JSONB êµ¬ì¡°
interface ProductIngredient {
  order: number;
  inciName: string;
  nameKo?: string;
  concentration?: 'high' | 'medium' | 'low';
  purpose?: string[];
  ewgGrade?: number;
}

// ì˜ˆì‹œ
const productIngredients: ProductIngredient[] = [
  {
    order: 1,
    inciName: 'Water',
    nameKo: 'ì •ì œìˆ˜',
    concentration: 'high',
    purpose: ['solvent'],
  },
  {
    order: 2,
    inciName: 'Niacinamide',
    nameKo: 'ë‚˜ì´ì•„ì‹ ì•„ë§ˆì´ë“œ',
    concentration: 'medium',
    purpose: ['brightening', 'pore_care'],
    ewgGrade: 1,
  },
];
```

---

## 6. UI/UX ì„¤ê³„

### 6.1 í™”ë©´ êµ¬ì„±

#### 6.1.1 ìŠ¤ìº” í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  ì œí’ˆ ìŠ¤ìº”                    [?] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚      [ì¹´ë©”ë¼ ë·°íŒŒì¸ë”]         â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚     â”‚  ë°”ì½”ë“œ ì˜ì—­     â”‚      â”‚  â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  ë°”ì½”ë“œë¥¼ ì‚¬ê°í˜• ì•ˆì— ë§ì¶°ì£¼ì„¸ìš”      â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ì„±ë¶„í‘œ   â”‚  â”‚  ê²€ìƒ‰    â”‚         â”‚
â”‚  â”‚  ì´¬ì˜    â”‚  â”‚         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  ìµœê·¼ ìŠ¤ìº”                           â”‚
â”‚  [ì œí’ˆ1] [ì œí’ˆ2] [ì œí’ˆ3] â†’           â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 6.1.2 ê²°ê³¼ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  ë¶„ì„ ê²°ê³¼                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [ì œí’ˆ ì´ë¯¸ì§€]                 â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚  ì½”ìŠ¤ì•Œì—‘ìŠ¤ AHA/BHA í† ë„ˆ       â”‚  â”‚
â”‚  â”‚  COSRX                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¯ ê¹€ì´ë£¸ë‹˜ ë§ì¶¤ ì ìˆ˜          â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  82ì           â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚  ì§€ì„± í”¼ë¶€ì— ì í•©í•œ ì œí’ˆì´ì—ìš”  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  âœ… ì¢‹ì€ ì                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ BHA í•¨ìœ  - ëª¨ê³µ ì¼€ì–´ì— íš¨ê³¼ì  â”‚  â”‚
â”‚  â”‚   (S-1 ë¶„ì„: ëª¨ê³µ ì ìˆ˜ 45ì )   â”‚  â”‚
â”‚  â”‚ â€¢ ë‚˜ì´ì•„ì‹ ì•„ë§ˆì´ë“œ - í”¼ì§€ ì¡°ì ˆ  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  âš ï¸ ì£¼ì˜í•  ì                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ ë¯¼ê° í”¼ë¶€ - íŒ¨ì¹˜ í…ŒìŠ¤íŠ¸ ê¶Œì¥  â”‚  â”‚
â”‚  â”‚ â€¢ ë ˆí‹°ë†€ê³¼ í•¨ê»˜ ì‚¬ìš© ê¸ˆì§€      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  ğŸ“Š EWG ë“±ê¸‰: 2 (ë‚®ì€ ìœ„í—˜)          â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [ë‚´ ì œí’ˆí•¨ ì¶”ê°€]  [ê³µìœ í•˜ê¸°]  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
components/scan/
â”œâ”€â”€ ScanCamera.tsx           # ì¹´ë©”ë¼ ë·° + ë°”ì½”ë“œ ì¸ì‹
â”œâ”€â”€ IngredientCapture.tsx    # ì„±ë¶„í‘œ ì´¬ì˜ ëª¨ë“œ
â”œâ”€â”€ ProductSearchModal.tsx   # ì œí’ˆ ê²€ìƒ‰ ëª¨ë‹¬
â”œâ”€â”€ ScanResult/
â”‚   â”œâ”€â”€ ProductHeader.tsx    # ì œí’ˆ ì´ë¯¸ì§€ + ê¸°ë³¸ ì •ë³´
â”‚   â”œâ”€â”€ CompatibilityScore.tsx # ë§ì¶¤ ì ìˆ˜
â”‚   â”œâ”€â”€ GoodPoints.tsx       # ì¢‹ì€ ì  ëª©ë¡
â”‚   â”œâ”€â”€ Warnings.tsx         # ì£¼ì˜ì‚¬í•­ ëª©ë¡
â”‚   â”œâ”€â”€ IngredientList.tsx   # ì „ì„±ë¶„ ë¶„ì„
â”‚   â””â”€â”€ ActionButtons.tsx    # ì œí’ˆí•¨ ì¶”ê°€, ê³µìœ 
â”œâ”€â”€ RecentScans.tsx          # ìµœê·¼ ìŠ¤ìº” íˆìŠ¤í† ë¦¬
â””â”€â”€ ProductShelf/
    â”œâ”€â”€ ShelfList.tsx        # ë‚´ ì œí’ˆí•¨ ëª©ë¡
    â”œâ”€â”€ ShelfItem.tsx        # ê°œë³„ ì œí’ˆ ì¹´ë“œ
    â””â”€â”€ ShelfFilters.tsx     # í•„í„° (ì¹´í…Œê³ ë¦¬, ì ìˆ˜)
```

### 6.3 ì ‘ê·¼ì„±

```typescript
// ì ‘ê·¼ì„± ìš”êµ¬ì‚¬í•­
const a11yRequirements = {
  camera: {
    // ì¹´ë©”ë¼ ê¶Œí•œ ìš”ì²­ ì‹œ ëª…í™•í•œ ì•ˆë‚´
    permissionPrompt: 'ë°”ì½”ë“œ ìŠ¤ìº”ì„ ìœ„í•´ ì¹´ë©”ë¼ ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤',
    // ì‹œê° ì¥ì• ì¸ì„ ìœ„í•œ ìŒì„± í”¼ë“œë°±
    voiceOver: {
      scanning: 'ë°”ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ê³  ìˆìŠµë‹ˆë‹¤',
      success: 'ì œí’ˆì„ ì¸ì‹í–ˆìŠµë‹ˆë‹¤. {productName}',
      failed: 'ë°”ì½”ë“œë¥¼ ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”',
    },
  },
  results: {
    // ìŠ¤í¬ë¦° ë¦¬ë”ìš© êµ¬ì¡°í™”
    landmarks: ['ì œí’ˆ ì •ë³´', 'ë§ì¶¤ ì ìˆ˜', 'ì¢‹ì€ ì ', 'ì£¼ì˜ì‚¬í•­'],
    // ì ìˆ˜ ìŒì„± ì•ˆë‚´
    scoreAnnouncement: 'ë§ì¶¤ ì ìˆ˜ {score}ì . {summary}',
  },
};
```

---

## 7. ê¸€ë¡œë²Œ ì œí’ˆ DB ì „ëµ

### 7.1 ë°ì´í„° ì†ŒìŠ¤

| ì†ŒìŠ¤                  | ìš©ë„             | ë¹„ìš©      | ì»¤ë²„ë¦¬ì§€   |
| --------------------- | ---------------- | --------- | ---------- |
| **Open Beauty Facts** | ê¸€ë¡œë²Œ í™”ì¥í’ˆ DB | ë¬´ë£Œ      | 100K+ ì œí’ˆ |
| **Open Food Facts**   | ê±´ê°•ì‹í’ˆ/ë³´ì¶©ì œ  | ë¬´ë£Œ      | 2M+ ì œí’ˆ   |
| **ìì²´ DB**           | í•œêµ­ ì œí’ˆ ìš°ì„    | ìˆ˜ë™ ì…ë ¥ | ì§€ì† í™•ëŒ€  |
| **ì‚¬ìš©ì ê¸°ì—¬**       | ë¯¸ë“±ë¡ ì œí’ˆ      | ë¬´ë£Œ      | ì»¤ë®¤ë‹ˆí‹°   |

### 7.2 ì§€ì—­ë³„ ìš°ì„ ìˆœìœ„

```
Phase 1 (í•œêµ­ ì§‘ì¤‘)
â”œâ”€â”€ ì˜¬ë¦¬ë¸Œì˜ ì¸ê¸° ì œí’ˆ 1,000ê°œ
â”œâ”€â”€ ì¿ íŒ¡ ë·°í‹° ë² ìŠ¤íŠ¸ 500ê°œ
â””â”€â”€ iHerb í•œêµ­ ì¸ê¸° 200ê°œ

Phase 2 (ì•„ì‹œì•„ í™•ì¥)
â”œâ”€â”€ ì¼ë³¸: @cosme ë­í‚¹ 500ê°œ
â”œâ”€â”€ ì¤‘êµ­: å°çº¢ä¹¦ ì¸ê¸° 300ê°œ
â””â”€â”€ ë™ë‚¨ì•„: ì™“ìŠ¨ìŠ¤ ì¸ê¸° 200ê°œ

Phase 3 (ê¸€ë¡œë²Œ)
â”œâ”€â”€ ë¯¸êµ­: Sephora, Ulta ì¸ê¸°
â”œâ”€â”€ EU: ë“œëŸ¬ê·¸ìŠ¤í† ì–´ ì¸ê¸°
â””â”€â”€ Open Beauty Facts ì—°ë™
```

### 7.3 ì œí’ˆ ë°ì´í„° ê°±ì‹ 

```typescript
// lib/scan/product-sync.ts
export async function syncProductFromOpenBeautyFacts(barcode: string) {
  const response = await fetch(`https://world.openbeautyfacts.org/api/v0/product/${barcode}.json`);
  const data = await response.json();

  if (data.status !== 1) return null;

  const product = data.product;

  return {
    barcode,
    name: product.product_name || product.product_name_ko,
    brand: product.brands,
    ingredients: parseIngredientsList(product.ingredients_text),
    imageUrl: product.image_url,
    category: mapCategory(product.categories_tags),
    originCountry: product.countries_tags?.[0],
    dataSource: 'open_beauty_facts',
  };
}
```

---

## 8. ê¸°ìˆ  ìŠ¤íƒ

### 8.1 í”„ë¡ íŠ¸ì—”ë“œ

| ì˜ì—­        | ê¸°ìˆ                        | ì´ìœ             |
| ----------- | -------------------------- | --------------- |
| ë°”ì½”ë“œ ìŠ¤ìº” | zxing-js + BarcodeDetector | í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì € |
| ì¹´ë©”ë¼      | react-webcam               | ì•ˆì •ì           |
| OCR         | Gemini Vision API          | ë‹¤êµ­ì–´ ì§€ì›     |
| ì´ë¯¸ì§€ ì²˜ë¦¬ | sharp (ì„œë²„)               | ìµœì í™”          |

### 8.2 ë°±ì—”ë“œ

| ì˜ì—­     | ê¸°ìˆ                    | ì´ìœ       |
| -------- | ---------------------- | --------- |
| API      | Next.js API Routes     | ê¸°ì¡´ ìŠ¤íƒ |
| DB       | Supabase PostgreSQL    | ê¸°ì¡´ ìŠ¤íƒ |
| ì™¸ë¶€ API | Open Beauty Facts      | ë¬´ë£Œ      |
| ìºì‹±     | Supabase + React Query | ì„±ëŠ¥      |

### 8.3 ëª¨ë°”ì¼ (Expo)

| ì˜ì—­   | ê¸°ìˆ                  |
| ------ | -------------------- |
| ë°”ì½”ë“œ | expo-barcode-scanner |
| ì¹´ë©”ë¼ | expo-camera          |
| ì´ë¯¸ì§€ | expo-image-picker    |

---

## 9. API ì„¤ê³„

### 9.1 ì—”ë“œí¬ì¸íŠ¸

```typescript
// POST /api/scan/barcode
// ë°”ì½”ë“œë¡œ ì œí’ˆ ì¡°íšŒ
interface BarcodeRequest {
  barcode: string;
}

// POST /api/scan/ocr
// ì„±ë¶„í‘œ ì´ë¯¸ì§€ OCR
interface OcrRequest {
  imageBase64: string;
}

// POST /api/scan/analyze
// ì œí’ˆ-ì‚¬ìš©ì í˜¸í™˜ì„± ë¶„ì„
interface AnalyzeRequest {
  productId?: string;
  ingredients?: ProductIngredient[];
}

// GET /api/scan/history
// ìŠ¤ìº” íˆìŠ¤í† ë¦¬ ì¡°íšŒ

// POST /api/scan/shelf
// ë‚´ ì œí’ˆí•¨ì— ì¶”ê°€
interface AddToShelfRequest {
  productId: string;
  status: 'owned' | 'wishlist';
  note?: string;
}
```

### 9.2 ì‘ë‹µ êµ¬ì¡°

```typescript
interface ScanAnalysisResponse {
  success: boolean;
  product: {
    id: string;
    name: string;
    brand: string;
    imageUrl?: string;
    ingredients: ProductIngredient[];
    ewgGrade?: number;
  };
  compatibility: CompatibilityResult;
  userAnalysisUsed: {
    skinAnalysis: boolean;
    personalColor: boolean;
  };
}
```

---

## 10. í…ŒìŠ¤íŠ¸ ê³„íš

### 10.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

| ì˜ì—­        | í…ŒìŠ¤íŠ¸ í•­ëª©             |
| ----------- | ----------------------- |
| ë°”ì½”ë“œ íŒŒì‹± | EAN-13, UPC-A í˜•ì‹ ê²€ì¦ |
| ì„±ë¶„ ë§¤ì¹­   | í”¼ë¶€ íƒ€ì…ë³„ í˜¸í™˜ì„± ê³„ì‚° |
| ìƒí˜¸ì‘ìš©    | ì„±ë¶„ ì¡°í•© ê²½ê³  ê°ì§€     |
| OCR íŒŒì‹±    | Gemini ì‘ë‹µ JSON íŒŒì‹±   |

### 10.2 í†µí•© í…ŒìŠ¤íŠ¸

| ì‹œë‚˜ë¦¬ì˜¤              | ì˜ˆìƒ ê²°ê³¼           |
| --------------------- | ------------------- |
| í•œêµ­ ì œí’ˆ ìŠ¤ìº”        | DB ì¡°íšŒ â†’ ë¶„ì„ ê²°ê³¼ |
| ë¯¸ë“±ë¡ ì œí’ˆ           | OCR ì „í™˜ ì•ˆë‚´       |
| ë¶„ì„ ë°ì´í„° ì—†ìŒ      | ë¶„ì„ ë¨¼ì € CTA       |
| ë¯¼ê° í”¼ë¶€ + ìê·¹ ì„±ë¶„ | ê²½ê³  í‘œì‹œ           |

### 10.3 E2E í…ŒìŠ¤íŠ¸

```typescript
// tests/e2e/scan.spec.ts
test('ë°”ì½”ë“œ ìŠ¤ìº” í›„ ë§ì¶¤ ë¶„ì„ ê²°ê³¼ í‘œì‹œ', async ({ page }) => {
  // 1. ìŠ¤ìº” í˜ì´ì§€ ì´ë™
  await page.goto('/scan');

  // 2. ë°”ì½”ë“œ ì…ë ¥ (í…ŒìŠ¤íŠ¸ìš©)
  await page.fill('[data-testid="barcode-input"]', '8809598453234');
  await page.click('[data-testid="scan-submit"]');

  // 3. ê²°ê³¼ í™•ì¸
  await expect(page.locator('[data-testid="product-name"]')).toBeVisible();
  await expect(page.locator('[data-testid="compatibility-score"]')).toBeVisible();
});
```

---

## 11. êµ¬í˜„ ê³„íš

### 11.1 Phase êµ¬ë¶„

| Phase   | ë²”ìœ„                  | ì˜ˆìƒ íŒŒì¼ ìˆ˜ |
| ------- | --------------------- | ------------ |
| **F-1** | ë°”ì½”ë“œ ìŠ¤ìº” + DB ì¡°íšŒ | 8-10         |
| **F-2** | ì„±ë¶„ OCR + ë¶„ì„       | 6-8          |
| **F-3** | ì‚¬ìš©ì ì—°ë™ ë¶„ì„      | 8-10         |
| **F-4** | ë‚´ ì œí’ˆí•¨ + íˆìŠ¤í† ë¦¬  | 6-8          |
| **F-5** | ê¸€ë¡œë²Œ DB í™•ì¥        | 4-6          |

### 11.2 ì‹œì§€í‘¸ìŠ¤ ì ìš© ë¶„ì„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ë³µì¡ë„ ë¶„ì„ (ì „ì²´ Phase F)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  íŒŒì¼ ì˜í–¥ë„: 30+ íŒŒì¼               â†’ 25ì                   â”‚
â”‚  ì•„í‚¤í…ì²˜: ìƒˆ ëª¨ë“ˆ + DB ìŠ¤í‚¤ë§ˆ       â†’ 20ì                   â”‚
â”‚  ì™¸ë¶€ ì—°ë™: Gemini + Open Beauty Facts â†’ 15ì                 â”‚
â”‚  ê¸°ì¡´ ì—°ë™: S-1, PC-1 ë°ì´í„°         â†’ 10ì                   â”‚
â”‚  í…ŒìŠ¤íŠ¸: ë‹¨ìœ„ + í†µí•© + E2E           â†’ 10ì                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  ì´ì : 80ì  â†’ Full íŠ¸ë™                                     â”‚
â”‚                                                              â”‚
â”‚  âœ… /sisyphus ì‚¬ìš© ê¶Œì¥                                      â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.3 ë³‘ë ¬ ì‘ì—… ê°€ëŠ¥ ì—¬ë¶€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë³‘ë ¬ ì‘ì—… ê³„íš                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ê·¸ë£¹ A (ë…ë¦½ ì‘ì—…) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚
â”‚  â”‚                                                           â”‚
â”‚  â”œâ”€â”€ [A1] DB ë§ˆì´ê·¸ë ˆì´ì…˜ (global_products, ingredients)     â”‚
â”‚  â”œâ”€â”€ [A2] íƒ€ì… ì •ì˜ (types/scan.ts)                          â”‚
â”‚  â””â”€â”€ [A3] Mock ë°ì´í„° (lib/mock/scan-products.ts)            â”‚
â”‚                                                              â”‚
â”‚  ê·¸ë£¹ B (A ì™„ë£Œ í›„) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚
â”‚  â”‚                                                           â”‚
â”‚  â”œâ”€â”€ [B1] ë°”ì½”ë“œ ìŠ¤ìº” ìœ í‹¸ (lib/scan/barcode.ts)             â”‚
â”‚  â”‚         â†“                                                 â”‚
â”‚  â”œâ”€â”€ [B2] ì œí’ˆ ì¡°íšŒ API (api/scan/barcode/route.ts)          â”‚
â”‚  â”‚                                                           â”‚
â”‚  â””â”€â”€ [B3] OCR ìœ í‹¸ (lib/scan/ingredient-ocr.ts) â† ë³‘ë ¬ ê°€ëŠ¥  â”‚
â”‚           â†“                                                  â”‚
â”‚       [B4] OCR API (api/scan/ocr/route.ts)                   â”‚
â”‚                                                              â”‚
â”‚  ê·¸ë£¹ C (A ì™„ë£Œ í›„, Bì™€ ë³‘ë ¬) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚  â”‚                                                           â”‚
â”‚  â”œâ”€â”€ [C1] í˜¸í™˜ì„± ë¶„ì„ ë¡œì§ (lib/scan/compatibility.ts)       â”‚
â”‚  â”œâ”€â”€ [C2] ì„±ë¶„ ìƒí˜¸ì‘ìš© (lib/scan/interactions.ts)           â”‚
â”‚  â””â”€â”€ [C3] ë¶„ì„ API (api/scan/analyze/route.ts)               â”‚
â”‚                                                              â”‚
â”‚  ê·¸ë£¹ D (B, C ì™„ë£Œ í›„) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚
â”‚  â”‚                                                           â”‚
â”‚  â”œâ”€â”€ [D1] ScanCamera ì»´í¬ë„ŒíŠ¸                                â”‚
â”‚  â”œâ”€â”€ [D2] ScanResult ì»´í¬ë„ŒíŠ¸ ê·¸ë£¹                           â”‚
â”‚  â””â”€â”€ [D3] í˜ì´ì§€ í†µí•© (app/(main)/scan/page.tsx)             â”‚
â”‚                                                              â”‚
â”‚  ê·¸ë£¹ E (D ì™„ë£Œ í›„) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚
â”‚  â”‚                                                           â”‚
â”‚  â”œâ”€â”€ [E1] ì œí’ˆí•¨ ê¸°ëŠ¥                                        â”‚
â”‚  â”œâ”€â”€ [E2] íˆìŠ¤í† ë¦¬ ê¸°ëŠ¥                                      â”‚
â”‚  â””â”€â”€ [E3] í…ŒìŠ¤íŠ¸ ì‘ì„±                                        â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë³‘ë ¬ ê°€ëŠ¥ ì¡°í•©:
- A1 + A2 + A3 (ëª¨ë‘ ë³‘ë ¬)
- B1 || B3 (ë°”ì½”ë“œì™€ OCR ë³‘ë ¬)
- B2 || C1 + C2 (APIì™€ ë¡œì§ ë³‘ë ¬)
- D1 + D2 (ì»´í¬ë„ŒíŠ¸ ë³‘ë ¬)
- E1 + E2 + E3 (ëª¨ë‘ ë³‘ë ¬)
```

---

## 12. ìœ„í—˜ ìš”ì†Œ ë° ëŒ€ì‘

| ìœ„í—˜                          | ì˜í–¥             | ëŒ€ì‘                                |
| ----------------------------- | ---------------- | ----------------------------------- |
| OCR ì •í™•ë„ ë‚®ìŒ               | ì˜ëª»ëœ ì„±ë¶„ ë¶„ì„ | Gemini í”„ë¡¬í”„íŠ¸ íŠœë‹ + ìˆ˜ë™ ë³´ì • UI |
| Open Beauty Facts ë°ì´í„° ë¶€ì¡± | í•œêµ­ ì œí’ˆ ë¯¸ì§€ì› | ìì²´ DB ìš°ì„  + ì‚¬ìš©ì ê¸°ì—¬          |
| ë°”ì½”ë“œ ì¸ì‹ ì‹¤íŒ¨              | UX ì €í•˜          | ë‹¤ì¤‘ ì¸ì‹ ë°©ë²• ì œê³µ                 |
| API ë¹„ìš©                      | ì˜ˆì‚° ì´ˆê³¼        | OCR ìºì‹± + ìš”ì²­ ì œí•œ                |

---

## 13. ì„±ê³µ ì§€í‘œ

| ì§€í‘œ             | ëª©í‘œ | ì¸¡ì •             |
| ---------------- | ---- | ---------------- |
| ë°”ì½”ë“œ ì¸ì‹ë¥     | 95%+ | ì„±ê³µ/ì‹œë„        |
| OCR ì •í™•ë„       | 85%+ | ì‚¬ìš©ì í”¼ë“œë°±    |
| ë¶„ì„ ì™„ë£Œìœ¨      | 80%+ | ìŠ¤ìº” â†’ ê²°ê³¼ ë„ë‹¬ |
| ì œí’ˆí•¨ ì¶”ê°€ìœ¨    | 30%+ | ê²°ê³¼ â†’ ì¶”ê°€      |
| DAU ì¤‘ ìŠ¤ìº” ì‚¬ìš© | 20%+ | ì‚¬ìš©ì ë¹„ìœ¨      |

---

**Version History**

| ë²„ì „ | ë‚ ì§œ       | ë³€ê²½ ë‚´ìš© |
| ---- | ---------- | --------- |
| 1.0  | 2026-01-11 | ì´ˆì•ˆ ì‘ì„± |
