# SDD-W-2: ê³ ê¸‰ ìŠ¤íŠ¸ë ˆì¹­ ëª¨ë“ˆ

> **Phase 3**: ìì„¸êµì • + ìŠ¤í¬ì¸ ë³„ ìŠ¤íŠ¸ë ˆì¹­ í†µí•© ëª¨ë“ˆ
> **Version**: 1.5 | **Created**: 2026-01-21 | **Updated**: 2026-01-24

---

## 0. ê¶ê·¹ì˜ í˜•íƒœ (P1)

### ì´ìƒì  ìµœì¢… ìƒíƒœ

"ìš´ë™ì²˜ë°©ì‚¬ ìˆ˜ì¤€ì˜ ê°œì¸í™” ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ"

- **ìì„¸ ë¶ˆê· í˜• ê°ì§€**: Janda 5ê°œ ìœ í˜• + ë³µí•© íŒ¨í„´ 100% ì •í™•ë„
- **ìŠ¤íŠ¸ë ˆì¹­ DB**: 200+ ìŠ¤íŠ¸ë ˆì¹­ ë™ì‘ (ì˜ìƒ + 3D ì• ë‹ˆë©”ì´ì…˜)
- **ìŠ¤í¬ì¸ ë³„ í”„ë¡œí† ì½œ**: 20ê°œ ìŠ¤í¬ì¸  ì›Œë°ì—…/ì¿¨ë‹¤ìš´ ì™„ë¹„
- **PNF ê°€ì´ë“œ**: ì‹¤ì‹œê°„ ìŒì„±/ì§„ë™ íƒ€ì´ë° ì½”ì¹­
- **ROM ì¸¡ì •**: ì¹´ë©”ë¼ ê¸°ë°˜ ìë™ ê°€ë™ë²”ìœ„ ì¸¡ì • ë° ì¶”ì 
- **C-2 ì™„ì „ ì—°ë™**: ëª¨ë“  ìì„¸ ë°ì´í„° ì‹¤ì‹œê°„ ë°˜ì˜

### ë¬¼ë¦¬ì  í•œê³„

| í•œê³„ | ì„¤ëª… |
|------|------|
| ì½˜í…ì¸  ì œì‘ | 200+ ìŠ¤íŠ¸ë ˆì¹­ ì˜ìƒ/ì• ë‹ˆë©”ì´ì…˜ ì œì‘ ë¹„ìš© |
| ì¹´ë©”ë¼ ROM | ìŠ¤ë§ˆíŠ¸í° ì¹´ë©”ë¼ë¡œ ì •ë°€ ê°ë„ ì¸¡ì • í•œê³„ |
| ë¦¬ì„œì¹˜ ë²”ìœ„ | 20ê°œ ìŠ¤í¬ì¸ ë³„ ê³¼í•™ì  í”„ë¡œí† ì½œ ê²€ì¦ í•„ìš” |
| UI ë³µì¡ë„ | PNF ì‹¤ì‹œê°„ ì½”ì¹­ UX êµ¬í˜„ ë‚œì´ë„ |

### 100ì  ê¸°ì¤€

| í•­ëª© | 100ì  ê¸°ì¤€ | í˜„ì¬ | ë‹¬ì„±ë¥  |
|------|-----------|------|--------|
| ìì„¸ ë¶ˆê· í˜• ê°ì§€ | 100% | 85% | 85% |
| ìŠ¤íŠ¸ë ˆì¹­ DB | 200ê°œ | 60ê°œ | 30% |
| ìŠ¤í¬ì¸  í”„ë¡œí† ì½œ | 20ê°œ | 6ê°œ | 30% |
| PNF ê°€ì´ë“œ | ì‹¤ì‹œê°„ ì½”ì¹­ | ê³ ì • íƒ€ì´ë¨¸ | 50% |
| ROM ì¸¡ì • | ì¹´ë©”ë¼ ìë™ | ìê°€ ë³´ê³  | 20% |
| C-2 ì—°ë™ | 100% | í•µì‹¬ ë°ì´í„° | 70% |

### í˜„ì¬ ëª©í‘œ

**ì¢…í•© ë‹¬ì„±ë¥ **: **70%** (MVP W-2 ê³ ê¸‰ ìŠ¤íŠ¸ë ˆì¹­)

### ì˜ë„ì  ì œì™¸ (ì´ë²ˆ ë²„ì „)

- ì‹¤ì‹œê°„ ì¹´ë©”ë¼ ROM ì¸¡ì •
- AI í¼ ì½”ì¹­ (ìì„¸ í”¼ë“œë°±)
- 20ê°œ ì´ìƒ ìŠ¤í¬ì¸  í”„ë¡œí† ì½œ
- 3D ì• ë‹ˆë©”ì´ì…˜ ê°€ì´ë“œ (ì˜ìƒ ìš°ì„ )

#### ğŸ“Š êµ¬í˜„ í˜„í™©

| ê¸°ëŠ¥ | ìƒíƒœ | ìœ„ì¹˜ |
|------|------|------|
| ì íƒ„ì„± ê¸°ë°˜ ìŠ¤íŠ¸ë ˆì¹­ DB | ğŸ“‹ ê³„íš | `lib/workout/stretching/database.ts` |
| Janda êµì°¨ì¦í›„êµ° ë£¨í‹´ | ğŸ“‹ ê³„íš | `lib/workout/stretching/janda-protocol.ts` |
| ê·¼ë§‰ê²½ì„  ìŠ¤íŠ¸ë ˆì¹­ | ğŸ“‹ ê³„íš | `lib/workout/stretching/fascia-lines.ts` |
| Joint-by-Joint ì ìš© | ğŸ“‹ ê³„íš | `lib/workout/stretching/joint-approach.ts` |
| 6 ìŠ¤í¬ì¸  ì›Œë°ì—… í”„ë¡œí† ì½œ | ğŸ“‹ ê³„íš | `lib/workout/stretching/sport-warmup.ts` |
| ì¿¨ë‹¤ìš´ í”„ë¡œí† ì½œ | ğŸ“‹ ê³„íš | `lib/workout/stretching/cooldown.ts` |
| ìì„¸ë¶„ì„ ì—°ë™ | ğŸ“‹ ê³„íš | `lib/workout/stretching/posture-integration.ts` |
| ì˜ìƒ ê°€ì´ë“œ ì¬ìƒ | ğŸ“‹ ê³„íš | `components/workout/stretching/VideoGuide.tsx` |

---

## ê°œìš”

### ëª©ì 

W-2 ëª¨ë“ˆì€ C-1/C-2 ì²´í˜•/ìì„¸ ë¶„ì„ ê²°ê³¼ì™€ ì—°ë™í•˜ì—¬ ê³¼í•™ì  ê·¼ê±° ê¸°ë°˜ì˜ **ë§ì¶¤í˜• ìŠ¤íŠ¸ë ˆì¹­ ë£¨í‹´**ì„ ì œê³µí•œë‹¤. Janda êµì°¨ì¦í›„êµ°, ê·¼ë§‰ê²½ì„ (Anatomy Trains), Joint-by-Joint ì ‘ê·¼ë²•ì„ ì ìš©í•œ ìì„¸êµì • ìŠ¤íŠ¸ë ˆì¹­ê³¼ 6ê°œ ìŠ¤í¬ì¸ (ë“±ì‚°, ëŸ¬ë‹, ê³¨í”„, ìì „ê±°, ìˆ˜ì˜, í…Œë‹ˆìŠ¤)ë³„ ì›Œë°ì—…/ì¿¨ë‹¤ìš´ í”„ë¡œí† ì½œì„ í¬í•¨í•œë‹¤.

### í•µì‹¬ ì›ë¦¬

| ì›ë¦¬ | ì ìš© |
|------|------|
| **ì íƒ„ì„±(Viscoelasticity)** | ì •ì  ìŠ¤íŠ¸ë ˆì¹­ 30ì´ˆ ìœ ì§€ ê·¼ê±° |
| **Janda êµì°¨ì¦í›„êµ°** | ìì„¸ ë¶ˆê· í˜• â†’ ë‹¨ì¶•/ì•½í™” ê·¼ìœ¡ ì‹ë³„ |
| **PNF ìŠ¤íŠ¸ë ˆì¹­** | Contract-Relax 6ì´ˆâ†’30ì´ˆ í”„ë¡œí† ì½œ |
| **Joint-by-Joint** | ê°€ë™ì„±/ì•ˆì •ì„± êµëŒ€ ê´€ì ˆ ìš°ì„ ìˆœìœ„ |
| **ACSM ê°€ì´ë“œë¼ì¸** | ì£¼ 2-3íšŒ, 15-60ì´ˆ, 2-4ì„¸íŠ¸ |

### ì›ë¦¬ ë¬¸ì„œ ì°¸ì¡°

- [exercise-physiology.md](../principles/exercise-physiology.md) - ìš´ë™ìƒë¦¬í•™, ìì„¸ ë¶ˆê· í˜• í”„ë¡œí† ì½œ
- [body-mechanics.md](../principles/body-mechanics.md) - MediaPipe, ìŠ¤íŠ¸ë ˆì¹­ ì›ë¦¬
- [W-2-FOUNDATION](../research/claude-ai-research/W-2-FOUNDATION.md) - ìŠ¤íŠ¸ë ˆì¹­ ê³¼í•™
- [W-2-SPORT-v2-KR](../research/claude-ai-research/W-2-SPORT-v2-KR.md) - ìŠ¤í¬ì¸ ë³„ í”„ë¡œí† ì½œ
- [W-2-POSTURE-SAFETY](../research/claude-ai-research/W-2-POSTURE-SAFETY.md) - ì•ˆì „ ì •ë³´

### ê¶ê·¹ì˜ í˜•íƒœ (P1)

| í•­ëª© | ì´ìƒì  ìµœì¢… ìƒíƒœ | ë¬¼ë¦¬ì  í•œê³„ | í˜„ì¬ ëª©í‘œ |
|------|-----------------|------------|----------|
| **ìì„¸ ë¶ˆê· í˜• ê°ì§€** | Janda 5ê°œ ìœ í˜• 100% | ì´ë¯¸ì§€ ê°ë„ ì œí•œ | **85%** |
| **ìŠ¤íŠ¸ë ˆì¹­ ê°œì¸í™”** | 100+ ìŠ¤íŠ¸ë ˆì¹­ DB | ì½˜í…ì¸  ì œì‘ ë¹„ìš© | **60ê°œ** |
| **ìŠ¤í¬ì¸ ë³„ í”„ë¡œí† ì½œ** | 20ê°œ ìŠ¤í¬ì¸  | ë¦¬ì„œì¹˜ ë²”ìœ„ | **6ê°œ ìŠ¤í¬ì¸ ** |
| **PNF ê°€ì´ë“œ** | ì‹¤ì‹œê°„ íƒ€ì´ë° | UI/UX ë³µì¡ë„ | **ê³ ì • íƒ€ì´ë¨¸** |
| **ROM ì¸¡ì •** | ì¹´ë©”ë¼ ê¸°ë°˜ ìë™ | ì¥ë¹„ ì œí•œ | **ìê°€ ë³´ê³ ** |
| **C-2 ì—°ë™ ì •í™•ë„** | 100% ìì„¸ ë°ì´í„° í™œìš© | ëª¨ë“ˆ ê²½ê³„ | **í•µì‹¬ ë°ì´í„°** |

**í˜„ì¬ êµ¬í˜„ ëª©í‘œ**: ì „ì²´ ê¶ê·¹ì˜ **70%**

**ì˜ë„ì  ì œì™¸ (ì´ë²ˆ ë²„ì „)**:
- ì‹¤ì‹œê°„ ROM ì¸¡ì • (ì¹´ë©”ë¼ ê¸°ë°˜)
- AI í¼ ì½”ì¹­ (ìì„¸ í”¼ë“œë°±)
- 20ê°œ ì´ìƒ ìŠ¤í¬ì¸  í”„ë¡œí† ì½œ

---

## 1. íƒ€ì… ì •ì˜

### 1.1 ìŠ¤íŠ¸ë ˆì¹­ ìœ í˜•

```typescript
// lib/stretching/types.ts

/**
 * ìŠ¤íŠ¸ë ˆì¹­ ìœ í˜•
 * - static: ì •ì  (ìš´ë™ í›„, ìœ ì—°ì„± í–¥ìƒ)
 * - dynamic: ë™ì  (ìš´ë™ ì „, ì›Œë°ì—…)
 * - pnf: PNF (ìš´ë™ í›„, ìµœëŒ€ ROM íšë“)
 */
export type StretchType = 'static' | 'dynamic' | 'pnf';

/**
 * ìŠ¤íŠ¸ë ˆì¹­ ì¹´í…Œê³ ë¦¬
 */
export type StretchCategory =
  | 'posture_correction'  // ìì„¸êµì •
  | 'sport_warmup'        // ìŠ¤í¬ì¸  ì›Œë°ì—…
  | 'sport_cooldown'      // ìŠ¤í¬ì¸  ì¿¨ë‹¤ìš´
  | 'general_flexibility' // ì¼ë°˜ ìœ ì—°ì„±
  | 'recovery';           // íšŒë³µ

/**
 * ìŠ¤í¬ì¸  ìœ í˜• (Phase 1 ì§€ì›)
 */
export type SportType =
  | 'hiking'    // ë“±ì‚°
  | 'running'   // ëŸ¬ë‹
  | 'golf'      // ê³¨í”„
  | 'cycling'   // ìì „ê±°
  | 'swimming'  // ìˆ˜ì˜
  | 'tennis';   // í…Œë‹ˆìŠ¤

/**
 * ìì„¸ ë¶ˆê· í˜• ìœ í˜•
 */
export type PostureImbalanceType =
  | 'upper_cross'       // ìƒë¶€êµì°¨ì¦í›„êµ° (ê±°ë¶ëª© + ë¼ìš´ë“œìˆ„ë”)
  | 'lower_cross'       // í•˜ë¶€êµì°¨ì¦í›„êµ° (ê³¨ë°˜ì „ë°©ê²½ì‚¬)
  | 'sway_back'         // ìŠ¤ì›¨ì´ë°±
  | 'flat_back'         // í¸í‰ë“±
  | 'forward_head'      // ê±°ë¶ëª© ë‹¨ë…
  | 'rounded_shoulder'  // ë¼ìš´ë“œìˆ„ë” ë‹¨ë…
  | 'pelvic_tilt_ant'   // ê³¨ë°˜ì „ë°©ê²½ì‚¬ ë‹¨ë…
  | 'pelvic_tilt_post'; // ê³¨ë°˜í›„ë°©ê²½ì‚¬

/**
 * ê·¼ìœ¡êµ° (ìš´ë™ìƒë¦¬í•™ ì›ë¦¬ ê¸°ë°˜)
 */
export type MuscleGroup =
  // ìƒì²´
  | 'pectoralis_major'      // ëŒ€í‰ê·¼
  | 'pectoralis_minor'      // ì†Œí‰ê·¼
  | 'upper_trapezius'       // ìƒë¶€ ìŠ¹ëª¨ê·¼
  | 'mid_lower_trapezius'   // ì¤‘/í•˜ë¶€ ìŠ¹ëª¨ê·¼
  | 'levator_scapulae'      // ê²¬ê°‘ê±°ê·¼
  | 'rhomboids'             // ëŠ¥í˜•ê·¼
  | 'serratus_anterior'     // ì „ê±°ê·¼
  | 'latissimus_dorsi'      // ê´‘ë°°ê·¼
  | 'deep_neck_flexors'     // ì‹¬ë¶€ ê²½ì¶” êµ´ê³¡ê·¼
  | 'suboccipitals'         // í›„ë‘í•˜ê·¼
  | 'sternocleidomastoid'   // í‰ì‡„ìœ ëŒê·¼
  | 'rotator_cuff'          // íšŒì „ê·¼ê°œ
  | 'deltoid'               // ì‚¼ê°ê·¼
  // ì½”ì–´
  | 'rectus_abdominis'      // ë³µì§ê·¼
  | 'transverse_abdominis'  // ë³µíš¡ê·¼
  | 'obliques'              // ë³µì‚¬ê·¼
  | 'erector_spinae'        // ì²™ì¶”ê¸°ë¦½ê·¼
  | 'multifidus'            // ë‹¤ì—´ê·¼
  | 'quadratus_lumborum'    // ìš”ë°©í˜•ê·¼
  // í•˜ì²´
  | 'iliopsoas'             // ì¥ìš”ê·¼
  | 'rectus_femoris'        // ëŒ€í‡´ì§ê·¼
  | 'gluteus_maximus'       // ëŒ€ë‘”ê·¼
  | 'gluteus_medius'        // ì¤‘ë‘”ê·¼
  | 'piriformis'            // ì´ìƒê·¼
  | 'hamstrings'            // í–„ìŠ¤íŠ¸ë§
  | 'quadriceps'            // ëŒ€í‡´ì‚¬ë‘ê·¼
  | 'adductors'             // ë‚´ì „ê·¼
  | 'tensor_fasciae_latae'  // ëŒ€í‡´ê·¼ë§‰ì¥ê·¼
  | 'iliotibial_band'       // ì¥ê²½ì¸ëŒ€
  | 'gastrocnemius'         // ë¹„ë³µê·¼
  | 'soleus'                // ê°€ìë¯¸ê·¼
  | 'tibialis_anterior';    // ì „ê²½ê³¨ê·¼
```

### 1.2 ìš´ë™ ì¸í„°í˜ì´ìŠ¤

```typescript
// lib/stretching/types.ts (ê³„ì†)

/**
 * ì¥ë¹„ ìœ í˜•
 */
export type Equipment =
  | 'bodyweight'       // ë§¨ëª¸
  | 'wall'             // ë²½
  | 'chair'            // ì˜ì
  | 'mat'              // ë§¤íŠ¸
  | 'foam_roller'      // í¼ë¡¤ëŸ¬
  | 'resistance_band'  // ì €í•­ë°´ë“œ
  | 'yoga_block'       // ìš”ê°€ë¸”ë¡
  | 'trekking_pole'    // íŠ¸ë ˆí‚¹í´ (ë“±ì‚°)
  | 'golf_club';       // ê³¨í”„ì±„

/**
 * ë‚œì´ë„
 */
export type Difficulty = 'beginner' | 'intermediate' | 'advanced';

/**
 * ìŠ¤íŠ¸ë ˆì¹­ ìš´ë™ ì •ì˜
 */
export interface StretchExercise {
  id: string;
  nameKo: string;
  nameEn: string;
  type: StretchType;
  category: StretchCategory;

  // ê·¼ìœ¡ íƒ€ê²Ÿ
  targetMuscles: MuscleGroup[];
  secondaryMuscles: MuscleGroup[];

  // ì‹¤í–‰ ì •ë³´
  equipment: Equipment[];
  difficulty: Difficulty;

  // íŒŒë¼ë¯¸í„°
  defaultDuration: number;          // ì´ˆ (ì •ì ) ë˜ëŠ” íšŸìˆ˜ (ë™ì )
  durationUnit: 'seconds' | 'reps';
  sets: number;
  restBetweenSets: number;          // ì´ˆ

  // ì½˜í…ì¸ 
  instructions: string[];           // ë‹¨ê³„ë³„ ì„¤ëª…
  breathingGuide: string;           // í˜¸í¡ ê°€ì´ë“œ
  commonMistakes: string[];         // í”í•œ ì‹¤ìˆ˜

  // ë¯¸ë””ì–´
  videoUrl?: string;
  thumbnailUrl?: string;
  animationFrames?: string[];       // ì• ë‹ˆë©”ì´ì…˜ í”„ë ˆì„ URL

  // ì•ˆì „
  contraindications: string[];      // ê¸ˆê¸°ì‚¬í•­
  modifications: ExerciseModification[];
  redFlags: string[];               // ì¦‰ì‹œ ì¤‘ë‹¨ ì‹ í˜¸
}

/**
 * ìš´ë™ ë³€í˜• (íŠ¹ìˆ˜ ìƒí™©ìš©)
 */
export interface ExerciseModification {
  condition: string;          // 'ë¬´ë¦ í†µì¦', 'ì„ì‚°ë¶€', 'ê³ ë ¹ì' ë“±
  description: string;
  adjustedDuration?: number;
  adjustedSets?: number;
  alternativeExerciseId?: string;
}
```

### 1.3 ìì„¸ ë¶„ì„ ì—°ë™ íƒ€ì…

```typescript
// lib/stretching/types.ts (ê³„ì†)

/**
 * ìì„¸ ë¶„ì„ ê²°ê³¼ (C-1/C-2ì—ì„œ ì „ë‹¬ë°›ìŒ)
 */
export interface PostureAnalysisResult {
  assessmentId: string;
  createdAt: string;

  // ì¸¡ì • ê°ë„ (body-mechanics.md ì°¸ì¡°)
  angles: {
    cva: number;              // ë‘ê°œì²™ì¶”ê° (ì •ìƒ: >50Â°)
    shoulderTilt: number;     // ì–´ê¹¨ ê¸°ìš¸ê¸° (ì •ìƒ: 0Â°)
    thoracicKyphosis: number; // í‰ì¶” í›„ë§Œ (ì •ìƒ: 20-40Â°)
    lumbarLordosis: number;   // ìš”ì¶” ì „ë§Œ (ì •ìƒ: 40-60Â°)
    pelvicTilt: number;       // ê³¨ë°˜ ê¸°ìš¸ê¸° (ì •ìƒ: 0Â°)
  };

  // ì ìˆ˜ ë° ë“±ê¸‰
  overallScore: number;       // 0-100
  category: 'excellent' | 'good' | 'moderate' | 'poor';

  // ê°ì§€ëœ ë¶ˆê· í˜•
  imbalances: PostureImbalance[];

  // ë‹¨ì¶•/ì•½í™” ê·¼ìœ¡
  tightMuscles: MuscleGroup[];
  weakMuscles: MuscleGroup[];
}

/**
 * ìì„¸ ë¶ˆê· í˜• ìƒì„¸
 */
export interface PostureImbalance {
  type: PostureImbalanceType;
  severity: 'mild' | 'moderate' | 'severe';
  affectedAngles: string[];
  description: string;
}
```

### 1.4 ë£¨í‹´ ë° ì²˜ë°© íƒ€ì…

```typescript
// lib/stretching/types.ts (ê³„ì†)

/**
 * ì‚¬ìš©ì í”„ë¡œí•„ (ìŠ¤íŠ¸ë ˆì¹­ìš©)
 */
export interface StretchingUserProfile {
  userId: string;

  // ê¸°ë³¸ ì •ë³´
  age: number;
  gender: 'male' | 'female';

  // ìš´ë™ ìˆ˜ì¤€
  fitnessLevel: Difficulty;
  stretchingExperience: 'none' | 'some' | 'regular';

  // ìŠ¤í¬ì¸  í™œë™
  primarySports: SportType[];
  sportsFrequency: 'daily' | 'weekly' | 'monthly' | 'rarely';

  // ê±´ê°• ì •ë³´
  contraindications: string[];  // ê¸°ì¡´ ì§ˆí™˜, ë¶€ìƒ
  specialConditions: SpecialCondition[];

  // ê°€ìš© ì¥ë¹„
  availableEquipment: Equipment[];

  // ì„ í˜¸ ì„¤ì •
  preferredSessionDuration: number;  // ë¶„
  preferredLanguage: 'ko' | 'en';
}

/**
 * íŠ¹ìˆ˜ ì¡°ê±´ (ì•ˆì „ í•„í„°ë§ìš©)
 */
export type SpecialCondition =
  | 'pregnancy'          // ì„ì‹ 
  | 'senior'             // ê³ ë ¹ì (65+)
  | 'osteoporosis'       // ê³¨ë‹¤ê³µì¦
  | 'disc_herniation'    // ë””ìŠ¤í¬ íƒˆì¶œ
  | 'spinal_stenosis'    // ì²™ì¶”ê´€ í˜‘ì°©
  | 'rheumatoid'         // ë¥˜ë§ˆí‹°ìŠ¤
  | 'hypermobility'      // ê³¼ê°€ë™ì„±
  | 'recent_surgery';    // ìµœê·¼ ìˆ˜ìˆ 

/**
 * ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°© ê²°ê³¼
 */
export interface StretchingPrescription {
  prescriptionId: string;
  createdAt: string;

  // ì…ë ¥ ê¸°ë°˜
  basedOn: {
    postureAnalysis?: string;  // ìì„¸ë¶„ì„ ID
    sport?: SportType;
    purpose: 'posture_correction' | 'warmup' | 'cooldown' | 'general';
  };

  // ì²˜ë°© ë‚´ìš©
  stretches: PrescribedStretch[];
  inhibitions?: PrescribedStretch[];   // SMR/í¼ë¡¤ë§ (NASM)
  activations?: PrescribedStretch[];   // ì•½í™”ê·¼ìœ¡ í™œì„±í™”

  // ë©”íƒ€ ì •ë³´
  totalDuration: number;               // ë¶„
  frequency: string;                   // 'ì£¼ 5-6íšŒ' ë“±
  warnings: string[];
  medicalDisclaimer: string;
}

/**
 * ì²˜ë°©ëœ ê°œë³„ ìŠ¤íŠ¸ë ˆì¹­
 */
export interface PrescribedStretch {
  exercise: StretchExercise;
  order: number;
  adjustedDuration: number;
  adjustedSets: number;
  notes?: string;
}

/**
 * ì£¼ê°„ ë£¨í‹´
 */
export interface WeeklyStretchingPlan {
  planId: string;
  userId: string;
  weekStartDate: string;

  days: {
    monday: DailyRoutine;
    tuesday: DailyRoutine;
    wednesday: DailyRoutine;
    thursday: DailyRoutine;
    friday: DailyRoutine;
    saturday: DailyRoutine;
    sunday: DailyRoutine;
  };

  progressionWeek: number;  // 1-4ì£¼ì°¨
}

/**
 * ì¼ì¼ ë£¨í‹´
 */
export interface DailyRoutine {
  type: 'stretch' | 'strengthen' | 'rest' | 'active_recovery';
  stretches: PrescribedStretch[];
  duration: number;  // ë¶„
  notes?: string;
}
```

### 1.5 ì§„í–‰ ì¶”ì  íƒ€ì…

```typescript
// lib/stretching/types.ts (ê³„ì†)

/**
 * ìŠ¤íŠ¸ë ˆì¹­ ì„¸ì…˜ ê¸°ë¡
 */
export interface StretchingSession {
  sessionId: string;
  userId: string;
  startedAt: string;
  completedAt?: string;

  // ìˆ˜í–‰ ë‚´ìš©
  prescriptionId: string;
  completedExercises: CompletedExercise[];

  // í”¼ë“œë°±
  perceivedEffort: number;    // 1-10 RPE
  painReported: boolean;
  painDetails?: string;
  overallSatisfaction: number; // 1-5

  // ê³„ì‚°ê°’
  completionRate: number;     // 0-100%
  totalActiveTime: number;    // ì´ˆ
}

/**
 * ì™„ë£Œëœ ìš´ë™
 */
export interface CompletedExercise {
  exerciseId: string;
  completedSets: number;
  actualDuration: number;
  skipped: boolean;
  skipReason?: string;
}

/**
 * ROM ì§„í–‰ ì¶”ì 
 */
export interface ROMProgress {
  userId: string;
  muscleGroup: MuscleGroup;
  measurements: ROMMeasurement[];
}

export interface ROMMeasurement {
  date: string;
  romDegrees: number;
  measurementType: 'self_reported' | 'ai_estimated';
  notes?: string;
}
```

---

## 2. í•µì‹¬ ì•Œê³ ë¦¬ì¦˜

### 2.1 ìì„¸ ê¸°ë°˜ ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°©

```typescript
// lib/stretching/posture-prescription.ts

import {
  PostureAnalysisResult,
  PostureImbalanceType,
  StretchingPrescription,
  StretchingUserProfile,
  StretchExercise,
  MuscleGroup,
} from './types';
import { POSTURE_PROTOCOLS } from './data/posture-protocols';
import { EXERCISE_DATABASE } from './data/exercise-database';

/**
 * ìì„¸ ë¶ˆê· í˜•ë³„ ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ (exercise-physiology.md ê¸°ë°˜)
 */
export const POSTURE_PROTOCOLS: Record<PostureImbalanceType, {
  stretches: string[];      // ìš´ë™ ID (ë‹¨ì¶• ê·¼ìœ¡ìš©)
  activations: string[];    // ìš´ë™ ID (ì•½í™” ê·¼ìœ¡ìš©)
  strengthening: string[];  // ìš´ë™ ID (ê°•í™”ìš©)
  frequency: string;
  progression: {
    week1to2: string;
    week3to4: string;
    week5plus: string;
  };
}> = {
  upper_cross: {
    stretches: [
      'chest_doorway_stretch',      // ëŒ€í‰ê·¼
      'upper_trap_stretch',         // ìƒë¶€ ìŠ¹ëª¨ê·¼
      'levator_scapulae_stretch',   // ê²¬ê°‘ê±°ê·¼
      'suboccipital_release',       // í›„ë‘í•˜ê·¼
      'scalene_stretch',            // ì‚¬ê°ê·¼
      'pec_minor_corner_stretch',   // ì†Œí‰ê·¼
    ],
    activations: [
      'chin_tucks',                 // ì‹¬ë¶€ ê²½ì¶” êµ´ê³¡ê·¼
      'wall_angels',                // ì¤‘/í•˜ ìŠ¹ëª¨ê·¼, ì „ê±°ê·¼
      'prone_y_t_w',                // ëŠ¥í˜•ê·¼, ì¤‘/í•˜ ìŠ¹ëª¨ê·¼
    ],
    strengthening: [
      'face_pulls',                 // í›„ë°© ì‚¼ê°ê·¼, ëŠ¥í˜•ê·¼
      'rows',                       // ê´‘ë°°ê·¼, ëŠ¥í˜•ê·¼
      'external_rotation',          // ê·¹í•˜ê·¼, ì†Œì›ê·¼
      'serratus_push_up_plus',      // ì „ê±°ê·¼
    ],
    frequency: 'ìŠ¤íŠ¸ë ˆì¹­ ì£¼ 5-6íšŒ, ê°•í™” ì£¼ 3íšŒ',
    progression: {
      week1to2: 'ìŠ¤íŠ¸ë ˆì¹­ ìœ„ì£¼ (30ì´ˆ x 2ì„¸íŠ¸)',
      week3to4: 'í™œì„±í™” ì¶”ê°€ (10íšŒ x 2ì„¸íŠ¸)',
      week5plus: 'ì ì§„ì  ê°•í™” (12-15íšŒ x 3ì„¸íŠ¸)',
    },
  },

  lower_cross: {
    stretches: [
      'hip_flexor_lunge_stretch',   // ì¥ìš”ê·¼
      'quad_stretch_standing',       // ëŒ€í‡´ì§ê·¼
      'lower_back_cat_cow',         // ì²™ì¶”ê¸°ë¦½ê·¼
      'piriformis_stretch',         // ì´ìƒê·¼
      'tfl_stretch',                // ëŒ€í‡´ê·¼ë§‰ì¥ê·¼
    ],
    activations: [
      'glute_bridge',               // ëŒ€ë‘”ê·¼ í™œì„±í™”
      'dead_bug',                   // ë³µíš¡ê·¼
      'clamshell',                  // ì¤‘ë‘”ê·¼
      'bird_dog',                   // ì½”ì–´ ì•ˆì •í™”
    ],
    strengthening: [
      'hip_thrust',                 // ëŒ€ë‘”ê·¼
      'plank',                      // ë³µì§ê·¼, ë³µíš¡ê·¼
      'pallof_press',               // ì½”ì–´ í•­íšŒì „
      'side_plank',                 // ë³µì‚¬ê·¼, ì¤‘ë‘”ê·¼
    ],
    frequency: 'ìŠ¤íŠ¸ë ˆì¹­ ì£¼ 5-6íšŒ, ê°•í™” ì£¼ 3íšŒ',
    progression: {
      week1to2: 'ìŠ¤íŠ¸ë ˆì¹­ ìœ„ì£¼',
      week3to4: 'í™œì„±í™” ì¶”ê°€',
      week5plus: 'ì ì§„ì  ê°•í™”',
    },
  },

  forward_head: {
    stretches: [
      'upper_trap_stretch',
      'levator_scapulae_stretch',
      'suboccipital_release',
      'sternocleidomastoid_stretch',
    ],
    activations: [
      'chin_tucks',
      'cervical_retraction',
    ],
    strengthening: [
      'neck_flexor_strengthening',
    ],
    frequency: 'ìŠ¤íŠ¸ë ˆì¹­ ë§¤ì¼, ê°•í™” ì£¼ 3íšŒ',
    progression: {
      week1to2: 'ìŠ¤íŠ¸ë ˆì¹­ ì§‘ì¤‘ (20ì´ˆ x 3ì„¸íŠ¸)',
      week3to4: 'í„± ë‹¹ê¸°ê¸° ì¶”ê°€ (10íšŒ x 5ì„¸íŠ¸/ì¼)',
      week5plus: 'ì ì§„ì  ê°•í™”',
    },
  },

  rounded_shoulder: {
    stretches: [
      'chest_doorway_stretch',
      'pec_minor_corner_stretch',
    ],
    activations: [
      'wall_angels',
      'band_pull_apart',
    ],
    strengthening: [
      'face_pulls',
      'rows',
    ],
    frequency: 'ìŠ¤íŠ¸ë ˆì¹­ ì£¼ 5íšŒ, ê°•í™” ì£¼ 3íšŒ',
    progression: {
      week1to2: 'ìŠ¤íŠ¸ë ˆì¹­ ìœ„ì£¼',
      week3to4: 'í™œì„±í™” ì¶”ê°€',
      week5plus: 'ê°•í™” ì¶”ê°€',
    },
  },

  pelvic_tilt_ant: {
    stretches: [
      'hip_flexor_lunge_stretch',
      'quad_stretch_standing',
      'lower_back_stretch',
    ],
    activations: [
      'glute_bridge',
      'dead_bug',
      'posterior_pelvic_tilt_supine',
    ],
    strengthening: [
      'hip_thrust',
      'plank',
      'reverse_crunch',
    ],
    frequency: 'ìŠ¤íŠ¸ë ˆì¹­ ì£¼ 5-6íšŒ, ê°•í™” ì£¼ 3íšŒ',
    progression: {
      week1to2: 'ìŠ¤íŠ¸ë ˆì¹­ + ê³¨ë°˜ ì¸ì§€',
      week3to4: 'í™œì„±í™” ì¶”ê°€',
      week5plus: 'ê°•í™” ì¶”ê°€',
    },
  },

  pelvic_tilt_post: {
    stretches: [
      'hamstring_stretch_supine',
      'glute_stretch_figure_four',
    ],
    activations: [
      'cat_cow',
      'pelvic_tilts_supine',
      'hip_flexor_activation',
    ],
    strengthening: [
      'hip_flexor_strengthening',
      'back_extension_prone',
      'superman',
    ],
    frequency: 'ìŠ¤íŠ¸ë ˆì¹­ ì£¼ 4-5íšŒ',
    progression: {
      week1to2: 'ê°€ë™ì„± íšŒë³µ',
      week3to4: 'ì •ìƒ ê³¡ì„  ì¬í•™ìŠµ',
      week5plus: 'ê·¼ë ¥ ê°•í™”',
    },
  },

  sway_back: {
    stretches: [
      'hamstring_stretch_supine',
      'upper_ab_stretch',
      'thoracic_extension',
    ],
    activations: [
      'hip_flexor_activation',
      'lower_ab_engagement',
    ],
    strengthening: [
      'hip_flexor_strengthening',
      'lower_ab_exercises',
      'back_extension_prone',
    ],
    frequency: 'ì£¼ 4-5íšŒ',
    progression: {
      week1to2: 'ì‹ ê²½ê·¼ ì¬êµìœ¡',
      week3to4: 'ê°•í™” ë„ì…',
      week5plus: 'í†µí•© ìš´ë™',
    },
  },

  flat_back: {
    stretches: [
      'hamstring_stretch_supine',
      'rectus_abdominis_stretch',
    ],
    activations: [
      'cat_cow',
      'pelvic_tilts_supine',
    ],
    strengthening: [
      'hip_flexor_strengthening',
      'back_extension_prone',
      'superman',
    ],
    frequency: 'ì£¼ 4-5íšŒ',
    progression: {
      week1to2: 'ê°€ë™ì„± íšŒë³µ',
      week3to4: 'ì •ìƒ ê³¡ì„  ì¬í•™ìŠµ',
      week5plus: 'ê·¼ë ¥ ê°•í™”',
    },
  },
};

/**
 * ìì„¸ ë¶„ì„ ê²°ê³¼ ê¸°ë°˜ ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°© ìƒì„±
 */
export function prescribePostureStretching(
  postureResult: PostureAnalysisResult,
  userProfile: StretchingUserProfile
): StretchingPrescription {
  const allExerciseIds = new Set<string>();
  const allActivationIds = new Set<string>();
  const warnings: string[] = [];

  // 1. ë¶ˆê· í˜•ë³„ ìš´ë™ ìˆ˜ì§‘
  for (const imbalance of postureResult.imbalances) {
    const protocol = POSTURE_PROTOCOLS[imbalance.type];
    if (!protocol) continue;

    protocol.stretches.forEach(id => allExerciseIds.add(id));
    protocol.activations.forEach(id => allActivationIds.add(id));

    // ì‹¬ê°ë„ë³„ ê²½ê³  ì¶”ê°€
    if (imbalance.severity === 'severe') {
      warnings.push(
        `ì‹¬ê°í•œ ${getImbalanceKoreanName(imbalance.type)} ê°ì§€: ` +
        'ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ë˜ëŠ” ì •í˜•ì™¸ê³¼ ì „ë¬¸ì˜ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤.'
      );
    }
  }

  // 2. ìš´ë™ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒ
  const stretches = EXERCISE_DATABASE.filter(e => allExerciseIds.has(e.id));
  const activations = EXERCISE_DATABASE.filter(e => allActivationIds.has(e.id));

  // 3. ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§
  const filteredStretches = filterContraindications(
    stretches,
    userProfile.contraindications,
    userProfile.specialConditions
  );

  const filteredActivations = filterContraindications(
    activations,
    userProfile.contraindications,
    userProfile.specialConditions
  );

  // 4. ë‚œì´ë„ ì¡°ì ˆ
  const adjustedStretches = adjustForFitnessLevel(
    filteredStretches,
    userProfile.fitnessLevel
  );

  // 5. ì¥ë¹„ í•„í„°ë§
  const availableStretches = filterByEquipment(
    adjustedStretches,
    userProfile.availableEquipment
  );

  const availableActivations = filterByEquipment(
    filteredActivations,
    userProfile.availableEquipment
  );

  // 6. íŠ¹ìˆ˜ ì¡°ê±´ ê²½ê³  ì¶”ê°€
  if (userProfile.specialConditions.includes('pregnancy')) {
    warnings.push('ì„ì‚°ë¶€: 2ì‚¼ë¶„ê¸° ì´í›„ ì•™ì™€ìœ„ ìš´ë™ ì‹œ ì¢Œì¸¡ìœ¼ë¡œ ëˆ•ê¸°');
  }
  if (userProfile.age >= 65) {
    warnings.push('65ì„¸ ì´ìƒ: ìŠ¤íŠ¸ë ˆì¹­ ìœ ì§€ ì‹œê°„ 30-60ì´ˆë¡œ ì—°ì¥');
  }

  // 7. ì²˜ë°© ìƒì„±
  const prescribedStretches = availableStretches.map((exercise, index) => ({
    exercise,
    order: index + 1,
    adjustedDuration: adjustDurationForAge(
      exercise.defaultDuration,
      userProfile.age,
      exercise.durationUnit
    ),
    adjustedSets: exercise.sets,
  }));

  const prescribedActivations = availableActivations.map((exercise, index) => ({
    exercise,
    order: index + 1,
    adjustedDuration: exercise.defaultDuration,
    adjustedSets: exercise.sets,
  }));

  // 8. ì´ ì‹œê°„ ê³„ì‚°
  const totalDuration = calculateTotalDuration(
    prescribedStretches,
    prescribedActivations
  );

  return {
    prescriptionId: `presc_${Date.now()}`,
    createdAt: new Date().toISOString(),
    basedOn: {
      postureAnalysis: postureResult.assessmentId,
      purpose: 'posture_correction',
    },
    stretches: prescribedStretches,
    activations: prescribedActivations,
    totalDuration,
    frequency: determineBestFrequency(postureResult.imbalances),
    warnings,
    medicalDisclaimer: POSTURE_MEDICAL_DISCLAIMER,
  };
}

/**
 * ë¶ˆê· í˜• ìœ í˜• í•œêµ­ì–´ëª…
 */
function getImbalanceKoreanName(type: PostureImbalanceType): string {
  const names: Record<PostureImbalanceType, string> = {
    upper_cross: 'ìƒë¶€êµì°¨ì¦í›„êµ°',
    lower_cross: 'í•˜ë¶€êµì°¨ì¦í›„êµ°',
    forward_head: 'ê±°ë¶ëª©',
    rounded_shoulder: 'ë¼ìš´ë“œìˆ„ë”',
    pelvic_tilt_ant: 'ê³¨ë°˜ì „ë°©ê²½ì‚¬',
    pelvic_tilt_post: 'ê³¨ë°˜í›„ë°©ê²½ì‚¬',
    sway_back: 'ìŠ¤ì›¨ì´ë°±',
    flat_back: 'í¸í‰ë“±',
  };
  return names[type];
}

/**
 * ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§
 */
function filterContraindications(
  exercises: StretchExercise[],
  contraindications: string[],
  specialConditions: SpecialCondition[]
): StretchExercise[] {
  return exercises.filter(exercise => {
    // ì‚¬ìš©ì ê¸ˆê¸°ì‚¬í•­ê³¼ ìš´ë™ ê¸ˆê¸°ì‚¬í•­ êµì°¨ í™•ì¸
    const hasContraindication = exercise.contraindications.some(c =>
      contraindications.includes(c)
    );

    // íŠ¹ìˆ˜ ì¡°ê±´ í™•ì¸
    const hasSpecialConditionIssue = specialConditions.some(condition => {
      // ì˜ˆ: ì„ì‚°ë¶€ëŠ” ì•™ì™€ìœ„ ìš´ë™ ì œí•œ
      if (condition === 'pregnancy') {
        return exercise.id.includes('supine') &&
               !exercise.modifications.some(m => m.condition === 'ì„ì‚°ë¶€');
      }
      // ê³¨ë‹¤ê³µì¦ì€ ì²™ì¶” êµ´ê³¡ ìš´ë™ ì œí•œ
      if (condition === 'osteoporosis') {
        return exercise.contraindications.includes('osteoporosis');
      }
      return false;
    });

    return !hasContraindication && !hasSpecialConditionIssue;
  });
}

/**
 * ì—°ë ¹ë³„ ì§€ì† ì‹œê°„ ì¡°ì •
 */
function adjustDurationForAge(
  defaultDuration: number,
  age: number,
  unit: 'seconds' | 'reps'
): number {
  if (unit === 'reps') return defaultDuration;

  // ACSM: ê³ ë ¹ì(65+)ëŠ” 30-60ì´ˆ ê¶Œì¥
  if (age >= 65) {
    return Math.min(60, Math.max(30, defaultDuration * 1.5));
  }
  return defaultDuration;
}

/**
 * ì˜ë£Œ ë©´ì±…ì¡°í•­
 */
const POSTURE_MEDICAL_DISCLAIMER = `
ì´ ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°©ì€ AI ê¸°ë°˜ ìì„¸ ë¶„ì„ ê²°ê³¼ì— ë”°ë¥¸ ì¼ë°˜ì ì¸ ìš´ë™ ê°€ì´ë“œì…ë‹ˆë‹¤.

ì˜ë£Œ ì§„ë‹¨ì´ë‚˜ ë¬¼ë¦¬ì¹˜ë£Œë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ë‹¤ìŒ ê²½ìš° ë°˜ë“œì‹œ ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì„¸ìš”:
â€¢ ì‹¬ê°í•œ ìì„¸ ë¶ˆê· í˜• (CVA < 40Â° ë“±)
â€¢ ë§Œì„± í†µì¦ ë˜ëŠ” ê¸‰ì„± ë¶€ìƒ
â€¢ ê¸°ì¡´ ì²™ì¶”/ê´€ì ˆ ì§ˆí™˜
â€¢ ìˆ˜ìˆ  ì´ë ¥ ë˜ëŠ” ì¬í™œ ì¤‘

Red Flags (ì¦‰ì‹œ ì¤‘ë‹¨):
â€¢ ë°©ì‚¬í†µ (íŒ”/ë‹¤ë¦¬ë¡œ í¼ì§€ëŠ” í†µì¦)
â€¢ ì €ë¦¼, ë¬´ê°ê°, ê·¼ë ¥ ì €í•˜
â€¢ ë°°ë³€/ë°°ë‡¨ ì¥ì•  (ì‘ê¸‰)
`.trim();
```

### 2.2 ìŠ¤í¬ì¸ ë³„ ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ

```typescript
// lib/stretching/sport-protocols.ts

import {
  SportType,
  StretchingPrescription,
  StretchingUserProfile,
  PrescribedStretch,
} from './types';
import { EXERCISE_DATABASE } from './data/exercise-database';

/**
 * ìŠ¤í¬ì¸ ë³„ ì›Œë°ì—…/ì¿¨ë‹¤ìš´ í”„ë¡œí† ì½œ (W-2-SPORT-v2-KR ê¸°ë°˜)
 */
export const SPORT_PROTOCOLS: Record<SportType, {
  warmup: SportProtocolPhase;
  cooldown: SportProtocolPhase;
  keyMuscles: string[];
  commonInjuries: string[];
  koreanSpecificNotes: string[];
}> = {
  hiking: {
    warmup: {
      exercises: [
        'knee_hugs',              // ëŒ€ë‘”ê·¼, ì¥ìš”ê·¼
        'leg_swings_front_back',  // í–„ìŠ¤íŠ¸ë§, ê³ ê´€ì ˆ
        'walking_lunges',         // ëŒ€í‡´ì‚¬ë‘ê·¼, ë‘”ê·¼
        'high_knees',             // ì¥ìš”ê·¼
        'butt_kicks',             // í–„ìŠ¤íŠ¸ë§
        'ankle_circles',          // ë°œëª©
        'torso_twists',           // ì½”ì–´
      ],
      duration: 10,
      type: 'dynamic',
    },
    cooldown: {
      exercises: [
        'quad_stretch_standing',
        'hamstring_stretch_seated',
        'calf_stretch_wall',
        'glute_stretch_figure_four',
        'it_band_stretch_standing',
        'butterfly_stretch',
        'hip_flexor_lunge_stretch',
      ],
      duration: 15,
      type: 'static',
    },
    keyMuscles: ['quadriceps', 'gluteus_maximus', 'gastrocnemius', 'hamstrings'],
    commonInjuries: ['PFPS', 'ITBS', 'DOMS', 'ë°œëª© ì—¼ì¢Œ'],
    koreanSpecificNotes: [
      'ì§§ê³  ê°€íŒŒë¥¸ ì½”ìŠ¤ (ë¶í•œì‚°, ì„¤ì•…ì‚°): ë‚´ë¦¬ë§‰ í¸ì‹¬ì„± ìˆ˜ì¶• ì£¼ì˜',
      'íŠ¸ë ˆí‚¹ í´ ì‚¬ìš©: ë¬´ë¦ í•˜ì¤‘ 20-25% ê°ì†Œ',
      'ê³ ë ¹ì(60+): ì›Œë°ì—… ê°•ë„ ë‚®ì¶”ê³  ì§€ì§€ëŒ€ í™œìš©',
      'í•˜ì‚° ì „ 5ë¶„ ë‚´ë¦¬ë§‰ ë³´í–‰ì´ DOMSë¥¼ 47-64% ê°ì†Œ (ë°˜ë³µ íš¨ê³¼)',
    ],
  },

  running: {
    warmup: {
      exercises: [
        'leg_swings_front_back',
        'leg_swings_lateral',
        'hip_circles',
        'walking_lunges',
        'high_knees',
        'butt_kicks',
        'carioca',
        'inchworm',
      ],
      duration: 10,
      type: 'dynamic',
    },
    cooldown: {
      exercises: [
        'quad_stretch_standing',
        'hamstring_stretch_standing',
        'calf_stretch_wall',
        'hip_flexor_lunge_stretch',
        'glute_stretch_figure_four',
        'it_band_stretch_standing',
        'butterfly_stretch',
      ],
      duration: 10,
      type: 'static',
    },
    keyMuscles: ['quadriceps', 'hamstrings', 'gastrocnemius', 'gluteus_maximus', 'iliopsoas'],
    commonInjuries: ['ITBS', 'ì¡±ì €ê·¼ë§‰ì—¼', 'ì•„í‚¬ë ˆìŠ¤ê±´ì—¼', 'MTSS'],
    koreanSpecificNotes: [
      'MZì„¸ëŒ€ ì¸ê¸° ìŠ¤í¬ì¸ : ì´ˆë³´ì ì£¼ê°„ ê±°ë¦¬ 10% ì´ë‚´ ì¦ê°€',
      'ìš´ë™ ì „ ì •ì  ìŠ¤íŠ¸ë ˆì¹­ì€ í¼í¬ë¨¼ìŠ¤ ì €í•˜ ê°€ëŠ¥ (60ì´ˆ ì´ìƒ)',
      'ITBS: ë‘”ê·¼ ê°•í™”ê°€ ìŠ¤íŠ¸ë ˆì¹­ë³´ë‹¤ íš¨ê³¼ì ',
    ],
  },

  golf: {
    warmup: {
      exercises: [
        'overhead_squat_with_club',
        'lunge_with_rotation',
        'split_stance_rotation',
        'hip_circles_open_close',
        'worlds_greatest_stretch',
        'arm_circles',
        'club_swing_acceleration',
      ],
      duration: 15,
      type: 'dynamic',
    },
    cooldown: {
      exercises: [
        'hip_flexor_lunge_stretch',
        'glute_stretch_figure_four',
        'spine_twist_supine',
        'cross_body_shoulder_stretch',
        'thoracic_extension_foam_roller',
        'hamstring_stretch_seated',
        'lateral_trunk_stretch',
      ],
      duration: 10,
      type: 'static',
    },
    keyMuscles: ['obliques', 'gluteus_maximus', 'latissimus_dorsi', 'pectoralis_major', 'erector_spinae'],
    commonInjuries: ['ìš”í†µ (18-54%)', 'ê³¨í”„ ì—˜ë³´', 'ì†ëª© ë¶€ìƒ'],
    koreanSpecificNotes: [
      'ìŠ¤í¬ë¦°ê³¨í”„ì¥ 8,650ê°œì†Œ: ì¸ì¡° ë§¤íŠ¸ë¡œ ì†ëª©/íŒ”ê¿ˆì¹˜ ì¶©ê²© ì¦ê°€',
      'ë™ì  ì›Œë°ì—…ìœ¼ë¡œ í´ëŸ½í—¤ë“œ ìŠ¤í”¼ë“œ 12.8% í–¥ìƒ',
      'X-Factor ê·¹ëŒ€í™” ì‹œ ìš”ì¶” ì†ìƒ ìœ„í—˜: ê°œì¸ ê°€ë™ë²”ìœ„ ë‚´ ìŠ¤ìœ™',
      'ì‹œë‹ˆì–´(65+): ì›Œë°ì—… 15-20ë¶„, 3/4 ìŠ¤ìœ™ ê¶Œì¥',
    ],
  },

  cycling: {
    warmup: {
      exercises: [
        'leg_swings_front_back',
        'walking_lunges',
        'hip_circles',
        'downward_dog_pedaling',
        'spiderman_stretch_rotation',
      ],
      duration: 7,
      type: 'dynamic',
    },
    cooldown: {
      exercises: [
        'hamstring_stretch_seated',
        'hip_flexor_lunge_stretch',
        'glute_stretch_figure_four',
        'quad_stretch_standing',
        'thoracic_extension_foam_roller',
      ],
      duration: 10,
      type: 'static',
    },
    keyMuscles: ['quadriceps', 'hamstrings', 'gluteus_maximus', 'gastrocnemius', 'iliopsoas'],
    commonInjuries: ['PFPS (35.7%)', 'ìš”í†µ (60%)'],
    koreanSpecificNotes: [
      'ë°”ì´í¬ í”¼íŒ…ì´ ë¶€ìƒ ì˜ˆë°© í•µì‹¬',
      'ë¼ì´ë”© ì „ ì •ì  ìŠ¤íŠ¸ë ˆì¹­ì€ ê·¼ë ¥ ì €í•˜ ê°€ëŠ¥',
    ],
  },

  swimming: {
    warmup: {
      exercises: [
        'arm_circles',
        'cross_body_arm_swings',
        'shoulder_internal_external_rotation',
        'lunge_with_rotation',
        'inchworm',
      ],
      duration: 10,
      type: 'dynamic',
    },
    cooldown: {
      exercises: [
        'doorway_pec_stretch',
        'cross_body_shoulder_stretch',
        'sleeper_stretch',
        'lat_stretch',
        'cat_cow',
      ],
      duration: 10,
      type: 'static',
    },
    keyMuscles: ['latissimus_dorsi', 'pectoralis_major', 'deltoid', 'rotator_cuff'],
    commonInjuries: ['ìˆ˜ì˜ ì–´ê¹¨ (27-87%)', 'í‰ì˜ ë¬´ë¦ (73-86%)'],
    koreanSpecificNotes: [
      'ì–´ê¹¨ ê³¼ì‚¬ìš© ì£¼ì˜ (í•˜ë£¨ 4,000ìŠ¤íŠ¸ë¡œí¬)',
      'ì „ë°© ê´€ì ˆë‚­ ì´ì™„ ì£¼ì˜: ê³¼ì‹ ì „ ê¸ˆì§€',
      'í›„ë°© ê´€ì ˆë‚­ ìŠ¤íŠ¸ë ˆì¹­ì´ ì¶©ëŒ ì˜ˆë°©ì— í•„ìˆ˜',
    ],
  },

  tennis: {
    warmup: {
      exercises: [
        'light_jog_carioca',
        'lateral_lunges',
        'frankenstein_walk',
        'trunk_rotation',
        'arm_circles_shoulder_rolls',
      ],
      duration: 10,
      type: 'dynamic',
    },
    cooldown: {
      exercises: [
        'wrist_extensor_stretch',
        'wrist_flexor_stretch',
        'hamstring_stretch_standing',
        'hip_flexor_lunge_stretch',
        'cross_body_shoulder_stretch',
      ],
      duration: 10,
      type: 'static',
    },
    keyMuscles: ['rotator_cuff', 'deltoid', 'forearm_muscles', 'gluteus_medius'],
    commonInjuries: ['í…Œë‹ˆìŠ¤ ì—˜ë³´ (5%)', 'ì–´ê¹¨ ë¶€ìƒ (11.9%)'],
    koreanSpecificNotes: [
      'ë™ì  ìŠ¤íŠ¸ë ˆì¹­ í›„ ì„œë¸Œ ì†ë„ 1.23% í–¥ìƒ',
      'ì •ì  ìŠ¤íŠ¸ë ˆì¹­ì€ ê²½ê¸° 1ì‹œê°„ ì „ê¹Œì§€ ì™„ë£Œ ë˜ëŠ” ê²½ê¸° í›„',
    ],
  },
};

interface SportProtocolPhase {
  exercises: string[];
  duration: number;  // ë¶„
  type: 'dynamic' | 'static';
}

/**
 * ìŠ¤í¬ì¸ ë³„ ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°© ìƒì„±
 */
export function prescribeSportStretching(
  sport: SportType,
  phase: 'warmup' | 'cooldown',
  userProfile: StretchingUserProfile
): StretchingPrescription {
  const protocol = SPORT_PROTOCOLS[sport];
  const phaseProtocol = protocol[phase];
  const warnings: string[] = [];

  // 1. í”„ë¡œí† ì½œ ìš´ë™ ì¡°íšŒ
  const exercises = phaseProtocol.exercises
    .map(id => EXERCISE_DATABASE.find(e => e.id === id))
    .filter((e): e is StretchExercise => e !== undefined);

  // 2. ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§
  const filteredExercises = filterContraindications(
    exercises,
    userProfile.contraindications,
    userProfile.specialConditions
  );

  // 3. ì¥ë¹„ í•„í„°ë§
  const availableExercises = filterByEquipment(
    filteredExercises,
    userProfile.availableEquipment
  );

  // 4. í•œêµ­ íŠ¹í™” ì£¼ì˜ì‚¬í•­ ì¶”ê°€
  if (protocol.koreanSpecificNotes.length > 0) {
    warnings.push(...protocol.koreanSpecificNotes.slice(0, 2));
  }

  // 5. ì—°ë ¹ë³„ ì¡°ì •
  if (userProfile.age >= 60 && sport === 'hiking') {
    warnings.push('ê³ ë ¹ ë“±ì‚°ê°: ë™ì‘ ê°•ë„ë¥¼ ë‚®ì¶”ê³  ì§€ì§€ëŒ€ë¥¼ í™œìš©í•˜ì„¸ìš”.');
  }

  // 6. ì²˜ë°© ìƒì„±
  const prescribedStretches = availableExercises.map((exercise, index) => ({
    exercise,
    order: index + 1,
    adjustedDuration: phaseProtocol.type === 'dynamic'
      ? exercise.defaultDuration
      : adjustDurationForAge(exercise.defaultDuration, userProfile.age, exercise.durationUnit),
    adjustedSets: exercise.sets,
  }));

  return {
    prescriptionId: `sport_${sport}_${phase}_${Date.now()}`,
    createdAt: new Date().toISOString(),
    basedOn: {
      sport,
      purpose: phase === 'warmup' ? 'warmup' : 'cooldown',
    },
    stretches: prescribedStretches,
    totalDuration: phaseProtocol.duration,
    frequency: 'ìš´ë™ ì „í›„ ë§¤ë²ˆ',
    warnings,
    medicalDisclaimer: SPORT_MEDICAL_DISCLAIMER,
  };
}

const SPORT_MEDICAL_DISCLAIMER = `
ì´ ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œì€ ìŠ¤í¬ì¸  ê³¼í•™ ì—°êµ¬ì— ê¸°ë°˜í•œ ì¼ë°˜ì ì¸ ê°€ì´ë“œì…ë‹ˆë‹¤.

ì£¼ì˜ì‚¬í•­:
â€¢ ìš´ë™ ì „ ë™ì  ìŠ¤íŠ¸ë ˆì¹­, ìš´ë™ í›„ ì •ì  ìŠ¤íŠ¸ë ˆì¹­ ê¶Œì¥
â€¢ 60ì´ˆ ì´ìƒ ì •ì  ìŠ¤íŠ¸ë ˆì¹­ í›„ ì¦‰ì‹œ ê³ ê°•ë„ ìš´ë™ í”¼í•˜ê¸°
â€¢ í†µì¦ ë°œìƒ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨

ê¸°ì¡´ ë¶€ìƒì´ë‚˜ ê±´ê°• ë¬¸ì œê°€ ìˆëŠ” ê²½ìš° ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì„¸ìš”.
`.trim();
```

### 2.3 PNF ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ

```typescript
// lib/stretching/pnf-protocol.ts

/**
 * PNF ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ (W-2-FOUNDATION ê¸°ë°˜)
 *
 * PNF = Proprioceptive Neuromuscular Facilitation
 * ê°€ì¥ íš¨ê³¼ì ì¸ ìœ ì—°ì„± í–¥ìƒ ê¸°ë²• (Sharman et al., 2006)
 */

export interface PNFProtocol {
  technique: 'hold_relax' | 'contract_relax' | 'crac';
  contractDuration: number;       // ë“±ì²™ì„± ìˆ˜ì¶• ì‹œê°„ (ì´ˆ)
  relaxDuration: number;          // ì´ì™„ ì‹œê°„ (ì´ˆ)
  stretchDuration: number;        // ì‹ ì¥ ì‹œê°„ (ì´ˆ)
  contractionIntensity: number;   // ìµœëŒ€ ìˆ˜ì¶•ì˜ % (20-75%)
  repetitions: number;            // ë°˜ë³µ íšŸìˆ˜
}

/**
 * í‘œì¤€ PNF í”„ë¡œí† ì½œ
 */
export const STANDARD_PNF_PROTOCOLS: Record<string, PNFProtocol> = {
  // Hold-Relax (Contract-Relax): ê¸°ë³¸ ê¸°ë²•
  hold_relax: {
    technique: 'hold_relax',
    contractDuration: 6,          // 6ì´ˆ ë“±ì²™ì„± ìˆ˜ì¶•
    relaxDuration: 3,             // 2-3ì´ˆ ì´ì™„
    stretchDuration: 30,          // 10-30ì´ˆ ì¶”ê°€ ì‹ ì¥
    contractionIntensity: 50,     // 50% ê°•ë„
    repetitions: 3,               // 2-4íšŒ ë°˜ë³µ
  },

  // CRAC: ê°€ì¥ íš¨ê³¼ì  (ìƒí˜¸ì–µì œ í™œìš©)
  crac: {
    technique: 'crac',
    contractDuration: 6,
    relaxDuration: 2,
    stretchDuration: 30,
    contractionIntensity: 50,
    repetitions: 3,
  },

  // ê³ ë ¹ììš© (ë³´ìˆ˜ì )
  senior: {
    technique: 'hold_relax',
    contractDuration: 4,          // ì§§ì€ ìˆ˜ì¶•
    relaxDuration: 3,
    stretchDuration: 45,          // ê¸´ ì‹ ì¥
    contractionIntensity: 30,     // ë‚®ì€ ê°•ë„
    repetitions: 2,
  },
};

/**
 * PNF ìŠ¤íŠ¸ë ˆì¹­ ê°€ì´ë“œ ìƒì„±
 */
export interface PNFGuide {
  muscleGroup: MuscleGroup;
  protocol: PNFProtocol;
  steps: PNFStep[];
  partnerRequired: boolean;
  alternativeWithoutPartner?: string;
  contraindications: string[];
}

export interface PNFStep {
  phase: 'stretch' | 'contract' | 'relax' | 'agonist_contract';
  instruction: string;
  duration: number;
  breathingCue: string;
}

/**
 * í–„ìŠ¤íŠ¸ë§ PNF ìŠ¤íŠ¸ë ˆì¹­ ì˜ˆì‹œ
 */
export const HAMSTRING_PNF_GUIDE: PNFGuide = {
  muscleGroup: 'hamstrings',
  protocol: STANDARD_PNF_PROTOCOLS.hold_relax,
  steps: [
    {
      phase: 'stretch',
      instruction: 'ëˆ„ìš´ ìƒíƒœì—ì„œ í•œìª½ ë‹¤ë¦¬ë¥¼ ë“¤ì–´ì˜¬ë ¤ í–„ìŠ¤íŠ¸ë§ì´ ë‹¹ê¸°ëŠ” ëŠë‚Œì´ ë“¤ ë•Œê¹Œì§€ ì‹ ì¥í•©ë‹ˆë‹¤.',
      duration: 10,
      breathingCue: 'ê¹Šê²Œ ë“¤ì´ì‰¬ì„¸ìš”',
    },
    {
      phase: 'contract',
      instruction: 'íŒŒíŠ¸ë„ˆì˜ ì†ì´ë‚˜ ìˆ˜ê±´ì„ ì´ìš©í•´ ë‹¤ë¦¬ë¥¼ ì•„ë˜ë¡œ ë°€ì–´ë³´ì„¸ìš” (50% í˜). ë‹¤ë¦¬ëŠ” ì›€ì§ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.',
      duration: 6,
      breathingCue: 'ìˆ¨ì„ ì°¸ì§€ ë§ˆì„¸ìš”, ì²œì²œíˆ ë‚´ì‰¬ì„¸ìš”',
    },
    {
      phase: 'relax',
      instruction: 'í˜ì„ ì™„ì „íˆ ë¹¼ê³  ì´ì™„í•˜ì„¸ìš”.',
      duration: 3,
      breathingCue: 'ê¹Šê²Œ ë“¤ì´ì‰¬ì„¸ìš”',
    },
    {
      phase: 'stretch',
      instruction: 'ë‹¤ë¦¬ë¥¼ ë” ë†’ì´ ì˜¬ë ¤ ìƒˆë¡œìš´ ë²”ìœ„ê¹Œì§€ ì‹ ì¥í•©ë‹ˆë‹¤.',
      duration: 30,
      breathingCue: 'ì²œì²œíˆ í˜¸í¡í•˜ë©° ìœ ì§€í•˜ì„¸ìš”',
    },
  ],
  partnerRequired: true,
  alternativeWithoutPartner: 'ìˆ˜ê±´ì´ë‚˜ ì €í•­ë°´ë“œë¥¼ ë°œì— ê±¸ì–´ ìŠ¤ìŠ¤ë¡œ ì €í•­ ì œê³µ',
  contraindications: ['ê¸‰ì„± í–„ìŠ¤íŠ¸ë§ ì†ìƒ', 'ì¢Œê³¨ì‹ ê²½í†µ ê¸‰ì„±ê¸°'],
};

/**
 * PNF ì ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
 * - ìš´ë™ í›„ì—ë§Œ ì ìš©
 * - ê²½í—˜ì ëŒ€ìƒ
 * - ê³ ë ¹ì ì£¼ì˜
 */
export function canApplyPNF(
  userProfile: StretchingUserProfile,
  context: 'warmup' | 'cooldown' | 'flexibility_session'
): { allowed: boolean; reason?: string; protocol?: PNFProtocol } {
  // ìš´ë™ ì „(ì›Œë°ì—…) PNF ê¸ˆì§€
  if (context === 'warmup') {
    return {
      allowed: false,
      reason: 'PNFëŠ” ìš´ë™ ì „ ìˆ˜í–‰ ì‹œ í¼í¬ë¨¼ìŠ¤ 4.4% ì €í•˜ ê°€ëŠ¥. ìš´ë™ í›„ ìˆ˜í–‰í•˜ì„¸ìš”.',
    };
  }

  // ì´ˆë³´ì ì œì™¸
  if (userProfile.stretchingExperience === 'none') {
    return {
      allowed: false,
      reason: 'PNFëŠ” ìŠ¤íŠ¸ë ˆì¹­ ê²½í—˜ìì—ê²Œ ê¶Œì¥ë©ë‹ˆë‹¤. ì •ì  ìŠ¤íŠ¸ë ˆì¹­ë¶€í„° ì‹œì‘í•˜ì„¸ìš”.',
    };
  }

  // ê³ ë ¹ì ì£¼ì˜
  if (userProfile.age >= 65) {
    return {
      allowed: true,
      reason: 'ê³ ë ¹ììš© ë³´ìˆ˜ì  í”„ë¡œí† ì½œì„ ì ìš©í•©ë‹ˆë‹¤.',
      protocol: STANDARD_PNF_PROTOCOLS.senior,
    };
  }

  return {
    allowed: true,
    protocol: STANDARD_PNF_PROTOCOLS.hold_relax,
  };
}
```

### 2.4 ì£¼ê°„ ë£¨í‹´ ìƒì„±

```typescript
// lib/stretching/weekly-planner.ts

import {
  PostureAnalysisResult,
  StretchingUserProfile,
  WeeklyStretchingPlan,
  DailyRoutine,
  PrescribedStretch,
} from './types';
import { prescribePostureStretching } from './posture-prescription';

/**
 * ìì„¸ ë¶ˆê· í˜• ê¸°ë°˜ ì£¼ê°„ ìŠ¤íŠ¸ë ˆì¹­ í”Œëœ ìƒì„±
 */
export function generateWeeklyPlan(
  postureResult: PostureAnalysisResult,
  userProfile: StretchingUserProfile,
  weekNumber: number = 1
): WeeklyStretchingPlan {
  const prescription = prescribePostureStretching(postureResult, userProfile);

  // ì‹¬ê°ë„ì— ë”°ë¥¸ ë¹ˆë„ ê²°ì •
  const isSevere = postureResult.imbalances.some(i => i.severity === 'severe');

  // ì£¼ì°¨ë³„ ì§„í–‰ (NASM êµì • ìš´ë™ ì—°ì†ì²´ ê¸°ë°˜)
  const phase = getProgressionPhase(weekNumber);

  if (isSevere) {
    // ì‹¬ê°: ë§¤ì¼ ìŠ¤íŠ¸ë ˆì¹­, ê²©ì¼ ê°•í™”
    return {
      planId: `plan_${Date.now()}`,
      userId: userProfile.userId,
      weekStartDate: getNextMonday().toISOString().split('T')[0],
      days: {
        monday: createStretchDay(prescription, phase),
        tuesday: createStrengthenDay(prescription, phase),
        wednesday: createStretchDay(prescription, phase),
        thursday: createStrengthenDay(prescription, phase),
        friday: createStretchDay(prescription, phase),
        saturday: createStrengthenDay(prescription, phase),
        sunday: createRestDay(),
      },
      progressionWeek: weekNumber,
    };
  }

  // ê²½ë¯¸~ì¤‘ë“±ë„: ê²©ì¼ ìŠ¤íŠ¸ë ˆì¹­, ì£¼ 3íšŒ ê°•í™”
  return {
    planId: `plan_${Date.now()}`,
    userId: userProfile.userId,
    weekStartDate: getNextMonday().toISOString().split('T')[0],
    days: {
      monday: createStretchDay(prescription, phase),
      tuesday: createStrengthenDay(prescription, phase),
      wednesday: createActiveRecoveryDay(prescription),
      thursday: createStrengthenDay(prescription, phase),
      friday: createStretchDay(prescription, phase),
      saturday: createStrengthenDay(prescription, phase),
      sunday: createRestDay(),
    },
    progressionWeek: weekNumber,
  };
}

type ProgressionPhase = 'inhibit_lengthen' | 'activate' | 'integrate';

function getProgressionPhase(weekNumber: number): ProgressionPhase {
  if (weekNumber <= 2) return 'inhibit_lengthen';  // 1-2ì£¼: ì–µì œ + ì‹ ì¥
  if (weekNumber <= 4) return 'activate';          // 3-4ì£¼: í™œì„±í™”
  return 'integrate';                               // 5ì£¼+: í†µí•©
}

function createStretchDay(
  prescription: StretchingPrescription,
  phase: ProgressionPhase
): DailyRoutine {
  const stretches = [...prescription.stretches];

  // 1-2ì£¼: ìŠ¤íŠ¸ë ˆì¹­ë§Œ
  if (phase === 'inhibit_lengthen') {
    return {
      type: 'stretch',
      stretches,
      duration: 20,
      notes: 'ìŠ¤íŠ¸ë ˆì¹­ ì§‘ì¤‘ (30ì´ˆ x 2-3ì„¸íŠ¸)',
    };
  }

  // 3ì£¼+: í™œì„±í™” í¬í•¨
  const activations = prescription.activations || [];
  return {
    type: 'stretch',
    stretches: [...stretches, ...activations],
    duration: 25,
    notes: 'ìŠ¤íŠ¸ë ˆì¹­ + í™œì„±í™”',
  };
}

function createStrengthenDay(
  prescription: StretchingPrescription,
  phase: ProgressionPhase
): DailyRoutine {
  // 1-2ì£¼: ìŠ¤íŠ¸ë ˆì¹­ë§Œ (ê°•í™” ì—†ìŒ)
  if (phase === 'inhibit_lengthen') {
    return {
      type: 'stretch',
      stretches: prescription.stretches.slice(0, 5),
      duration: 15,
      notes: 'ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­ (ê°•í™”ëŠ” 3ì£¼ì°¨ë¶€í„°)',
    };
  }

  // 3ì£¼+: ìŠ¤íŠ¸ë ˆì¹­ + ê°•í™”
  return {
    type: 'strengthen',
    stretches: prescription.stretches,
    duration: 30,
    notes: 'ìŠ¤íŠ¸ë ˆì¹­ í›„ ì•½í™” ê·¼ìœ¡ ê°•í™” (10-15íšŒ x 3ì„¸íŠ¸)',
  };
}

function createActiveRecoveryDay(
  prescription: StretchingPrescription
): DailyRoutine {
  return {
    type: 'active_recovery',
    stretches: prescription.stretches.slice(0, 3),
    duration: 10,
    notes: 'ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­ë§Œ (íšŒë³µì¼)',
  };
}

function createRestDay(): DailyRoutine {
  return {
    type: 'rest',
    stretches: [],
    duration: 0,
    notes: 'ì™„ì „ íœ´ì‹ ë˜ëŠ” ê°€ë²¼ìš´ ê±·ê¸°',
  };
}

function getNextMonday(): Date {
  const today = new Date();
  const dayOfWeek = today.getDay();
  const daysUntilMonday = dayOfWeek === 0 ? 1 : 8 - dayOfWeek;
  const nextMonday = new Date(today);
  nextMonday.setDate(today.getDate() + daysUntilMonday);
  return nextMonday;
}
```

---

## 2.6 C-2 Janda Cross Syndrome í†µí•©

> C-2 ì²´í˜•ë¶„ì„ ëª¨ë“ˆê³¼ W-2 ìŠ¤íŠ¸ë ˆì¹­ ëª¨ë“ˆì˜ ë°ì´í„° ì—°ë™ ëª…ì„¸

### 2.6.1 C-2 â†’ W-2 ë°ì´í„° ë³€í™˜

```typescript
// lib/stretching/c2-integration.ts

import {
  UpperCrossSyndrome,
  LowerCrossSyndrome,
  JandaCrossAnalysis,
} from '@/lib/analysis/body/posture/janda-cross';
import { StretchingPrescription, PostureImbalanceType } from './types';

/**
 * C-2 Janda ë¶„ì„ ê²°ê³¼ë¥¼ W-2 ìŠ¤íŠ¸ë ˆì¹­ ì…ë ¥ìœ¼ë¡œ ë³€í™˜
 */
export interface C2ToW2IntegrationData {
  source: {
    moduleId: 'C-2';
    analysisId: string;
    analyzedAt: string;
    confidence: number;
  };
  jandaResults: {
    upperCross: UpperCrossSyndromeData;
    lowerCross: LowerCrossSyndromeData;
    combinedSeverity: 'none' | 'mild' | 'moderate' | 'severe';
  };
  stretchingRecommendations: {
    priorityMuscles: string[];
    stretchingProtocol: string;
    estimatedDuration: number;
  };
}

/**
 * UCS ë°ì´í„° (ìƒë¶€êµì°¨ì¦í›„êµ°)
 */
export interface UpperCrossSyndromeData {
  isPresent: boolean;
  severity: 'none' | 'mild' | 'moderate' | 'severe';
  tightMuscles: {
    pectoralisMajor: boolean;      // ëŒ€í‰ê·¼
    pectoralisMinor: boolean;      // ì†Œí‰ê·¼
    upperTrapezius: boolean;       // ìƒë¶€ ìŠ¹ëª¨ê·¼
    levatorScapulae: boolean;      // ê²¬ê°‘ê±°ê·¼
    sternocleidomastoid: boolean;  // í‰ì‡„ìœ ëŒê·¼
    suboccipitals: boolean;        // í›„ë‘í•˜ê·¼
  };
  weakMuscles: {
    deepCervicalFlexors: boolean;  // ì‹¬ë¶€ ê²½ì¶” êµ´ê³¡ê·¼
    middleLowerTrapezius: boolean; // ì¤‘/í•˜ë¶€ ìŠ¹ëª¨ê·¼
    rhomboids: boolean;            // ëŠ¥í˜•ê·¼
    serratusAnterior: boolean;     // ì „ê±°ê·¼
  };
  associatedPostures: ('forward_head' | 'rounded_shoulders' | 'thoracic_kyphosis')[];
}

/**
 * LCS ë°ì´í„° (í•˜ë¶€êµì°¨ì¦í›„êµ°)
 */
export interface LowerCrossSyndromeData {
  isPresent: boolean;
  severity: 'none' | 'mild' | 'moderate' | 'severe';
  tightMuscles: {
    iliopsoas: boolean;            // ì¥ìš”ê·¼
    rectusFemoris: boolean;        // ëŒ€í‡´ì§ê·¼
    tensorFasciaeLatae: boolean;   // ëŒ€í‡´ê·¼ë§‰ì¥ê·¼
    erectorSpinae: boolean;        // ì²™ì¶”ê¸°ë¦½ê·¼ (ìš”ë¶€)
    quadratusLumborum: boolean;    // ìš”ë°©í˜•ê·¼
  };
  weakMuscles: {
    gluteusMaximus: boolean;       // ëŒ€ë‘”ê·¼
    gluteusMedius: boolean;        // ì¤‘ë‘”ê·¼
    rectusAbdominis: boolean;      // ë³µì§ê·¼
    transverseAbdominis: boolean;  // ë³µíš¡ê·¼
    obliques: boolean;             // ë³µì‚¬ê·¼
  };
  associatedPostures: ('anterior_pelvic_tilt' | 'lumbar_hyperlordosis' | 'hip_flexor_tightness')[];
}
```

### 2.6.2 UCS â†’ ìŠ¤íŠ¸ë ˆì¹­ ë§¤í•‘

```typescript
// lib/stretching/c2-integration.ts (ê³„ì†)

/**
 * UCS ì‹¬ê°ë„ë³„ ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ ë§¤í•‘
 */
export const UCS_STRETCHING_MAP: Record<UpperCrossSyndromeData['severity'], {
  stretches: string[];
  activations: string[];
  frequency: string;
  duration: number;
  priority: 'low' | 'medium' | 'high' | 'urgent';
}> = {
  none: {
    stretches: [],
    activations: [],
    frequency: 'ìœ ì§€ ëª©ì  ì£¼ 1-2íšŒ',
    duration: 10,
    priority: 'low',
  },
  mild: {
    stretches: [
      'chest_doorway_stretch',      // ëŒ€í‰ê·¼
      'upper_trap_stretch',         // ìƒë¶€ ìŠ¹ëª¨ê·¼
      'neck_rotation',              // ëª© íšŒì „
    ],
    activations: [
      'chin_tucks',                 // í„± ë‹¹ê¸°ê¸°
      'wall_angels',                // ì›” ì—”ì ¤
    ],
    frequency: 'ì£¼ 3-4íšŒ',
    duration: 15,
    priority: 'medium',
  },
  moderate: {
    stretches: [
      'chest_doorway_stretch',
      'pec_minor_corner_stretch',   // ì†Œí‰ê·¼
      'upper_trap_stretch',
      'levator_scapulae_stretch',   // ê²¬ê°‘ê±°ê·¼
      'suboccipital_release',       // í›„ë‘í•˜ê·¼
      'sternocleidomastoid_stretch',// í‰ì‡„ìœ ëŒê·¼
    ],
    activations: [
      'chin_tucks',
      'wall_angels',
      'prone_y_raise',              // Yì ë“¤ê¸°
      'band_pull_apart',            // ë°´ë“œ í’€ ì–´íŒŒíŠ¸
    ],
    frequency: 'ì£¼ 5-6íšŒ',
    duration: 25,
    priority: 'high',
  },
  severe: {
    stretches: [
      'chest_doorway_stretch',
      'pec_minor_corner_stretch',
      'upper_trap_stretch',
      'levator_scapulae_stretch',
      'suboccipital_release',
      'sternocleidomastoid_stretch',
      'scalene_stretch',            // ì‚¬ê°ê·¼
      'thoracic_extension_foam_roller', // í‰ì¶” ì‹ ì „
    ],
    activations: [
      'chin_tucks',
      'wall_angels',
      'prone_y_raise',
      'prone_t_raise',
      'prone_w_raise',
      'band_pull_apart',
      'face_pulls',                 // í˜ì´ìŠ¤ í’€
    ],
    frequency: 'ë§¤ì¼ (ì „ë¬¸ê°€ ìƒë‹´ ê¶Œì¥)',
    duration: 35,
    priority: 'urgent',
  },
};
```

### 2.6.3 LCS â†’ ìŠ¤íŠ¸ë ˆì¹­ ë§¤í•‘

```typescript
/**
 * LCS ì‹¬ê°ë„ë³„ ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ ë§¤í•‘
 */
export const LCS_STRETCHING_MAP: Record<LowerCrossSyndromeData['severity'], {
  stretches: string[];
  activations: string[];
  frequency: string;
  duration: number;
  priority: 'low' | 'medium' | 'high' | 'urgent';
}> = {
  none: {
    stretches: [],
    activations: [],
    frequency: 'ìœ ì§€ ëª©ì  ì£¼ 1-2íšŒ',
    duration: 10,
    priority: 'low',
  },
  mild: {
    stretches: [
      'hip_flexor_lunge_stretch',   // ì¥ìš”ê·¼
      'quad_stretch_standing',       // ëŒ€í‡´ì‚¬ë‘ê·¼
      'cat_cow',                     // ìº£-ì¹´ìš°
    ],
    activations: [
      'glute_bridge',               // ê¸€ë£¨íŠ¸ ë¸Œë¦¿ì§€
      'dead_bug',                   // ë°ë“œ ë²„ê·¸
    ],
    frequency: 'ì£¼ 3-4íšŒ',
    duration: 15,
    priority: 'medium',
  },
  moderate: {
    stretches: [
      'hip_flexor_lunge_stretch',
      'hip_flexor_couch_stretch',   // ì¹´ìš°ì¹˜ ìŠ¤íŠ¸ë ˆì¹­
      'quad_stretch_standing',
      'tfl_stretch',                // TFL ìŠ¤íŠ¸ë ˆì¹­
      'lower_back_cat_cow',
      'piriformis_stretch',         // ì´ìƒê·¼
    ],
    activations: [
      'glute_bridge',
      'single_leg_glute_bridge',    // ì‹±ê¸€ ë ˆê·¸
      'dead_bug',
      'bird_dog',                   // ë²„ë“œë…
      'clamshell',                  // í´ë¨ì‰˜
    ],
    frequency: 'ì£¼ 5-6íšŒ',
    duration: 25,
    priority: 'high',
  },
  severe: {
    stretches: [
      'hip_flexor_lunge_stretch',
      'hip_flexor_couch_stretch',
      'quad_stretch_standing',
      'tfl_stretch',
      'lower_back_cat_cow',
      'piriformis_stretch',
      'quadratus_lumborum_stretch', // ìš”ë°©í˜•ê·¼
      'psoas_release_ball',         // ì¥ìš”ê·¼ ë¦´ë¦¬ì¦ˆ
    ],
    activations: [
      'glute_bridge',
      'single_leg_glute_bridge',
      'hip_thrust',                 // í™ ìŠ¤ëŸ¬ìŠ¤íŠ¸
      'dead_bug',
      'bird_dog',
      'clamshell',
      'plank',                      // í”Œë­í¬
      'side_plank',                 // ì‚¬ì´ë“œ í”Œë­í¬
    ],
    frequency: 'ë§¤ì¼ (ì „ë¬¸ê°€ ìƒë‹´ ê¶Œì¥)',
    duration: 40,
    priority: 'urgent',
  },
};
```

### 2.6.4 í†µí•© ì²˜ë°© ìƒì„± í•¨ìˆ˜

```typescript
/**
 * C-2 ë¶„ì„ ê²°ê³¼ë¡œë¶€í„° W-2 ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°© ìƒì„±
 */
export function createPrescriptionFromC2(
  integrationData: C2ToW2IntegrationData,
  userProfile: StretchingUserProfile
): StretchingPrescription {
  const { upperCross, lowerCross, combinedSeverity } = integrationData.jandaResults;

  // 1. UCS/LCS ë§¤í•‘ ì¡°íšŒ
  const ucsProtocol = UCS_STRETCHING_MAP[upperCross.severity];
  const lcsProtocol = LCS_STRETCHING_MAP[lowerCross.severity];

  // 2. ìš´ë™ ID í•©ì¹˜ê¸° (ì¤‘ë³µ ì œê±°)
  const allStretchIds = [...new Set([
    ...ucsProtocol.stretches,
    ...lcsProtocol.stretches,
  ])];

  const allActivationIds = [...new Set([
    ...ucsProtocol.activations,
    ...lcsProtocol.activations,
  ])];

  // 3. ìš´ë™ DBì—ì„œ ì¡°íšŒ
  const stretches = EXERCISE_DATABASE.filter(e => allStretchIds.includes(e.id));
  const activations = EXERCISE_DATABASE.filter(e => allActivationIds.includes(e.id));

  // 4. ê¸ˆê¸°ì‚¬í•­/ì¥ë¹„ í•„í„°ë§
  const filteredStretches = filterForUserProfile(stretches, userProfile);
  const filteredActivations = filterForUserProfile(activations, userProfile);

  // 5. ìš°ì„ ìˆœìœ„ ì •ë ¬ (UCS ë¨¼ì €, ê·¸ ë‹¤ìŒ LCS)
  const sortedStretches = sortByPriority(
    filteredStretches,
    upperCross.isPresent ? 'upper' : 'lower'
  );

  // 6. ê²½ê³  ìƒì„±
  const warnings = generateJandaWarnings(upperCross, lowerCross, combinedSeverity);

  // 7. ì²˜ë°© ìƒì„±
  return {
    prescriptionId: `janda_${integrationData.source.analysisId}_${Date.now()}`,
    createdAt: new Date().toISOString(),
    basedOn: {
      postureAnalysis: integrationData.source.analysisId,
      purpose: 'posture_correction',
      jandaIntegration: {
        ucsPresent: upperCross.isPresent,
        ucsSeverity: upperCross.severity,
        lcsPresent: lowerCross.isPresent,
        lcsSeverity: lowerCross.severity,
      },
    },
    stretches: sortedStretches.map((exercise, index) => ({
      exercise,
      order: index + 1,
      adjustedDuration: adjustDurationForAge(
        exercise.defaultDuration,
        userProfile.age,
        exercise.durationUnit
      ),
      adjustedSets: exercise.sets,
    })),
    activations: filteredActivations.map((exercise, index) => ({
      exercise,
      order: index + 1,
      adjustedDuration: exercise.defaultDuration,
      adjustedSets: exercise.sets,
    })),
    totalDuration: ucsProtocol.duration + lcsProtocol.duration,
    frequency: combinedSeverity === 'severe' ? 'ë§¤ì¼' : 'ì£¼ 5-6íšŒ',
    warnings,
    medicalDisclaimer: JANDA_MEDICAL_DISCLAIMER,
    professionalReferral: combinedSeverity === 'severe',
  };
}

/**
 * Janda ë¶„ì„ ê¸°ë°˜ ê²½ê³  ìƒì„±
 */
function generateJandaWarnings(
  ucs: UpperCrossSyndromeData,
  lcs: LowerCrossSyndromeData,
  combinedSeverity: string
): string[] {
  const warnings: string[] = [];

  if (ucs.severity === 'severe') {
    warnings.push('âš ï¸ ì‹¬ê°í•œ ìƒë¶€êµì°¨ì¦í›„êµ°: ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ìƒë‹´ ê¶Œì¥');
    if (ucs.associatedPostures.includes('forward_head')) {
      warnings.push('âš ï¸ CVA ë‚®ìŒ: ê²½ì¶” ì „ë¬¸ê°€ í‰ê°€ í•„ìš”');
    }
  }

  if (lcs.severity === 'severe') {
    warnings.push('âš ï¸ ì‹¬ê°í•œ í•˜ë¶€êµì°¨ì¦í›„êµ°: ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ìƒë‹´ ê¶Œì¥');
    if (lcs.associatedPostures.includes('lumbar_hyperlordosis')) {
      warnings.push('âš ï¸ ìš”ì¶” ê³¼ì „ë§Œ: ìš”í†µ ìœ„í—˜ ì¦ê°€');
    }
  }

  if (ucs.isPresent && lcs.isPresent) {
    warnings.push('ğŸ“‹ ìƒë¶€+í•˜ë¶€ ë³µí•© ë¶ˆê· í˜•: ì „ì‹  êµì • í”„ë¡œí† ì½œ ì ìš©');
  }

  if (combinedSeverity === 'severe') {
    warnings.push('ğŸ¥ ìš´ë™ ì¤‘ í†µì¦ ë°œìƒ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³  ì „ë¬¸ì˜ ìƒë‹´');
  }

  return warnings;
}

const JANDA_MEDICAL_DISCLAIMER = `
ë³¸ ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°©ì€ Janda Cross Syndrome ë¶„ì„ ê¸°ë°˜ì˜ ì¼ë°˜ì  ê°€ì´ë“œì…ë‹ˆë‹¤.

â€¢ ì‹¬ê°í•œ ë¶ˆê· í˜•ì€ ì „ë¬¸ ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
â€¢ AI ë¶„ì„ì€ ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì§„ë‹¨ì€ ì „ë¬¸ê°€ì—ê²Œ ë°›ìœ¼ì„¸ìš”.
â€¢ í†µì¦ ë°œìƒ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ì„¸ìš”.
â€¢ ì‹ ê²½í•™ì  ì¦ìƒ(ì €ë¦¼, ë°©ì‚¬í†µ) ë°œìƒ ì‹œ ì˜ë£Œê¸°ê´€ ë°©ë¬¸í•˜ì„¸ìš”.
`.trim();
```

### 2.6.5 API ì—°ë™ ì—”ë“œí¬ì¸íŠ¸

```typescript
// app/api/v2/stretching/prescribe/janda/route.ts

import { NextRequest, NextResponse } from 'next/server';
import { auth } from '@clerk/nextjs/server';
import { z } from 'zod';
import { createClerkSupabaseClientSsr } from '@/lib/supabase/server';
import { createPrescriptionFromC2 } from '@/lib/stretching/c2-integration';
import { convertC2ToW2Data, analyzeJandaCross } from '@/lib/analysis/body/posture/janda-cross';

const requestSchema = z.object({
  bodyAnalysisId: z.string().uuid(),
  options: z.object({
    maxExercises: z.number().min(5).max(15).optional().default(10),
    includeActivations: z.boolean().optional().default(true),
  }).optional(),
});

/**
 * POST /api/v2/stretching/prescribe/janda
 * C-2 Janda ë¶„ì„ ê²°ê³¼ ê¸°ë°˜ ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°©
 */
export async function POST(request: NextRequest) {
  try {
    const { userId } = await auth();
    if (!userId) {
      return NextResponse.json(
        { error: 'AUTH_ERROR', message: 'ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.' },
        { status: 401 }
      );
    }

    const body = await request.json();
    const validated = requestSchema.safeParse(body);
    if (!validated.success) {
      return NextResponse.json(
        { error: 'VALIDATION_ERROR', message: validated.error.message },
        { status: 400 }
      );
    }

    const supabase = await createClerkSupabaseClientSsr();

    // 1. C-2 ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
    const { data: bodyAnalysis, error: fetchError } = await supabase
      .from('body_assessments')
      .select('*')
      .eq('id', validated.data.bodyAnalysisId)
      .eq('clerk_user_id', userId)
      .single();

    if (fetchError || !bodyAnalysis) {
      return NextResponse.json(
        { error: 'NOT_FOUND', message: 'ì²´í˜• ë¶„ì„ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' },
        { status: 404 }
      );
    }

    // 2. Janda ë¶„ì„ ìˆ˜í–‰ (ì´ë¯¸ ì €ì¥ëœ ë°ì´í„° ì‚¬ìš© ë˜ëŠ” ì¬ê³„ì‚°)
    const jandaAnalysis = bodyAnalysis.janda_analysis ||
      analyzeJandaCross(bodyAnalysis.posture_data);

    // 3. W-2 ë°ì´í„° ë³€í™˜
    const integrationData = convertC2ToW2Data(bodyAnalysis, jandaAnalysis);

    // 4. ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ
    const { data: userProfile } = await supabase
      .from('stretching_user_profiles')
      .select('*')
      .eq('clerk_user_id', userId)
      .single();

    // 5. ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°© ìƒì„±
    const prescription = createPrescriptionFromC2(
      integrationData,
      userProfile || getDefaultUserProfile(userId)
    );

    // 6. ì²˜ë°© ì €ì¥
    await supabase.from('stretching_prescriptions').insert({
      clerk_user_id: userId,
      prescription_type: 'janda',
      source_analysis_id: validated.data.bodyAnalysisId,
      prescription_data: prescription,
      janda_integration: integrationData.jandaResults,
    });

    return NextResponse.json({
      success: true,
      data: {
        prescription,
        jandaAnalysis: {
          upperCross: integrationData.jandaResults.upperCross,
          lowerCross: integrationData.jandaResults.lowerCross,
          combinedSeverity: integrationData.jandaResults.combinedSeverity,
        },
      },
    });
  } catch (error) {
    console.error('[W-2] Janda prescription error:', error);
    return NextResponse.json(
      { error: 'INTERNAL_ERROR', message: 'ì²˜ë°© ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' },
      { status: 500 }
    );
  }
}
```

---

## 2.7 ì²´í˜•ë³„ ìŠ¤íŠ¸ë ˆì¹­ ì¶”ì²œ ë§¤í•‘

> C-2 ì²´í˜•ë¶„ì„ ê²°ê³¼ì˜ SHR(Shoulder-to-Hip Ratio) ê¸°ë°˜ ì²´í˜• ë¶„ë¥˜ë³„ ìŠ¤íŠ¸ë ˆì¹­ ì¶”ì²œ

### 2.7.1 SHR ê¸°ë°˜ ì²´í˜• ë¶„ë¥˜ (body-mechanics.md ì°¸ì¡°)

| SHR ë²”ìœ„ | ì²´í˜• ë¶„ë¥˜ | íŠ¹ì§• | ìŠ¤íŠ¸ë ˆì¹­ ëª©í‘œ |
|----------|----------|------|-------------|
| > 1.1 | **ì—­ì‚¼ê°í˜•** | ì–´ê¹¨ ë„“ê³  ì—‰ë©ì´ ì¢ìŒ | ìƒì²´ ìœ ì—°ì„±, ì–´ê¹¨ ê· í˜• |
| 0.9 ~ 1.1 | **ê· í˜•í˜•** | ì–´ê¹¨-ì—‰ë©ì´ ë¹„ìœ¨ ì ì • | ì „ì‹  ë°¸ëŸ°ìŠ¤ ìœ ì§€ |
| < 0.9 | **ì‚¼ê°í˜•/ë°°í˜•** | ì—‰ë©ì´ ë„“ê³  ì–´ê¹¨ ì¢ìŒ | í•˜ì²´ ìŠ¤íŠ¸ë ˆì¹­, ìƒì²´ ê°•í™” |

### 2.7.2 ì²´í˜•ë³„ ìŠ¤íŠ¸ë ˆì¹­ ë§¤í•‘ í…Œì´ë¸”

```typescript
// lib/stretching/body-type-mapping.ts

import { StretchingExercise, BodyTypeStretchingProtocol } from './types';

/**
 * SHR ê¸°ë°˜ ì²´í˜•ë³„ ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ ë§¤í•‘
 * ì°¸ì¡°: docs/principles/body-mechanics.md Section 2.3
 */
export const BODY_TYPE_STRETCHING_MAP: Record<
  'inverted_triangle' | 'balanced' | 'triangle',
  BodyTypeStretchingProtocol
> = {
  /**
   * ì—­ì‚¼ê°í˜• ì²´í˜• (SHR > 1.1)
   * - íŠ¹ì§•: ìƒì²´ ë°œë‹¬, ì–´ê¹¨ ë„“ìŒ
   * - ëª©í‘œ: ìƒì²´ ê¸´ì¥ ì™„í™”, í•˜ì²´ ê°•í™”
   */
  inverted_triangle: {
    bodyType: 'inverted_triangle',
    shrRange: { min: 1.1, max: Infinity },
    priorityZone: 'upper',
    stretches: [
      // ìƒì²´ ì¤‘ì  ìŠ¤íŠ¸ë ˆì¹­
      { id: 'chest_doorway_stretch', priority: 1, targetMuscle: 'ëŒ€í‰ê·¼' },
      { id: 'lat_stretch_overhead', priority: 1, targetMuscle: 'ê´‘ë°°ê·¼' },
      { id: 'shoulder_cross_body', priority: 2, targetMuscle: 'ì‚¼ê°ê·¼ í›„ë©´' },
      { id: 'upper_trap_stretch', priority: 2, targetMuscle: 'ìƒë¶€ ìŠ¹ëª¨ê·¼' },
      { id: 'triceps_stretch', priority: 3, targetMuscle: 'ì‚¼ë‘ê·¼' },
      // í•˜ì²´ ë³´ì¡° ìŠ¤íŠ¸ë ˆì¹­
      { id: 'hip_flexor_lunge_stretch', priority: 2, targetMuscle: 'ì¥ìš”ê·¼' },
      { id: 'glute_stretch', priority: 3, targetMuscle: 'ë‘”ê·¼' },
    ],
    activations: [
      { id: 'hip_thrust', priority: 1, targetMuscle: 'ëŒ€ë‘”ê·¼ ê°•í™”' },
      { id: 'clamshell', priority: 2, targetMuscle: 'ì¤‘ë‘”ê·¼ ê°•í™”' },
    ],
    frequency: 'ì£¼ 3-4íšŒ',
    duration: 20,
    rationale: 'ì—­ì‚¼ê°í˜• ì²´í˜•ì€ ìƒì²´ ê·¼ìœ¡ ê³¼ê¸´ì¥ ê²½í–¥. í•˜ì²´ ê·¼ë ¥ ë³´ê°•ìœ¼ë¡œ ê· í˜• í™•ë³´.',
  },

  /**
   * ê· í˜•í˜• ì²´í˜• (SHR 0.9-1.1)
   * - íŠ¹ì§•: ì–´ê¹¨-ì—‰ë©ì´ ê· í˜•
   * - ëª©í‘œ: ì „ì‹  ìœ ì—°ì„± ìœ ì§€
   */
  balanced: {
    bodyType: 'balanced',
    shrRange: { min: 0.9, max: 1.1 },
    priorityZone: 'full_body',
    stretches: [
      // ì „ì‹  ê· í˜• ìŠ¤íŠ¸ë ˆì¹­
      { id: 'cat_cow', priority: 1, targetMuscle: 'ì²™ì¶” ì „ì²´' },
      { id: 'world_greatest_stretch', priority: 1, targetMuscle: 'ì „ì‹ ' },
      { id: 'chest_doorway_stretch', priority: 2, targetMuscle: 'ëŒ€í‰ê·¼' },
      { id: 'hip_flexor_lunge_stretch', priority: 2, targetMuscle: 'ì¥ìš”ê·¼' },
      { id: 'hamstring_stretch', priority: 2, targetMuscle: 'í–„ìŠ¤íŠ¸ë§' },
      { id: 'quad_stretch_standing', priority: 3, targetMuscle: 'ëŒ€í‡´ì‚¬ë‘ê·¼' },
    ],
    activations: [
      { id: 'bird_dog', priority: 1, targetMuscle: 'ì½”ì–´ ì•ˆì •ì„±' },
      { id: 'dead_bug', priority: 2, targetMuscle: 'ë³µíš¡ê·¼' },
    ],
    frequency: 'ì£¼ 2-3íšŒ',
    duration: 15,
    rationale: 'ê· í˜•í˜• ì²´í˜•ì€ ìœ ì—°ì„± ìœ ì§€ ëª©ì . ì „ì‹  ê· ë“± ìŠ¤íŠ¸ë ˆì¹­ìœ¼ë¡œ í˜„ìƒ ìœ ì§€.',
  },

  /**
   * ì‚¼ê°í˜•/ë°°í˜• ì²´í˜• (SHR < 0.9)
   * - íŠ¹ì§•: í•˜ì²´ ë°œë‹¬, ì—‰ë©ì´ ë„“ìŒ
   * - ëª©í‘œ: í•˜ì²´ ê¸´ì¥ ì™„í™”, ìƒì²´ í™•ì¥
   */
  triangle: {
    bodyType: 'triangle',
    shrRange: { min: 0, max: 0.9 },
    priorityZone: 'lower',
    stretches: [
      // í•˜ì²´ ì¤‘ì  ìŠ¤íŠ¸ë ˆì¹­
      { id: 'hip_flexor_lunge_stretch', priority: 1, targetMuscle: 'ì¥ìš”ê·¼' },
      { id: 'hip_flexor_couch_stretch', priority: 1, targetMuscle: 'ëŒ€í‡´ì§ê·¼' },
      { id: 'piriformis_stretch', priority: 1, targetMuscle: 'ì´ìƒê·¼' },
      { id: 'it_band_foam_roll', priority: 2, targetMuscle: 'ITë°´ë“œ' },
      { id: 'hamstring_stretch', priority: 2, targetMuscle: 'í–„ìŠ¤íŠ¸ë§' },
      { id: 'calf_stretch', priority: 3, targetMuscle: 'ë¹„ë³µê·¼' },
      // ìƒì²´ ë³´ì¡° ìŠ¤íŠ¸ë ˆì¹­
      { id: 'chest_doorway_stretch', priority: 2, targetMuscle: 'ëŒ€í‰ê·¼' },
    ],
    activations: [
      { id: 'band_pull_apart', priority: 1, targetMuscle: 'í›„ë©´ ì‚¼ê°ê·¼/ëŠ¥í˜•ê·¼' },
      { id: 'face_pulls', priority: 2, targetMuscle: 'ì¤‘/í•˜ë¶€ ìŠ¹ëª¨ê·¼' },
      { id: 'wall_angels', priority: 2, targetMuscle: 'í‰ì¶” ì‹ ì „ê·¼' },
    ],
    frequency: 'ì£¼ 3-4íšŒ',
    duration: 25,
    rationale: 'ì‚¼ê°í˜• ì²´í˜•ì€ í•˜ì²´ ê·¼ìœ¡ ê³¼ê¸´ì¥ ê²½í–¥. ìƒì²´ í™œì„±í™”ë¡œ ìì„¸ ê°œì„ .',
  },
};
```

### 2.7.3 C-2 ì²´í˜•ë¶„ì„ â†’ W-2 ìŠ¤íŠ¸ë ˆì¹­ ë³€í™˜ í•¨ìˆ˜

```typescript
// lib/stretching/body-type-integration.ts

import { BODY_TYPE_STRETCHING_MAP } from './body-type-mapping';
import { StretchingPrescription, StretchingUserProfile } from './types';

/**
 * C-2 ì²´í˜•ë¶„ì„ ê²°ê³¼ì—ì„œ SHR ì¶”ì¶œí•˜ì—¬ ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°© ìƒì„±
 */
export interface C2BodyTypeData {
  source: {
    moduleId: 'C-2';
    analysisId: string;
    analyzedAt: string;
  };
  ratios: {
    shr: number;          // Shoulder-to-Hip Ratio
    whr?: number;         // Waist-to-Hip Ratio
    whtr?: number;        // Waist-to-Height Ratio
  };
  bodyTypeClassification: 'inverted_triangle' | 'balanced' | 'triangle';
}

/**
 * SHR ê°’ìœ¼ë¡œ ì²´í˜• ë¶„ë¥˜
 */
export function classifyBodyType(shr: number): 'inverted_triangle' | 'balanced' | 'triangle' {
  if (shr > 1.1) return 'inverted_triangle';
  if (shr >= 0.9) return 'balanced';
  return 'triangle';
}

/**
 * C-2 ì²´í˜• ë°ì´í„°ë¡œë¶€í„° W-2 ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°© ìƒì„±
 */
export function createPrescriptionFromBodyType(
  bodyTypeData: C2BodyTypeData,
  userProfile: StretchingUserProfile
): StretchingPrescription {
  const bodyType = bodyTypeData.bodyTypeClassification;
  const protocol = BODY_TYPE_STRETCHING_MAP[bodyType];

  return {
    prescriptionId: `bodytype_${bodyTypeData.source.analysisId}_${Date.now()}`,
    createdAt: new Date().toISOString(),
    basedOn: {
      bodyTypeAnalysis: bodyTypeData.source.analysisId,
      purpose: 'body_type_balance',
      shr: bodyTypeData.ratios.shr,
      bodyType,
    },
    stretches: protocol.stretches.map((exercise, index) => ({
      exercise,
      order: index + 1,
      adjustedDuration: adjustForAge(30, userProfile.age),
      adjustedSets: 1,
    })),
    activations: protocol.activations.map((exercise, index) => ({
      exercise,
      order: index + 1,
      adjustedDuration: 45,
      adjustedSets: 2,
    })),
    totalDuration: protocol.duration,
    frequency: protocol.frequency,
    warnings: generateBodyTypeWarnings(bodyType, bodyTypeData.ratios.shr),
    medicalDisclaimer: BODY_TYPE_DISCLAIMER,
    professionalReferral: false,
  };
}

/**
 * ì²´í˜•ë³„ ì£¼ì˜ì‚¬í•­ ìƒì„±
 */
function generateBodyTypeWarnings(
  bodyType: string,
  shr: number
): string[] {
  const warnings: string[] = [];

  if (bodyType === 'inverted_triangle' && shr > 1.3) {
    warnings.push('âš ï¸ ìƒì²´ ë¹„ìœ¨ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤. ìƒì²´ ê³¼ì‚¬ìš© ë¶€ìƒì— ì£¼ì˜í•˜ì„¸ìš”.');
  }

  if (bodyType === 'triangle' && shr < 0.75) {
    warnings.push('âš ï¸ í•˜ì²´ ë¹„ìœ¨ì´ ë†’ìŠµë‹ˆë‹¤. ì¥ì‹œê°„ ì¢Œì‹ ì‹œ í•˜ì²´ ìŠ¤íŠ¸ë ˆì¹­ì„ ë” ìì£¼ í•˜ì„¸ìš”.');
  }

  return warnings;
}

const BODY_TYPE_DISCLAIMER = `
â€» ë³¸ ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œê·¸ë¨ì€ ì¼ë°˜ì ì¸ ì²´í˜• íŠ¹ì„±ì— ê¸°ë°˜í•œ ì¶”ì²œì…ë‹ˆë‹¤.
   ê°œì¸ì˜ ë¶€ìƒ ì´ë ¥, ê´€ì ˆ ê°€ë™ ë²”ìœ„, ê·¼ë ¥ ìˆ˜ì¤€ì— ë”°ë¼ ì¡°ì •ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
   í†µì¦ ë°œìƒ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³  ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì„¸ìš”.
`;
```

### 2.7.4 ì²´í˜•-ìì„¸ ë³µí•© ë¶„ì„ í†µí•©

C-2 ë¶„ì„ì—ì„œ ì²´í˜•(SHR)ê³¼ ìì„¸(Janda) ê²°ê³¼ê°€ ëª¨ë‘ ìˆì„ ê²½ìš°, ë³µí•© ì²˜ë°© ìƒì„±:

```typescript
/**
 * ì²´í˜• + ìì„¸ ë³µí•© ì²˜ë°© ìš°ì„ ìˆœìœ„
 *
 * 1. Janda ì‹¬ê°ë„ê°€ 'severe'ë©´ Janda ì²˜ë°© ìš°ì„  (Section 2.6)
 * 2. ì²´í˜• ë¶ˆê· í˜•ì´ í¬ë©´ (|SHR-1.0| > 0.2) ì²´í˜• ì²˜ë°© ë³´ì¡°
 * 3. ë‘˜ ë‹¤ ê²½ë¯¸í•˜ë©´ ê· í˜• ìœ ì§€ í”„ë¡œê·¸ë¨
 */
export function createCombinedPrescription(
  jandaData: C2ToW2IntegrationData,
  bodyTypeData: C2BodyTypeData,
  userProfile: StretchingUserProfile
): StretchingPrescription {
  const jandaSeverity = jandaData.jandaResults.combinedSeverity;
  const shrDeviation = Math.abs(bodyTypeData.ratios.shr - 1.0);

  // ìš°ì„ ìˆœìœ„ ê²°ì •
  if (jandaSeverity === 'severe') {
    // Janda ê¸°ë°˜ ì²˜ë°© (Section 2.6) + ì²´í˜• ë³´ì¡°
    const basePrescription = createPrescriptionFromC2(jandaData, userProfile);
    const bodyTypeProtocol = BODY_TYPE_STRETCHING_MAP[bodyTypeData.bodyTypeClassification];

    // ì²´í˜• ê¸°ë°˜ í™œì„±í™” ìš´ë™ë§Œ ì¶”ê°€
    return {
      ...basePrescription,
      activations: [
        ...basePrescription.activations,
        ...bodyTypeProtocol.activations.slice(0, 2),  // ìƒìœ„ 2ê°œë§Œ
      ],
    };
  }

  if (shrDeviation > 0.2) {
    // ì²´í˜• ê¸°ë°˜ ì²˜ë°© + Janda ë³´ì¡°
    const basePrescription = createPrescriptionFromBodyType(bodyTypeData, userProfile);
    const jandaProtocol = {
      ucs: UCS_STRETCHING_MAP[jandaData.jandaResults.upperCross.severity],
      lcs: LCS_STRETCHING_MAP[jandaData.jandaResults.lowerCross.severity],
    };

    // Janda ê¸°ë°˜ ìŠ¤íŠ¸ë ˆì¹­ ì¼ë¶€ ì¶”ê°€
    return {
      ...basePrescription,
      stretches: [
        ...basePrescription.stretches,
        ...jandaProtocol.ucs.stretches.slice(0, 2).map((id, i) => ({
          exercise: { id, priority: 3, targetMuscle: 'UCS ë³´ì¡°' },
          order: basePrescription.stretches.length + i + 1,
          adjustedDuration: 30,
          adjustedSets: 1,
        })),
      ],
    };
  }

  // ê· í˜• ìœ ì§€ í”„ë¡œê·¸ë¨
  return createPrescriptionFromBodyType(
    { ...bodyTypeData, bodyTypeClassification: 'balanced' },
    userProfile
  );
}
```

---

## 2.8 ìŠ¤í¬ì¸ ë³„ ìŠ¤íŠ¸ë ˆì¹­ ìƒì„¸ ë§¤í•‘

> 6ê°œ ìŠ¤í¬ì¸  ìœ í˜•ë³„ ê·¼ìœ¡êµ° ë§¤í•‘ ë° ë¶€ìƒ ì˜ˆë°© í”„ë¡œí† ì½œ

### 2.7.1 ìŠ¤í¬ì¸ -ê·¼ìœ¡ ë§¤í•‘ í…Œì´ë¸”

| ìŠ¤í¬ì¸  | ì£¼ìš” íƒ€ê²Ÿ ê·¼ìœ¡ | ì›Œë°ì—… ì¤‘ì  | ì¿¨ë‹¤ìš´ ì¤‘ì  | ë¶€ìƒ ìœ„í—˜ ë¶€ìœ„ |
|--------|---------------|------------|------------|--------------|
| **ëŸ¬ë‹** | í–„ìŠ¤íŠ¸ë§, ì¥ìš”ê·¼, ë¹„ë³µê·¼, ëŒ€í‡´ì‚¬ë‘ê·¼, ë‘”ê·¼ | ê³ ê´€ì ˆ ê°€ë™ì„±, ë™ì  ì‹ ì „ | í•˜ì§€ ì •ì  ìŠ¤íŠ¸ë ˆì¹­ | ITBS, ì¡±ì €ê·¼ë§‰, ì•„í‚¬ë ˆìŠ¤ |
| **ë“±ì‚°** | ëŒ€í‡´ì‚¬ë‘ê·¼, ë‘”ê·¼, ë¹„ë³µê·¼, í–„ìŠ¤íŠ¸ë§ | í•˜ì§€ ì›Œë°ì—…, ë°œëª© | ëŒ€í‡´ì‚¬ë‘ê·¼, ì¢…ì•„ë¦¬ | PFPS, ITBS, ë°œëª© |
| **ê³¨í”„** | ë³µì‚¬ê·¼, ëŒ€ë‘”ê·¼, ê´‘ë°°ê·¼, ëŒ€í‰ê·¼, ì²™ì¶”ê¸°ë¦½ê·¼ | í‰ì¶” íšŒì „, ê³ ê´€ì ˆ | ì²™ì¶” ë¹„í‹€ê¸°, ì–´ê¹¨ | ìš”í†µ, ê³¨í”„ ì—˜ë³´, ì†ëª© |
| **ìì „ê±°** | ëŒ€í‡´ì‚¬ë‘ê·¼, í–„ìŠ¤íŠ¸ë§, ëŒ€ë‘”ê·¼, ì¥ìš”ê·¼ | ê³ ê´€ì ˆ, ëŒ€í‡´ì‚¬ë‘ê·¼ | ê³ ê´€ì ˆ êµ´ê³¡ê·¼, í‰ì¶” | PFPS, ìš”í†µ |
| **ìˆ˜ì˜** | ê´‘ë°°ê·¼, ëŒ€í‰ê·¼, íšŒì „ê·¼ê°œ, ì‚¼ê°ê·¼, ì½”ì–´ | ì–´ê¹¨ ê°€ë™ì„±, í‰ì¶” | ì–´ê¹¨, ë“±, ì½”ì–´ | ì–´ê¹¨ ì¶©ëŒ, ë¬´ë¦ |
| **í…Œë‹ˆìŠ¤** | íšŒì „ê·¼ê°œ, ì‚¼ê°ê·¼, ì „ì™„ê·¼, ì¤‘ë‘”ê·¼ | ì–´ê¹¨ íšŒì „, ê³ ê´€ì ˆ | ì–´ê¹¨, ì „ì™„ | í…Œë‹ˆìŠ¤ ì—˜ë³´, ì–´ê¹¨ |

### 2.7.2 ëŸ¬ë‹ ìƒì„¸ í”„ë¡œí† ì½œ

```typescript
// lib/stretching/sports/running-protocol.ts

export const RUNNING_PROTOCOL = {
  warmup: {
    name: 'ëŸ¬ë‹ ì „ ë™ì  ì›Œë°ì—…',
    duration: 10,
    phases: [
      {
        name: 'ì¼ë°˜ ì›Œë°ì—…',
        duration: 3,
        exercises: ['walking_brisk', 'arm_circles'],
      },
      {
        name: 'ë™ì  ìŠ¤íŠ¸ë ˆì¹­',
        duration: 7,
        exercises: [
          { id: 'leg_swings_front_back', reps: 15, targetMuscle: 'í–„ìŠ¤íŠ¸ë§/ì¥ìš”ê·¼' },
          { id: 'leg_swings_lateral', reps: 15, targetMuscle: 'ë‚´ì „ê·¼/ì™¸ì „ê·¼' },
          { id: 'walking_lunges', reps: 10, targetMuscle: 'ëŒ€í‡´ì‚¬ë‘ê·¼/ë‘”ê·¼' },
          { id: 'high_knees', duration: 30, targetMuscle: 'ì¥ìš”ê·¼' },
          { id: 'butt_kicks', duration: 30, targetMuscle: 'í–„ìŠ¤íŠ¸ë§' },
          { id: 'carioca', duration: 30, targetMuscle: 'ê³ ê´€ì ˆ íšŒì „' },
          { id: 'inchworm', reps: 5, targetMuscle: 'í–„ìŠ¤íŠ¸ë§/ì½”ì–´' },
        ],
      },
    ],
    keyPoints: [
      'ë™ì  ìŠ¤íŠ¸ë ˆì¹­ë§Œ ìˆ˜í–‰ (ì •ì  ìŠ¤íŠ¸ë ˆì¹­ X)',
      'ì ì§„ì ìœ¼ë¡œ ë™ì‘ ë²”ìœ„ í™•ëŒ€',
      'ì‹¬ë°•ìˆ˜ ì„œì„œíˆ ìƒìŠ¹',
    ],
  },
  cooldown: {
    name: 'ëŸ¬ë‹ í›„ ì •ì  ì¿¨ë‹¤ìš´',
    duration: 10,
    phases: [
      {
        name: 'ê±·ê¸° (ì‹¬ë°•ìˆ˜ íšŒë³µ)',
        duration: 3,
        exercises: ['walking_slow'],
      },
      {
        name: 'ì •ì  ìŠ¤íŠ¸ë ˆì¹­',
        duration: 7,
        exercises: [
          { id: 'quad_stretch_standing', hold: 30, targetMuscle: 'ëŒ€í‡´ì‚¬ë‘ê·¼' },
          { id: 'hamstring_stretch_standing', hold: 30, targetMuscle: 'í–„ìŠ¤íŠ¸ë§' },
          { id: 'calf_stretch_wall', hold: 30, targetMuscle: 'ë¹„ë³µê·¼/ê°€ìë¯¸ê·¼' },
          { id: 'hip_flexor_lunge_stretch', hold: 30, targetMuscle: 'ì¥ìš”ê·¼' },
          { id: 'glute_stretch_figure_four', hold: 30, targetMuscle: 'ë‘”ê·¼/ì´ìƒê·¼' },
          { id: 'it_band_stretch_standing', hold: 30, targetMuscle: 'ITë°´ë“œ' },
        ],
      },
    ],
    keyPoints: [
      'ê° ìŠ¤íŠ¸ë ˆì¹­ 30ì´ˆ ìœ ì§€',
      'í†µì¦ ì—†ì´ ë‹¹ê¸°ëŠ” ëŠë‚Œê¹Œì§€ë§Œ',
      'ITBS ì˜ˆë°©: ITë°´ë“œ + ë‘”ê·¼ ê°•í™” ì¤‘ìš”',
    ],
  },
  injuryPrevention: {
    itbs: {
      risk: 'ITBS (ì¥ê²½ì¸ëŒ€ ì¦í›„êµ°)',
      preventionExercises: ['foam_rolling_it_band', 'clamshell', 'side_lying_leg_raise'],
      note: 'ë‘”ê·¼ ê°•í™”ê°€ ITë°´ë“œ ìŠ¤íŠ¸ë ˆì¹­ë³´ë‹¤ íš¨ê³¼ì  (ì—°êµ¬ ê¸°ë°˜)',
    },
    plantarFasciitis: {
      risk: 'ì¡±ì €ê·¼ë§‰ì—¼',
      preventionExercises: ['calf_stretch_wall', 'toe_curls', 'arch_strengthening'],
      note: 'ë¹„ë³µê·¼+ê°€ìë¯¸ê·¼ ìŠ¤íŠ¸ë ˆì¹­ í•„ìˆ˜',
    },
  },
};
```

### 2.7.3 ê³¨í”„ ìƒì„¸ í”„ë¡œí† ì½œ

```typescript
// lib/stretching/sports/golf-protocol.ts

export const GOLF_PROTOCOL = {
  warmup: {
    name: 'ê³¨í”„ ì „ ë™ì  ì›Œë°ì—…',
    duration: 15,
    phases: [
      {
        name: 'ì¼ë°˜ ì›Œë°ì—…',
        duration: 3,
        exercises: ['walking_brisk', 'arm_circles'],
      },
      {
        name: 'ê³¨í”„ íŠ¹í™” ë™ì  ìŠ¤íŠ¸ë ˆì¹­',
        duration: 12,
        exercises: [
          { id: 'overhead_squat_with_club', reps: 10, targetMuscle: 'ì „ì‹  ê°€ë™ì„±' },
          { id: 'lunge_with_rotation', reps: 8, targetMuscle: 'í‰ì¶” íšŒì „/ê³ ê´€ì ˆ' },
          { id: 'split_stance_rotation', reps: 10, targetMuscle: 'ì½”ì–´ íšŒì „' },
          { id: 'hip_circles_open_close', reps: 10, targetMuscle: 'ê³ ê´€ì ˆ ê°€ë™ì„±' },
          { id: 'worlds_greatest_stretch', reps: 5, targetMuscle: 'ì „ì‹  í†µí•©' },
          { id: 'arm_circles', reps: 15, targetMuscle: 'ì–´ê¹¨ ê°€ë™ì„±' },
          { id: 'club_swing_acceleration', sets: 3, targetMuscle: 'ìŠ¤ìœ™ ì¤€ë¹„' },
        ],
      },
    ],
    keyPoints: [
      'ë™ì  ì›Œë°ì—…ìœ¼ë¡œ í´ëŸ½í—¤ë“œ ìŠ¤í”¼ë“œ 12.8% í–¥ìƒ (ì—°êµ¬)',
      'í‰ì¶” íšŒì „ ê°€ë™ì„± ì§‘ì¤‘',
      'ê³¨í”„ì±„ í™œìš© ìŠ¤íŠ¸ë ˆì¹­ ê¶Œì¥',
    ],
    koreanSpecificNotes: [
      'ìŠ¤í¬ë¦°ê³¨í”„ì¥: ì¸ì¡° ë§¤íŠ¸ íŠ¹ì„±ìƒ ì†ëª©/íŒ”ê¿ˆì¹˜ ì¶©ê²© ì¦ê°€',
      'ë¼ìš´ë“œ ì „ ìµœì†Œ 15ë¶„ ì›Œë°ì—… ê¶Œì¥',
    ],
  },
  cooldown: {
    name: 'ê³¨í”„ í›„ ì •ì  ì¿¨ë‹¤ìš´',
    duration: 10,
    phases: [
      {
        name: 'ì •ì  ìŠ¤íŠ¸ë ˆì¹­',
        duration: 10,
        exercises: [
          { id: 'hip_flexor_lunge_stretch', hold: 30, targetMuscle: 'ì¥ìš”ê·¼' },
          { id: 'glute_stretch_figure_four', hold: 30, targetMuscle: 'ë‘”ê·¼' },
          { id: 'spine_twist_supine', hold: 30, targetMuscle: 'ì²™ì¶” íšŒì „' },
          { id: 'cross_body_shoulder_stretch', hold: 30, targetMuscle: 'í›„ë°© ì–´ê¹¨' },
          { id: 'thoracic_extension_foam_roller', hold: 60, targetMuscle: 'í‰ì¶”' },
          { id: 'lateral_trunk_stretch', hold: 30, targetMuscle: 'ì¸¡ë©´ ì²´ê°„' },
        ],
      },
    ],
    keyPoints: [
      'ìŠ¤ìœ™ìœ¼ë¡œ ì¸í•œ ë¹„ëŒ€ì¹­ ë³´ìƒ ìŠ¤íŠ¸ë ˆì¹­',
      'ì–‘ìª½ ê· ë“± ìŠ¤íŠ¸ë ˆì¹­ ì¤‘ìš”',
      'ìš”ì¶” ê³¼íšŒì „ ì£¼ì˜',
    ],
  },
  injuryPrevention: {
    backPain: {
      risk: 'ìš”í†µ (ê³¨í¼ì˜ 18-54%)',
      preventionExercises: ['cat_cow', 'bird_dog', 'plank', 'hip_flexor_stretch'],
      note: 'X-Factor ê·¹ëŒ€í™” ì‹œ ìš”ì¶” ì†ìƒ ìœ„í—˜ - ê°œì¸ ê°€ë™ë²”ìœ„ ë‚´ ìŠ¤ìœ™',
    },
    golfElbow: {
      risk: 'ê³¨í”„ ì—˜ë³´',
      preventionExercises: ['wrist_flexor_stretch', 'wrist_extensor_stretch', 'forearm_strengthening'],
      note: 'íŠ¹íˆ ìŠ¤í¬ë¦°ê³¨í”„ì—ì„œ ë°œìƒë¥  ë†’ìŒ',
    },
  },
};
```

---

## 3. ë°ì´í„° êµ¬ì¡°

### 3.1 ìš´ë™ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

```sql
-- ìŠ¤íŠ¸ë ˆì¹­ ìš´ë™ ë§ˆìŠ¤í„°
CREATE TABLE stretch_exercises (
  id TEXT PRIMARY KEY,
  name_ko TEXT NOT NULL,
  name_en TEXT NOT NULL,
  type TEXT NOT NULL CHECK (type IN ('static', 'dynamic', 'pnf')),
  category TEXT NOT NULL,

  -- ê·¼ìœ¡ íƒ€ê²Ÿ (JSONB)
  target_muscles JSONB NOT NULL DEFAULT '[]',
  secondary_muscles JSONB DEFAULT '[]',

  -- ì¥ë¹„
  equipment JSONB NOT NULL DEFAULT '["bodyweight"]',
  difficulty TEXT NOT NULL CHECK (difficulty IN ('beginner', 'intermediate', 'advanced')),

  -- íŒŒë¼ë¯¸í„°
  default_duration INTEGER NOT NULL,  -- ì´ˆ ë˜ëŠ” íšŸìˆ˜
  duration_unit TEXT NOT NULL CHECK (duration_unit IN ('seconds', 'reps')),
  sets INTEGER NOT NULL DEFAULT 2,
  rest_between_sets INTEGER DEFAULT 10,

  -- ì½˜í…ì¸ 
  instructions JSONB NOT NULL,
  breathing_guide TEXT,
  common_mistakes JSONB DEFAULT '[]',

  -- ë¯¸ë””ì–´
  video_url TEXT,
  thumbnail_url TEXT,
  animation_frames JSONB,

  -- ì•ˆì „
  contraindications JSONB DEFAULT '[]',
  modifications JSONB DEFAULT '[]',
  red_flags JSONB DEFAULT '[]',

  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_stretch_exercises_type ON stretch_exercises(type);
CREATE INDEX idx_stretch_exercises_category ON stretch_exercises(category);
CREATE INDEX idx_stretch_exercises_target_muscles ON stretch_exercises USING GIN (target_muscles);

-- ìì„¸ ë¶ˆê· í˜•ë³„ í”„ë¡œí† ì½œ
CREATE TABLE posture_protocols (
  imbalance_type TEXT PRIMARY KEY,
  stretch_exercise_ids JSONB NOT NULL,
  activation_exercise_ids JSONB NOT NULL,
  strengthening_exercise_ids JSONB NOT NULL,
  frequency TEXT NOT NULL,
  progression JSONB NOT NULL,
  created_at TIMESTAMPTZ DEFAULT now()
);

-- ìŠ¤í¬ì¸ ë³„ í”„ë¡œí† ì½œ
CREATE TABLE sport_protocols (
  sport_type TEXT PRIMARY KEY,
  warmup_exercise_ids JSONB NOT NULL,
  warmup_duration INTEGER NOT NULL,
  cooldown_exercise_ids JSONB NOT NULL,
  cooldown_duration INTEGER NOT NULL,
  key_muscles JSONB NOT NULL,
  common_injuries JSONB NOT NULL,
  korean_specific_notes JSONB DEFAULT '[]',
  created_at TIMESTAMPTZ DEFAULT now()
);
```

### 3.2 ì‚¬ìš©ì ë°ì´í„° ìŠ¤í‚¤ë§ˆ

```sql
-- ìŠ¤íŠ¸ë ˆì¹­ ì‚¬ìš©ì í”„ë¡œí•„
CREATE TABLE stretching_user_profiles (
  clerk_user_id TEXT PRIMARY KEY REFERENCES users(clerk_user_id),

  -- ìš´ë™ ìˆ˜ì¤€
  fitness_level TEXT DEFAULT 'beginner',
  stretching_experience TEXT DEFAULT 'none',

  -- ìŠ¤í¬ì¸ 
  primary_sports JSONB DEFAULT '[]',
  sports_frequency TEXT DEFAULT 'weekly',

  -- ê±´ê°• ì •ë³´
  contraindications JSONB DEFAULT '[]',
  special_conditions JSONB DEFAULT '[]',

  -- ì¥ë¹„
  available_equipment JSONB DEFAULT '["bodyweight", "wall", "mat"]',

  -- ì„ í˜¸
  preferred_session_duration INTEGER DEFAULT 15,

  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);

-- RLS ì •ì±…
ALTER TABLE stretching_user_profiles ENABLE ROW LEVEL SECURITY;

CREATE POLICY "user_own_profile" ON stretching_user_profiles
  FOR ALL USING (clerk_user_id = auth.get_user_id());

-- ìŠ¤íŠ¸ë ˆì¹­ ì²˜ë°© ê¸°ë¡
CREATE TABLE stretching_prescriptions (
  id TEXT PRIMARY KEY,
  clerk_user_id TEXT NOT NULL REFERENCES users(clerk_user_id),

  -- ê¸°ë°˜ ì •ë³´
  posture_analysis_id TEXT,
  sport_type TEXT,
  purpose TEXT NOT NULL,

  -- ì²˜ë°© ë‚´ìš© (JSONB)
  stretches JSONB NOT NULL,
  activations JSONB,

  -- ë©”íƒ€
  total_duration INTEGER NOT NULL,
  frequency TEXT NOT NULL,
  warnings JSONB DEFAULT '[]',

  created_at TIMESTAMPTZ DEFAULT now()
);

CREATE INDEX idx_prescriptions_user ON stretching_prescriptions(clerk_user_id);
ALTER TABLE stretching_prescriptions ENABLE ROW LEVEL SECURITY;

CREATE POLICY "user_own_prescriptions" ON stretching_prescriptions
  FOR ALL USING (clerk_user_id = auth.get_user_id());

-- ìŠ¤íŠ¸ë ˆì¹­ ì„¸ì…˜ ê¸°ë¡
CREATE TABLE stretching_sessions (
  id TEXT PRIMARY KEY,
  clerk_user_id TEXT NOT NULL REFERENCES users(clerk_user_id),
  prescription_id TEXT REFERENCES stretching_prescriptions(id),

  started_at TIMESTAMPTZ NOT NULL,
  completed_at TIMESTAMPTZ,

  -- ìˆ˜í–‰ ë‚´ìš©
  completed_exercises JSONB NOT NULL DEFAULT '[]',

  -- í”¼ë“œë°±
  perceived_effort INTEGER CHECK (perceived_effort BETWEEN 1 AND 10),
  pain_reported BOOLEAN DEFAULT FALSE,
  pain_details TEXT,
  overall_satisfaction INTEGER CHECK (overall_satisfaction BETWEEN 1 AND 5),

  -- ê³„ì‚°ê°’
  completion_rate NUMERIC(5,2),
  total_active_time INTEGER,

  created_at TIMESTAMPTZ DEFAULT now()
);

CREATE INDEX idx_sessions_user ON stretching_sessions(clerk_user_id);
CREATE INDEX idx_sessions_date ON stretching_sessions(started_at);
ALTER TABLE stretching_sessions ENABLE ROW LEVEL SECURITY;

CREATE POLICY "user_own_sessions" ON stretching_sessions
  FOR ALL USING (clerk_user_id = auth.get_user_id());

-- ROM ì§„í–‰ ì¶”ì 
CREATE TABLE rom_progress (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  clerk_user_id TEXT NOT NULL REFERENCES users(clerk_user_id),
  muscle_group TEXT NOT NULL,
  rom_degrees NUMERIC(5,2) NOT NULL,
  measurement_type TEXT NOT NULL CHECK (measurement_type IN ('self_reported', 'ai_estimated')),
  notes TEXT,
  measured_at TIMESTAMPTZ DEFAULT now()
);

CREATE INDEX idx_rom_user_muscle ON rom_progress(clerk_user_id, muscle_group);
ALTER TABLE rom_progress ENABLE ROW LEVEL SECURITY;

CREATE POLICY "user_own_rom" ON rom_progress
  FOR ALL USING (clerk_user_id = auth.get_user_id());
```

---

## 4. API ì„¤ê³„

### 4.1 ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/v2/stretching/prescribe/posture` | ìì„¸ ê¸°ë°˜ ì²˜ë°© ìƒì„± |
| POST | `/api/v2/stretching/prescribe/sport` | ìŠ¤í¬ì¸  ê¸°ë°˜ ì²˜ë°© ìƒì„± |
| GET | `/api/v2/stretching/exercises` | ìš´ë™ ëª©ë¡ ì¡°íšŒ |
| GET | `/api/v2/stretching/exercises/{id}` | ìš´ë™ ìƒì„¸ ì¡°íšŒ |
| GET | `/api/v2/stretching/weekly-plan` | ì£¼ê°„ í”Œëœ ì¡°íšŒ |
| POST | `/api/v2/stretching/weekly-plan` | ì£¼ê°„ í”Œëœ ìƒì„± |
| POST | `/api/v2/stretching/sessions` | ì„¸ì…˜ ì‹œì‘ |
| PATCH | `/api/v2/stretching/sessions/{id}` | ì„¸ì…˜ ì—…ë°ì´íŠ¸ |
| GET | `/api/v2/stretching/history` | ì„¸ì…˜ ê¸°ë¡ ì¡°íšŒ |
| GET | `/api/v2/stretching/progress` | ROM ì§„í–‰ í˜„í™© |
| GET | `/api/v2/stretching/profile` | í”„ë¡œí•„ ì¡°íšŒ |
| PUT | `/api/v2/stretching/profile` | í”„ë¡œí•„ ì—…ë°ì´íŠ¸ |

### 4.2 ìì„¸ ê¸°ë°˜ ì²˜ë°© API

```typescript
// app/api/v2/stretching/prescribe/posture/route.ts

import { NextRequest, NextResponse } from 'next/server';
import { auth } from '@clerk/nextjs/server';
import { z } from 'zod';
import { prescribePostureStretching } from '@/lib/stretching/posture-prescription';
import { createClerkSupabaseClientSsr } from '@/lib/supabase/server';

const requestSchema = z.object({
  postureAssessmentId: z.string().min(1),
});

export async function POST(request: NextRequest) {
  try {
    const { userId } = await auth();
    if (!userId) {
      return NextResponse.json(
        { success: false, error: { code: 'AUTH_ERROR', message: 'Unauthorized' } },
        { status: 401 }
      );
    }

    const body = await request.json();
    const validated = requestSchema.safeParse(body);
    if (!validated.success) {
      return NextResponse.json(
        { success: false, error: { code: 'VALIDATION_ERROR', message: 'Invalid request' } },
        { status: 400 }
      );
    }

    const supabase = await createClerkSupabaseClientSsr();

    // 1. ìì„¸ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
    const { data: postureResult, error: postureError } = await supabase
      .from('body_assessments')
      .select('*')
      .eq('id', validated.data.postureAssessmentId)
      .eq('clerk_user_id', userId)
      .single();

    if (postureError || !postureResult) {
      return NextResponse.json(
        { success: false, error: { code: 'NOT_FOUND', message: 'Posture assessment not found' } },
        { status: 404 }
      );
    }

    // 2. ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ
    const { data: userProfile } = await supabase
      .from('stretching_user_profiles')
      .select('*')
      .eq('clerk_user_id', userId)
      .single();

    // 3. ì²˜ë°© ìƒì„±
    const prescription = prescribePostureStretching(
      transformPostureResult(postureResult),
      transformUserProfile(userProfile, userId)
    );

    // 4. DB ì €ì¥
    const { data: saved, error: saveError } = await supabase
      .from('stretching_prescriptions')
      .insert({
        id: prescription.prescriptionId,
        clerk_user_id: userId,
        posture_analysis_id: validated.data.postureAssessmentId,
        purpose: 'posture_correction',
        stretches: prescription.stretches,
        activations: prescription.activations,
        total_duration: prescription.totalDuration,
        frequency: prescription.frequency,
        warnings: prescription.warnings,
      })
      .select()
      .single();

    if (saveError) {
      console.error('[API] Save prescription error:', saveError);
      return NextResponse.json(
        { success: false, error: { code: 'DB_ERROR', message: 'Failed to save prescription' } },
        { status: 500 }
      );
    }

    return NextResponse.json({
      success: true,
      data: prescription,
    });

  } catch (error) {
    console.error('[API] POST /stretching/prescribe/posture error:', error);
    return NextResponse.json(
      { success: false, error: { code: 'UNKNOWN_ERROR', message: 'Internal server error' } },
      { status: 500 }
    );
  }
}
```

### 4.3 ìŠ¤í¬ì¸  ê¸°ë°˜ ì²˜ë°© API

```typescript
// app/api/v2/stretching/prescribe/sport/route.ts

import { NextRequest, NextResponse } from 'next/server';
import { auth } from '@clerk/nextjs/server';
import { z } from 'zod';
import { prescribeSportStretching } from '@/lib/stretching/sport-protocols';

const requestSchema = z.object({
  sport: z.enum(['hiking', 'running', 'golf', 'cycling', 'swimming', 'tennis']),
  phase: z.enum(['warmup', 'cooldown']),
});

export async function POST(request: NextRequest) {
  try {
    const { userId } = await auth();
    if (!userId) {
      return NextResponse.json(
        { success: false, error: { code: 'AUTH_ERROR', message: 'Unauthorized' } },
        { status: 401 }
      );
    }

    const body = await request.json();
    const validated = requestSchema.safeParse(body);
    if (!validated.success) {
      return NextResponse.json(
        { success: false, error: { code: 'VALIDATION_ERROR', message: 'Invalid request' } },
        { status: 400 }
      );
    }

    const supabase = await createClerkSupabaseClientSsr();

    // ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ
    const { data: userProfile } = await supabase
      .from('stretching_user_profiles')
      .select('*')
      .eq('clerk_user_id', userId)
      .single();

    // ì²˜ë°© ìƒì„±
    const prescription = prescribeSportStretching(
      validated.data.sport,
      validated.data.phase,
      transformUserProfile(userProfile, userId)
    );

    return NextResponse.json({
      success: true,
      data: prescription,
    });

  } catch (error) {
    console.error('[API] POST /stretching/prescribe/sport error:', error);
    return NextResponse.json(
      { success: false, error: { code: 'UNKNOWN_ERROR', message: 'Internal server error' } },
      { status: 500 }
    );
  }
}
```

---

## 5. UI ì»´í¬ë„ŒíŠ¸

### 5.1 íŒŒì¼ êµ¬ì¡°

```
apps/web/
â”œâ”€â”€ app/(main)/stretching/
â”‚   â”œâ”€â”€ page.tsx                    # ìŠ¤íŠ¸ë ˆì¹­ í™ˆ (ë£¨í‹´ ì„ íƒ)
â”‚   â”œâ”€â”€ posture/
â”‚   â”‚   â””â”€â”€ page.tsx                # ìì„¸êµì • ìŠ¤íŠ¸ë ˆì¹­
â”‚   â”œâ”€â”€ sport/
â”‚   â”‚   â”œâ”€â”€ page.tsx                # ìŠ¤í¬ì¸  ì„ íƒ
â”‚   â”‚   â””â”€â”€ [sport]/
â”‚   â”‚       â””â”€â”€ page.tsx            # ìŠ¤í¬ì¸ ë³„ ë£¨í‹´
â”‚   â”œâ”€â”€ session/
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â””â”€â”€ page.tsx            # ì„¸ì…˜ ì‹¤í–‰
â”‚   â”œâ”€â”€ history/
â”‚   â”‚   â””â”€â”€ page.tsx                # ê¸°ë¡ ì¡°íšŒ
â”‚   â””â”€â”€ profile/
â”‚       â””â”€â”€ page.tsx                # í”„ë¡œí•„ ì„¤ì •
â”œâ”€â”€ components/stretching/
â”‚   â”œâ”€â”€ StretchingHome.tsx          # í™ˆ í™”ë©´
â”‚   â”œâ”€â”€ PosturePrescription.tsx     # ìì„¸ê¸°ë°˜ ì²˜ë°© ê²°ê³¼
â”‚   â”œâ”€â”€ SportSelector.tsx           # ìŠ¤í¬ì¸  ì„ íƒê¸°
â”‚   â”œâ”€â”€ ExerciseCard.tsx            # ìš´ë™ ì¹´ë“œ
â”‚   â”œâ”€â”€ ExerciseDetail.tsx          # ìš´ë™ ìƒì„¸ ëª¨ë‹¬
â”‚   â”œâ”€â”€ SessionPlayer.tsx           # ì„¸ì…˜ í”Œë ˆì´ì–´
â”‚   â”œâ”€â”€ ExerciseTimer.tsx           # íƒ€ì´ë¨¸ (ì •ì /ë™ì )
â”‚   â”œâ”€â”€ PNFGuide.tsx                # PNF ê°€ì´ë“œ
â”‚   â”œâ”€â”€ BreathingIndicator.tsx      # í˜¸í¡ ê°€ì´ë“œ
â”‚   â”œâ”€â”€ ProgressTracker.tsx         # ì§„í–‰ ì¶”ì 
â”‚   â”œâ”€â”€ WeeklyPlanView.tsx          # ì£¼ê°„ í”Œëœ
â”‚   â”œâ”€â”€ SafetyAlert.tsx             # ì•ˆì „ ê²½ê³ 
â”‚   â””â”€â”€ MedicalDisclaimer.tsx       # ì˜ë£Œ ë©´ì±…
â””â”€â”€ lib/stretching/
    â”œâ”€â”€ types.ts                    # íƒ€ì… ì •ì˜
    â”œâ”€â”€ posture-prescription.ts     # ìì„¸ ì²˜ë°© ë¡œì§
    â”œâ”€â”€ sport-protocols.ts          # ìŠ¤í¬ì¸  í”„ë¡œí† ì½œ
    â”œâ”€â”€ pnf-protocol.ts             # PNF í”„ë¡œí† ì½œ
    â”œâ”€â”€ weekly-planner.ts           # ì£¼ê°„ í”Œë˜ë„ˆ
    â””â”€â”€ data/
        â”œâ”€â”€ exercise-database.ts    # ìš´ë™ DB
        â””â”€â”€ posture-protocols.ts    # í”„ë¡œí† ì½œ ë°ì´í„°
```

### 5.2 ì„¸ì…˜ í”Œë ˆì´ì–´ ì»´í¬ë„ŒíŠ¸

```tsx
// components/stretching/SessionPlayer.tsx
'use client';

import { useState, useEffect, useCallback } from 'react';
import { PrescribedStretch, StretchType } from '@/lib/stretching/types';
import { ExerciseTimer } from './ExerciseTimer';
import { BreathingIndicator } from './BreathingIndicator';
import { SafetyAlert } from './SafetyAlert';
import { Button } from '@/components/ui/button';
import { Card } from '@/components/ui/card';

interface SessionPlayerProps {
  stretches: PrescribedStretch[];
  sessionId: string;
  onComplete: (completedExercises: CompletedExercise[]) => void;
  onExit: () => void;
}

export function SessionPlayer({
  stretches,
  sessionId,
  onComplete,
  onExit,
}: SessionPlayerProps) {
  const [currentIndex, setCurrentIndex] = useState(0);
  const [currentSet, setCurrentSet] = useState(1);
  const [isPlaying, setIsPlaying] = useState(false);
  const [completedExercises, setCompletedExercises] = useState<CompletedExercise[]>([]);

  const currentStretch = stretches[currentIndex];
  const exercise = currentStretch?.exercise;
  const totalExercises = stretches.length;
  const progress = ((currentIndex + 1) / totalExercises) * 100;

  // íƒ€ì´ë¨¸ ì™„ë£Œ í•¸ë“¤ëŸ¬
  const handleTimerComplete = useCallback(() => {
    if (currentSet < currentStretch.adjustedSets) {
      // ë‹¤ìŒ ì„¸íŠ¸
      setCurrentSet(prev => prev + 1);
    } else {
      // ìš´ë™ ì™„ë£Œ, ë‹¤ìŒ ìš´ë™ìœ¼ë¡œ
      setCompletedExercises(prev => [
        ...prev,
        {
          exerciseId: exercise.id,
          completedSets: currentSet,
          actualDuration: currentStretch.adjustedDuration * currentSet,
          skipped: false,
        },
      ]);

      if (currentIndex < totalExercises - 1) {
        setCurrentIndex(prev => prev + 1);
        setCurrentSet(1);
      } else {
        // ì„¸ì…˜ ì™„ë£Œ
        onComplete(completedExercises);
      }
    }
  }, [currentIndex, currentSet, currentStretch, exercise, totalExercises, onComplete]);

  // ê±´ë„ˆë›°ê¸°
  const handleSkip = (reason?: string) => {
    setCompletedExercises(prev => [
      ...prev,
      {
        exerciseId: exercise.id,
        completedSets: currentSet - 1,
        actualDuration: 0,
        skipped: true,
        skipReason: reason,
      },
    ]);

    if (currentIndex < totalExercises - 1) {
      setCurrentIndex(prev => prev + 1);
      setCurrentSet(1);
    } else {
      onComplete(completedExercises);
    }
  };

  if (!exercise) return null;

  return (
    <div className="flex flex-col h-full" data-testid="session-player">
      {/* ì§„í–‰ ë°” */}
      <div className="h-1 bg-gray-200">
        <div
          className="h-full bg-module-workout transition-all"
          style={{ width: `${progress}%` }}
        />
      </div>

      {/* í—¤ë” */}
      <div className="p-4 flex justify-between items-center">
        <span className="text-sm text-muted-foreground">
          {currentIndex + 1}/{totalExercises} | ì„¸íŠ¸ {currentSet}/{currentStretch.adjustedSets}
        </span>
        <Button variant="ghost" size="sm" onClick={onExit}>
          ì¢…ë£Œ
        </Button>
      </div>

      {/* ìš´ë™ ì½˜í…ì¸  */}
      <div className="flex-1 px-4 pb-4 overflow-y-auto">
        <Card className="p-6">
          {/* ìš´ë™ ì´ë¦„ */}
          <h2 className="text-2xl font-bold mb-2">{exercise.nameKo}</h2>
          <p className="text-muted-foreground mb-4">{exercise.nameEn}</p>

          {/* ë¹„ë””ì˜¤/ì• ë‹ˆë©”ì´ì…˜ ì˜ì—­ */}
          <div className="aspect-video bg-gray-100 rounded-lg mb-4 flex items-center justify-center">
            {exercise.videoUrl ? (
              <video
                src={exercise.videoUrl}
                autoPlay
                loop
                muted
                playsInline
                className="w-full h-full object-cover rounded-lg"
              />
            ) : (
              <span className="text-muted-foreground">ì• ë‹ˆë©”ì´ì…˜ ì¤€ë¹„ ì¤‘</span>
            )}
          </div>

          {/* íƒ€ì´ë¨¸ */}
          <ExerciseTimer
            duration={currentStretch.adjustedDuration}
            unit={exercise.durationUnit}
            type={exercise.type}
            isPlaying={isPlaying}
            onComplete={handleTimerComplete}
            onPlayPause={() => setIsPlaying(prev => !prev)}
          />

          {/* í˜¸í¡ ê°€ì´ë“œ */}
          {exercise.type === 'static' && isPlaying && (
            <BreathingIndicator className="mt-4" />
          )}

          {/* ì„¤ëª… */}
          <div className="mt-4">
            <h3 className="font-semibold mb-2">ì‹¤í–‰ ë°©ë²•</h3>
            <ol className="list-decimal list-inside space-y-1 text-sm">
              {exercise.instructions.map((instruction, i) => (
                <li key={i}>{instruction}</li>
              ))}
            </ol>
          </div>

          {/* í”í•œ ì‹¤ìˆ˜ */}
          {exercise.commonMistakes.length > 0 && (
            <div className="mt-4 p-3 bg-yellow-50 rounded-lg">
              <h4 className="font-semibold text-yellow-800 mb-1">ì£¼ì˜ì‚¬í•­</h4>
              <ul className="text-sm text-yellow-700">
                {exercise.commonMistakes.map((mistake, i) => (
                  <li key={i}>â€¢ {mistake}</li>
                ))}
              </ul>
            </div>
          )}

          {/* Red Flags */}
          {exercise.redFlags.length > 0 && (
            <SafetyAlert
              title="ì¦‰ì‹œ ì¤‘ë‹¨"
              items={exercise.redFlags}
              severity="error"
              className="mt-4"
            />
          )}
        </Card>
      </div>

      {/* í•˜ë‹¨ ë²„íŠ¼ */}
      <div className="p-4 border-t flex gap-2">
        <Button
          variant="outline"
          className="flex-1"
          onClick={() => handleSkip('í†µì¦ ë°œìƒ')}
        >
          ê±´ë„ˆë›°ê¸°
        </Button>
        <Button
          className="flex-1"
          onClick={() => setIsPlaying(true)}
          disabled={isPlaying}
        >
          {isPlaying ? 'ì§„í–‰ ì¤‘...' : 'ì‹œì‘'}
        </Button>
      </div>
    </div>
  );
}
```

### 5.3 íƒ€ì´ë¨¸ ì»´í¬ë„ŒíŠ¸

```tsx
// components/stretching/ExerciseTimer.tsx
'use client';

import { useState, useEffect, useRef } from 'react';
import { StretchType } from '@/lib/stretching/types';
import { cn } from '@/lib/utils';

interface ExerciseTimerProps {
  duration: number;
  unit: 'seconds' | 'reps';
  type: StretchType;
  isPlaying: boolean;
  onComplete: () => void;
  onPlayPause: () => void;
}

export function ExerciseTimer({
  duration,
  unit,
  type,
  isPlaying,
  onComplete,
  onPlayPause,
}: ExerciseTimerProps) {
  const [timeLeft, setTimeLeft] = useState(duration);
  const [repsCompleted, setRepsCompleted] = useState(0);
  const intervalRef = useRef<NodeJS.Timeout | null>(null);

  // ì´ˆ ê¸°ë°˜ íƒ€ì´ë¨¸ (ì •ì  ìŠ¤íŠ¸ë ˆì¹­)
  useEffect(() => {
    if (unit !== 'seconds' || !isPlaying) return;

    intervalRef.current = setInterval(() => {
      setTimeLeft(prev => {
        if (prev <= 1) {
          clearInterval(intervalRef.current!);
          onComplete();
          return duration;
        }
        return prev - 1;
      });
    }, 1000);

    return () => {
      if (intervalRef.current) clearInterval(intervalRef.current);
    };
  }, [isPlaying, unit, duration, onComplete]);

  // íšŸìˆ˜ ê¸°ë°˜ (ë™ì  ìŠ¤íŠ¸ë ˆì¹­)
  const incrementReps = () => {
    if (repsCompleted + 1 >= duration) {
      setRepsCompleted(0);
      onComplete();
    } else {
      setRepsCompleted(prev => prev + 1);
    }
  };

  // ì›í˜• ì§„í–‰ ë°”
  const progressPercent = unit === 'seconds'
    ? ((duration - timeLeft) / duration) * 100
    : (repsCompleted / duration) * 100;

  const circumference = 2 * Math.PI * 45;
  const strokeDashoffset = circumference - (progressPercent / 100) * circumference;

  return (
    <div className="flex flex-col items-center" data-testid="exercise-timer">
      {/* ì›í˜• íƒ€ì´ë¨¸ */}
      <div className="relative w-32 h-32" onClick={unit === 'reps' ? incrementReps : onPlayPause}>
        <svg className="w-full h-full transform -rotate-90">
          {/* ë°°ê²½ ì› */}
          <circle
            cx="64"
            cy="64"
            r="45"
            fill="none"
            stroke="#e5e7eb"
            strokeWidth="8"
          />
          {/* ì§„í–‰ ì› */}
          <circle
            cx="64"
            cy="64"
            r="45"
            fill="none"
            stroke={type === 'static' ? '#10b981' : '#6366f1'}
            strokeWidth="8"
            strokeLinecap="round"
            strokeDasharray={circumference}
            strokeDashoffset={strokeDashoffset}
            className="transition-all duration-300"
          />
        </svg>

        {/* ì¤‘ì•™ í…ìŠ¤íŠ¸ */}
        <div className="absolute inset-0 flex flex-col items-center justify-center">
          {unit === 'seconds' ? (
            <>
              <span className="text-3xl font-bold">{timeLeft}</span>
              <span className="text-sm text-muted-foreground">ì´ˆ</span>
            </>
          ) : (
            <>
              <span className="text-3xl font-bold">{repsCompleted}</span>
              <span className="text-sm text-muted-foreground">/{duration}íšŒ</span>
            </>
          )}
        </div>
      </div>

      {/* íŒíŠ¸ */}
      <p className="mt-2 text-sm text-muted-foreground">
        {unit === 'seconds'
          ? (isPlaying ? 'í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ ì¼ì‹œì •ì§€' : 'í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ ì‹œì‘')
          : 'í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ íšŸìˆ˜ ì¹´ìš´íŠ¸'}
      </p>
    </div>
  );
}
```

---

## 6. ì•ˆì „ ì‹œìŠ¤í…œ

### 6.1 ê¸ˆê¸°ì‚¬í•­ ì²´í¬ íë¦„

```typescript
// lib/stretching/safety-check.ts

/**
 * ì•ˆì „ ì²´í¬ ê²°ê³¼
 */
export interface SafetyCheckResult {
  canProceed: boolean;
  level: 'safe' | 'caution' | 'warning' | 'blocked';
  messages: string[];
  blockedExercises: string[];
  modifiedExercises: { exerciseId: string; modification: string }[];
}

/**
 * ì ˆëŒ€ ê¸ˆê¸° ì¡°ê±´ (W-2-POSTURE-SAFETY ê¸°ë°˜)
 */
const ABSOLUTE_CONTRAINDICATIONS: Record<string, string[]> = {
  // ê²½ì¶” ìš´ë™ ê¸ˆê¸°
  cervical_exercises: [
    'spinal_instability',      // ì²™ì¶” ë¶ˆì•ˆì •ì„±
    'acute_cervical_fracture', // ê¸‰ì„± ê²½ì¶” ê³¨ì ˆ
    'cervical_dislocation',    // ê²½ì¶” íƒˆêµ¬
    'vertebral_artery_abnormality', // ì²™ì¶”ë™ë§¥ ì´ìƒ
  ],

  // ìš”ì¶” êµ´ê³¡ ê¸ˆê¸°
  lumbar_flexion: [
    'acute_disc_herniation',   // ê¸‰ì„± ë””ìŠ¤í¬ íƒˆì¶œ
    'spondylolisthesis',       // ì²™ì¶”ì „ë°©ì „ìœ„ì¦
  ],

  // ì–´ê¹¨ ìš´ë™ ê¸ˆê¸°
  shoulder_exercises: [
    'acute_rotator_cuff_tear', // ê¸‰ì„± íšŒì „ê·¼ê°œ íŒŒì—´
    'shoulder_dislocation',    // ì–´ê¹¨ íƒˆêµ¬
    'clavicle_fracture',       // ì‡„ê³¨ ê³¨ì ˆ
  ],

  // ë¬´ë¦ ìš´ë™ ê¸ˆê¸°
  knee_loading: [
    'severe_knee_osteoarthritis', // ì¤‘ì¦ ë¬´ë¦ ê³¨ê´€ì ˆì—¼
    'acute_ligament_injury',      // ê¸‰ì„± ì¸ëŒ€ ì†ìƒ
    'meniscus_tear_acute',        // ê¸‰ì„± ë°˜ì›”íŒ ì†ìƒ
  ],
};

/**
 * Red Flags (ì¦‰ì‹œ ì¤‘ë‹¨ ì‹ í˜¸)
 */
export const RED_FLAGS = {
  neurological: [
    'ë°©ì‚¬í†µ (íŒ”/ë‹¤ë¦¬ë¡œ í¼ì§€ëŠ” í†µì¦)',
    'ì €ë¦¼, ë¬´ê°ê°, ë”°ë”ê±°ë¦¼',
    'ê°‘ì‘ìŠ¤ëŸ¬ìš´ ê·¼ë ¥ ì €í•˜',
  ],
  emergency: [
    'ë°°ë³€/ë°°ë‡¨ ì¥ì•  (ë§ˆë¯¸ì¦í›„êµ° - ì‘ê¸‰)',
    'ì•ˆì¥ ê°ê°ì´ìƒ (íšŒìŒë¶€ ê°ê° ìƒì‹¤)',
  ],
  cardiovascular: [
    'ì–´ì§€ëŸ¬ì›€, ì‹¤ì‹ ',
    'í‰í†µ + í˜¸í¡ê³¤ë€',
  ],
  musculoskeletal: [
    '"ëš" ì†Œë¦¬ì™€ í•¨ê»˜ ê¸‰ì„± í†µì¦',
    'ê´€ì ˆ ì ê¹€ í˜„ìƒ',
  ],
};

/**
 * ì‚¬ìš©ì ì¡°ê±´ ê¸°ë°˜ ì•ˆì „ ì²´í¬
 */
export function performSafetyCheck(
  userProfile: StretchingUserProfile,
  targetExercises: StretchExercise[]
): SafetyCheckResult {
  const messages: string[] = [];
  const blockedExercises: string[] = [];
  const modifiedExercises: { exerciseId: string; modification: string }[] = [];

  // 1. ì ˆëŒ€ ê¸ˆê¸° ì²´í¬
  for (const exercise of targetExercises) {
    for (const [category, conditions] of Object.entries(ABSOLUTE_CONTRAINDICATIONS)) {
      const hasContraindication = conditions.some(c =>
        userProfile.contraindications.includes(c)
      );

      if (hasContraindication && exerciseMatchesCategory(exercise, category)) {
        blockedExercises.push(exercise.id);
        messages.push(
          `${exercise.nameKo}: í˜„ì¬ ê±´ê°• ìƒíƒœë¡œ ì¸í•´ ì´ ìš´ë™ì€ ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ` +
          'ì „ë¬¸ê°€ ìƒë‹´ í›„ ì§„í–‰í•˜ì„¸ìš”.'
        );
      }
    }
  }

  // 2. íŠ¹ìˆ˜ ì¡°ê±´ ì²´í¬
  if (userProfile.specialConditions.includes('pregnancy')) {
    const supineExercises = targetExercises.filter(e =>
      e.id.includes('supine') && !e.modifications.some(m => m.condition === 'ì„ì‚°ë¶€')
    );
    for (const exercise of supineExercises) {
      modifiedExercises.push({
        exerciseId: exercise.id,
        modification: 'ì„ì‚°ë¶€: 2ì‚¼ë¶„ê¸° ì´í›„ ì¢Œì¸¡ ì¸¡ì™€ìœ„ë¡œ ë³€ê²½',
      });
    }
    messages.push('ì„ì‚°ë¶€ ì£¼ì˜: ì•™ì™€ìœ„(ëˆ„ìš´ ìì„¸) ìš´ë™ ì‹œ ì¢Œì¸¡ìœ¼ë¡œ ëˆ•ê¸°');
  }

  if (userProfile.specialConditions.includes('osteoporosis')) {
    const flexionExercises = targetExercises.filter(e =>
      e.targetMuscles.includes('rectus_abdominis') &&
      e.type === 'dynamic'
    );
    for (const exercise of flexionExercises) {
      blockedExercises.push(exercise.id);
    }
    if (flexionExercises.length > 0) {
      messages.push('ê³¨ë‹¤ê³µì¦: ì²™ì¶” êµ´ê³¡ ìš´ë™(í¬ëŸ°ì¹˜ ë“±) ì œì™¸ë¨');
    }
  }

  // 3. ê²°ê³¼ ë ˆë²¨ ê²°ì •
  let level: 'safe' | 'caution' | 'warning' | 'blocked';
  if (blockedExercises.length > targetExercises.length * 0.5) {
    level = 'blocked';
    messages.unshift('ëŒ€ë¶€ë¶„ì˜ ìš´ë™ì´ í˜„ì¬ ìƒíƒœì—ì„œ ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì „ë¬¸ê°€ ìƒë‹´ì´ í•„ìš”í•©ë‹ˆë‹¤.');
  } else if (blockedExercises.length > 0) {
    level = 'warning';
  } else if (modifiedExercises.length > 0 || messages.length > 0) {
    level = 'caution';
  } else {
    level = 'safe';
  }

  return {
    canProceed: level !== 'blocked',
    level,
    messages,
    blockedExercises,
    modifiedExercises,
  };
}

function exerciseMatchesCategory(exercise: StretchExercise, category: string): boolean {
  const categoryMuscles: Record<string, MuscleGroup[]> = {
    cervical_exercises: ['deep_neck_flexors', 'sternocleidomastoid', 'upper_trapezius'],
    lumbar_flexion: ['rectus_abdominis'],
    shoulder_exercises: ['rotator_cuff', 'deltoid', 'pectoralis_major'],
    knee_loading: ['quadriceps', 'hamstrings'],
  };

  const muscles = categoryMuscles[category] || [];
  return exercise.targetMuscles.some(m => muscles.includes(m));
}
```

### 6.2 ì˜ë£Œ ë©´ì±…ì¡°í•­

```typescript
// lib/stretching/disclaimers.ts

export const STRETCHING_DISCLAIMERS = {
  general: `
ì´ ìŠ¤íŠ¸ë ˆì¹­ ê°€ì´ë“œëŠ” ì¼ë°˜ì ì¸ ì›°ë‹ˆìŠ¤ ì •ë³´ì´ë©°, ì˜ë£Œ ì§„ë‹¨ì´ë‚˜ ë¬¼ë¦¬ì¹˜ë£Œë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ìš´ë™ ì‹œì‘ ì „ ì£¼ì˜ì‚¬í•­:
â€¢ ê¸°ì¡´ ë¶€ìƒì´ë‚˜ ê±´ê°• ë¬¸ì œê°€ ìˆëŠ” ê²½ìš° ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì„¸ìš”.
â€¢ í†µì¦ì´ ë°œìƒí•˜ë©´ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ì„¸ìš”.
â€¢ ë¬´ë¦¬í•˜ì§€ ë§ê³  ë³¸ì¸ì˜ í•œê³„ ë‚´ì—ì„œ ìˆ˜í–‰í•˜ì„¸ìš”.
`.trim(),

  redFlags: `
ğŸš¨ ë‹¤ìŒ ì¦ìƒ ë°œìƒ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³  ì „ë¬¸ì˜ ìƒë‹´:

â€¢ ë°©ì‚¬í†µ (íŒ”/ë‹¤ë¦¬ë¡œ í¼ì§€ëŠ” í†µì¦)
â€¢ ì €ë¦¼, ë¬´ê°ê°, ê·¼ë ¥ ì €í•˜
â€¢ ë°°ë³€/ë°°ë‡¨ ì¥ì•  (ì‘ê¸‰ìƒí™©)
â€¢ ì–´ì§€ëŸ¬ì›€, ì‹¤ì‹ 
â€¢ ê°‘ì‘ìŠ¤ëŸ¬ìš´ ë‚ ì¹´ë¡œìš´ í†µì¦
`.trim(),

  postureCorrection: `
ìì„¸êµì • ìŠ¤íŠ¸ë ˆì¹­ ê´€ë ¨ ì£¼ì˜:

â€¢ AI ê¸°ë°˜ ìì„¸ ë¶„ì„ì€ ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì§„ë‹¨ì€ ì „ë¬¸ê°€ì—ê²Œ ë°›ìœ¼ì„¸ìš”.
â€¢ ì‹¬ê°í•œ ìì„¸ ë¶ˆê· í˜•(CVA < 40Â° ë“±)ì€ ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ìƒë‹´ ê¶Œì¥
â€¢ êµì • ìš´ë™ì€ ì ì§„ì ìœ¼ë¡œ ì§„í–‰í•˜ë©°, í†µì¦ ì‹œ ì¤‘ë‹¨
`.trim(),

  sport: `
ìŠ¤í¬ì¸  ìŠ¤íŠ¸ë ˆì¹­ ê´€ë ¨ ì£¼ì˜:

â€¢ ìš´ë™ ì „: ë™ì  ìŠ¤íŠ¸ë ˆì¹­ ê¶Œì¥ (7-10ë¶„)
â€¢ ìš´ë™ í›„: ì •ì  ìŠ¤íŠ¸ë ˆì¹­ ê¶Œì¥ (10-15ë¶„)
â€¢ 60ì´ˆ ì´ìƒ ì •ì  ìŠ¤íŠ¸ë ˆì¹­ í›„ ì¦‰ì‹œ ê³ ê°•ë„ ìš´ë™ í”¼í•˜ê¸°
`.trim(),

  pnf: `
PNF ìŠ¤íŠ¸ë ˆì¹­ ê´€ë ¨ ì£¼ì˜:

â€¢ ìš´ë™ í›„ì—ë§Œ ìˆ˜í–‰ (ìš´ë™ ì „ ìˆ˜í–‰ ì‹œ í¼í¬ë¨¼ìŠ¤ ì €í•˜)
â€¢ íŒŒíŠ¸ë„ˆ ë˜ëŠ” ë³´ì¡° ë„êµ¬ í•„ìš”
â€¢ 50% ì´í•˜ ê°•ë„ë¡œ ìˆ˜ì¶• (ê³¼ë„í•œ í˜ ê¸ˆì§€)
â€¢ ê³ ë ¹ìëŠ” ë³´ìˆ˜ì  í”„ë¡œí† ì½œ ì ìš©
`.trim(),
};
```

---

## 7. P3 ì›ì ë¶„í•´

> **P3 ì›ì¹™**: ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ìµœì†Œ ë‹¨ìœ„ë¡œ ë¶„í•´
>
> ê¸°ì¡´ 30ê°œ ì›ìë¥¼ 12ê°œ í•µì‹¬ ì›ìë¡œ í†µí•©í•˜ì—¬ ê°œë°œ íš¨ìœ¨ì„± ë° ì¶”ì ì„± í–¥ìƒ

### 7.1 í•µì‹¬ ì›ì ëª©ë¡ (12ê°œ, ì´ 19ì‹œê°„)

| ID | ì›ìëª… | ì†Œìš”ì‹œê°„ | ì…ë ¥ | ì¶œë ¥ | ì„±ê³µ ê¸°ì¤€ | ì˜ì¡´ì„± | ë³‘ë ¬ ê°€ëŠ¥ |
|----|--------|----------|------|------|----------|--------|----------|
| W-2.1 | C-2 ìì„¸ ë°ì´í„° ìˆ˜ì‹  | 1.5h | C-2 ë¶„ì„ ê²°ê³¼ | W-2 í†µí•© ë°ì´í„° | íƒ€ì… ë³€í™˜ ì •í™•ë„ 100%, ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 3ê°œ+ | - | No (ì‹œì‘ì ) |
| W-2.2 | Janda Cross Syndrome ë¶„ì„ | 2h | ìì„¸ ë°ì´í„° | UCS/LCS ì§„ë‹¨ | ì§„ë‹¨ ì¼ì¹˜ìœ¨ 90%+, í…ŒìŠ¤íŠ¸ 5ê°œ+ í†µê³¼ | W-2.1 | No |
| W-2.3 | ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ ë§¤í•‘ | 2h | UCS/LCS ê²°ê³¼ | ì²˜ë°© ë¦¬ìŠ¤íŠ¸ | í”„ë¡œí† ì½œ ì»¤ë²„ë¦¬ì§€ 100%, ë§¤í•‘ í…ŒìŠ¤íŠ¸ í†µê³¼ | W-2.2 | No |
| W-2.4 | ìŠ¤í¬ì¸ ë³„ ë£¨í‹´ ìƒì„± | 1.5h | ìŠ¤í¬ì¸  íƒ€ì… | ì „ìš© ë£¨í‹´ | 6ê°œ ìŠ¤í¬ì¸  ì§€ì›, ë£¨í‹´ ìƒì„± í…ŒìŠ¤íŠ¸ í†µê³¼ | - | Yes (W-2.1~3ê³¼ ë³‘ë ¬) |
| W-2.5 | ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§ | 1.5h | ì²˜ë°© + ì‚¬ìš©ì ì •ë³´ | ì•ˆì „ ì²˜ë°© | False positive < 5%, ì•ˆì „ì„± í…ŒìŠ¤íŠ¸ í†µê³¼ | W-2.3 | Yes (W-2.6ê³¼) |
| W-2.6 | ì—°ë ¹ë³„ ì¡°ì • | 1h | ì²˜ë°© + ì—°ë ¹ | ì¡°ì •ëœ ì²˜ë°© | ACSM ê°€ì´ë“œë¼ì¸ ì¤€ìˆ˜, ì—°ë ¹ëŒ€ë³„ í…ŒìŠ¤íŠ¸ í†µê³¼ | W-2.3 | Yes (W-2.5ì™€) |
| W-2.7 | ì²˜ë°© API êµ¬í˜„ | 2h | HTTP Request | JSON Response | ì‘ë‹µ < 500ms, 200/400/401 í…ŒìŠ¤íŠ¸ í†µê³¼ | W-2.3, W-2.5, W-2.6 | No |
| W-2.8 | ì„¸ì…˜ í”Œë ˆì´ì–´ UI | 2h | ë£¨í‹´ ë°ì´í„° | ì¸í„°ë™í‹°ë¸Œ UI | íƒ€ì´ë¨¸/í˜¸í¡ ê°€ì´ë“œ í¬í•¨, ë Œë”ë§ í…ŒìŠ¤íŠ¸ í†µê³¼ | W-2.7 | No |
| W-2.9 | ì§„í–‰ ì¶”ì  ì‹œìŠ¤í…œ | 1.5h | ì„¸ì…˜ ì™„ë£Œ ì´ë²¤íŠ¸ | í†µê³„ ë°ì´í„° | ì£¼ê°„/ì›”ê°„ ì§‘ê³„ ì •í™•, DB ì €ì¥ í…ŒìŠ¤íŠ¸ í†µê³¼ | W-2.8 | Yes (W-2.10ê³¼) |
| W-2.10 | ë£¨í‹´ ì €ì¥/ì´ë ¥ | 1.5h | ì‚¬ìš©ì ë£¨í‹´ | DB ì €ì¥ | RLS ì •ì±… ì ìš©, CRUD í…ŒìŠ¤íŠ¸ í†µê³¼ | W-2.7, W-2.9 | Yes (W-2.9ì™€) |
| W-2.11 | ì•ˆì „ ê°€ì´ë“œ ì‹œìŠ¤í…œ | 1h | ìš´ë™ ID | ê²½ê³  ì •ë³´ | ì˜ë£Œ ë©´ì±… í¬í•¨, ê²½ê³  í‘œì‹œ í…ŒìŠ¤íŠ¸ í†µê³¼ | - | Yes (ë…ë¦½) |
| W-2.12 | í†µí•© í…ŒìŠ¤íŠ¸ | 1.5h | ì „ì²´ ëª¨ë“ˆ | í…ŒìŠ¤íŠ¸ ê²°ê³¼ | ì»¤ë²„ë¦¬ì§€ 80%+, E2E í”Œë¡œìš° í†µê³¼ | W-2.1~W-2.11 | No (ìµœì¢…) |

**ì´ê³„**: 12ê°œ ì›ì, 19ì‹œê°„

> **P3 ì›ì¹™ ì¤€ìˆ˜**: ëª¨ë“  ì›ìê°€ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•˜ë©°, 2ì‹œê°„ ì´ë‚´ë¡œ ì™„ë£Œ ê°€ëŠ¥ (ìµœëŒ€ 2h)

### 7.2 ì˜ì¡´ì„± ê·¸ë˜í”„

```mermaid
graph TD
    subgraph Phase1["Phase 1: ë°ì´í„° ìˆ˜ì‹ /ë¶„ì„ (ìˆœì°¨)"]
        W2-1[W-2.1: C-2 ìì„¸ ë°ì´í„° ìˆ˜ì‹ ]
        W2-2[W-2.2: Janda Cross Syndrome ë¶„ì„]
        W2-3[W-2.3: ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ ë§¤í•‘]
    end

    subgraph Phase2["Phase 2: ì²˜ë°© ì¡°ì • (ë³‘ë ¬ ê°€ëŠ¥)"]
        W2-4[W-2.4: ìŠ¤í¬ì¸ ë³„ ë£¨í‹´ ìƒì„±]
        W2-5[W-2.5: ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§]
        W2-6[W-2.6: ì—°ë ¹ë³„ ì¡°ì •]
    end

    subgraph Phase3["Phase 3: API êµ¬í˜„"]
        W2-7[W-2.7: ì²˜ë°© API êµ¬í˜„]
    end

    subgraph Phase4["Phase 4: UI/ì €ì¥ (ë³‘ë ¬ ê°€ëŠ¥)"]
        W2-8[W-2.8: ì„¸ì…˜ í”Œë ˆì´ì–´ UI]
        W2-9[W-2.9: ì§„í–‰ ì¶”ì  ì‹œìŠ¤í…œ]
        W2-10[W-2.10: ë£¨í‹´ ì €ì¥/ì´ë ¥]
    end

    subgraph Independent["ë…ë¦½ ëª¨ë“ˆ"]
        W2-11[W-2.11: ì•ˆì „ ê°€ì´ë“œ ì‹œìŠ¤í…œ]
    end

    subgraph Phase5["Phase 5: ê²€ì¦"]
        W2-12[W-2.12: í†µí•© í…ŒìŠ¤íŠ¸]
    end

    W2-1 --> W2-2
    W2-2 --> W2-3
    W2-3 --> W2-5
    W2-3 --> W2-6
    W2-4 --> W2-7
    W2-5 --> W2-7
    W2-6 --> W2-7
    W2-7 --> W2-8
    W2-7 --> W2-10
    W2-8 --> W2-9
    W2-9 --> W2-10
    W2-8 --> W2-12
    W2-9 --> W2-12
    W2-10 --> W2-12
    W2-11 --> W2-12

    style Phase1 fill:#e1f5fe
    style Phase2 fill:#fff3e0
    style Phase3 fill:#e8f5e9
    style Phase4 fill:#fce4ec
    style Independent fill:#f3e5f5
    style Phase5 fill:#e0f7fa
```

### 7.3 ê°œë°œ ì˜ì—­ë³„ ë¶„ë¥˜

| ì˜ì—­ | ì›ì | ì‹œê°„ | ë¹„ê³  |
|------|------|------|------|
| **ë°ì´í„°/ë¶„ì„** | W-2.1, W-2.2, W-2.3 | 5.5h | C-2 í†µí•©, Janda ë¶„ì„ |
| **ì²˜ë°© ë¡œì§** | W-2.4, W-2.5, W-2.6 | 4h | ìŠ¤í¬ì¸ ë³„, ì•ˆì „ í•„í„°ë§ |
| **API** | W-2.7 | 2h | REST API ì—”ë“œí¬ì¸íŠ¸ |
| **UI** | W-2.8 | 2h | ì„¸ì…˜ í”Œë ˆì´ì–´ |
| **ì €ì¥/ì¶”ì ** | W-2.9, W-2.10 | 3h | ì´ë ¥ ê´€ë¦¬ |
| **ì•ˆì „/í…ŒìŠ¤íŠ¸** | W-2.11, W-2.12 | 2.5h | ë©´ì±…, í…ŒìŠ¤íŠ¸ |
| **ì´ê³„** | **12ê°œ** | **19h** | - |

### 7.4 í•µì‹¬ ì›ì ìƒì„¸

> 12ê°œ í†µí•© ì›ìì— ëŒ€í•œ ìƒì„¸ ì •ì˜

---

#### W-2.1: C-2 ìì„¸ ë°ì´í„° ìˆ˜ì‹  (1.5ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 1.5ì‹œê°„
- **ì˜ì¡´ì„±**: ì—†ìŒ (C-2 ëª¨ë“ˆ ì¶œë ¥ ìˆ˜ì‹ )
- **ë³‘ë ¬ ê°€ëŠ¥**: No (ì‹œì‘ì )

**ì…ë ¥ ìŠ¤í™**

```typescript
// C-2 ëª¨ë“ˆì—ì„œ ì „ë‹¬ë°›ëŠ” ë°ì´í„°
interface C2AnalysisOutput {
  analysisId: string;
  userId: string;
  analyzedAt: string;
  confidence: number;

  // MediaPipe ê¸°ë°˜ ìì„¸ ê°ë„
  postureAngles: {
    cva: number;              // Craniovertebral Angle (ì •ìƒ: >50Â°)
    thoracicKyphosis: number; // í‰ì¶” í›„ë§Œê° (ì •ìƒ: 20-40Â°)
    lumbarLordosis: number;   // ìš”ì¶” ì „ë§Œê° (ì •ìƒ: 40-60Â°)
    shoulderTilt: number;     // ì–´ê¹¨ ê¸°ìš¸ê¸° (ì •ìƒ: 0Â°)
    pelvicTilt: number;       // ê³¨ë°˜ ê¸°ìš¸ê¸° (ì •ìƒ: 0-10Â°)
    kneeFlex: number;         // ë¬´ë¦ êµ´ê³¡ (ì •ìƒ: 0-5Â°)
  };

  // Janda Cross Syndrome ì§„ë‹¨
  jandaSyndrome: {
    upperCross: JandaUpperCrossResult;
    lowerCross: JandaLowerCrossResult;
  };
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
// W-2 ë‚´ë¶€ í†µí•© ë°ì´í„° í˜•ì‹
interface W2IntegratedPostureData {
  source: {
    moduleId: 'C-2';
    analysisId: string;
    analyzedAt: string;
    confidence: number;
  };

  normalizedAngles: NormalizedPostureAngles;
  jandaResults: JandaIntegrationResults;
  stretchingPriority: StretchingPriorityList;
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] C-2 ë¶„ì„ ê²°ê³¼ íƒ€ì… ì •í™•íˆ ìˆ˜ì‹ 
- [ ] ì •ê·œí™”ëœ ê°ë„ ë°ì´í„° ë³€í™˜ (0-100 ìŠ¤ì¼€ì¼)
- [ ] Janda Cross Syndrome ê²°ê³¼ í†µí•©
- [ ] ìŠ¤íŠ¸ë ˆì¹­ ìš°ì„ ìˆœìœ„ ë¦¬ìŠ¤íŠ¸ ìƒì„±
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 3ê°œ ì´ìƒ
- [ ] typecheck í†µê³¼

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/lib/stretching/c2-integration.ts` | ì‹ ê·œ | C-2 í†µí•© ë¡œì§ |
| `apps/web/lib/stretching/types/c2-types.ts` | ì‹ ê·œ | C-2 ê´€ë ¨ íƒ€ì… |
| `apps/web/tests/lib/stretching/c2-integration.test.ts` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.2: Janda Cross Syndrome ë¶„ì„ (2ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 2ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.1 (C-2 ìì„¸ ë°ì´í„° ìˆ˜ì‹ )
- **ë³‘ë ¬ ê°€ëŠ¥**: No

**ì…ë ¥ ìŠ¤í™**

```typescript
interface JandaAnalysisInput {
  postureData: W2IntegratedPostureData;
  analysisDepth: 'basic' | 'detailed';
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface JandaAnalysisResult {
  upperCross: {
    detected: boolean;
    severity: 'none' | 'mild' | 'moderate' | 'severe';
    tightMuscles: TightMuscleInfo[];
    weakMuscles: WeakMuscleInfo[];
    associatedPostures: PosturePattern[];
  };
  lowerCross: {
    detected: boolean;
    severity: 'none' | 'mild' | 'moderate' | 'severe';
    tightMuscles: TightMuscleInfo[];
    weakMuscles: WeakMuscleInfo[];
    associatedPostures: PosturePattern[];
  };
  combinedRecommendation: {
    priorityMuscles: string[];
    stretchingFirst: boolean;
    activationFirst: boolean;
    estimatedWeeks: number;
  };
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] UCS 4ë‹¨ê³„ severity íŒì • (none/mild/moderate/severe)
- [ ] LCS 4ë‹¨ê³„ severity íŒì •
- [ ] ê¸´ì¥/ì•½í™” ê·¼ìœ¡ ì •í™• ì‹ë³„
- [ ] ë³µí•© ì¦í›„êµ° ëŒ€ì‘ ë¡œì§
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 4ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/lib/stretching/janda-analyzer.ts` | ì‹ ê·œ | Janda ë¶„ì„ ë¡œì§ |
| `apps/web/tests/lib/stretching/janda-analyzer.test.ts` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.3: ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ ë§¤í•‘ (2ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 2ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.2 (Janda Cross Syndrome ë¶„ì„)
- **ë³‘ë ¬ ê°€ëŠ¥**: No

**ì…ë ¥ ìŠ¤í™**

```typescript
interface ProtocolMappingInput {
  jandaResult: JandaAnalysisResult;
  userProfile: StretchingUserProfile;
  preferences: {
    maxDuration: number;      // ìµœëŒ€ ì†Œìš”ì‹œê°„ (ë¶„)
    equipmentAvailable: Equipment[];
    preferredTechnique: 'static' | 'dynamic' | 'pnf' | 'mixed';
  };
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface ProtocolMappingResult {
  stretches: PrescribedStretch[];
  activations: ActivationExercise[];
  totalDuration: number;
  weeklyPlan: WeeklyStretchingPlan;
  progressionPath: ProgressionPhase[];
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] UCS severityë³„ ìŠ¤íŠ¸ë ˆì¹­ ë§¤í•‘ (Section 2.6 ì°¸ì¡°)
- [ ] LCS severityë³„ ìŠ¤íŠ¸ë ˆì¹­ ë§¤í•‘
- [ ] ë³µí•© ì¦í›„êµ° ì‹œ í†µí•© ì²˜ë°©
- [ ] ì£¼ê°„ í”Œëœ ìë™ ìƒì„±
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 5ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/lib/stretching/protocol-mapper.ts` | ì‹ ê·œ | í”„ë¡œí† ì½œ ë§¤í•‘ |
| `apps/web/lib/stretching/data/ucs-protocols.ts` | ì‹ ê·œ | UCS í”„ë¡œí† ì½œ ë°ì´í„° |
| `apps/web/lib/stretching/data/lcs-protocols.ts` | ì‹ ê·œ | LCS í”„ë¡œí† ì½œ ë°ì´í„° |
| `apps/web/tests/lib/stretching/protocol-mapper.test.ts` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.4: ìŠ¤í¬ì¸ ë³„ ë£¨í‹´ ìƒì„± (1.5ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 1.5ì‹œê°„
- **ì˜ì¡´ì„±**: ì—†ìŒ (ë…ë¦½ ëª¨ë“ˆ)
- **ë³‘ë ¬ ê°€ëŠ¥**: Yes

**ì…ë ¥ ìŠ¤í™**

```typescript
interface SportsRoutineInput {
  sports: SportType[];
  timing: 'pre' | 'post';
  duration: number;         // ì›í•˜ëŠ” ì†Œìš”ì‹œê°„ (ë¶„)
  userLevel: 'beginner' | 'intermediate' | 'advanced';
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface SportsRoutineResult {
  stretches: SportStretch[];
  warmUpPhase?: WarmUpPhase;   // preì¼ ë•Œë§Œ
  coolDownPhase?: CoolDownPhase; // postì¼ ë•Œë§Œ
  focusMuscles: string[];
  sportSpecificTips: string[];
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] 6ê°œ ìŠ¤í¬ì¸  ì§€ì› (ëŸ¬ë‹, ê³¨í”„, ë“±ì‚°, ìˆ˜ì˜, í…Œë‹ˆìŠ¤, ë°ìŠ¤í¬ì›Œí¬)
- [ ] Pre/Post íƒ€ì´ë°ë³„ ë‹¤ë¥¸ ë£¨í‹´
- [ ] Section 2.7 í”„ë¡œí† ì½œ ë°˜ì˜
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 4ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/lib/stretching/sports-routine.ts` | ì‹ ê·œ | ìŠ¤í¬ì¸  ë£¨í‹´ ìƒì„± |
| `apps/web/lib/stretching/data/sports-protocols.ts` | ì‹ ê·œ | ìŠ¤í¬ì¸  í”„ë¡œí† ì½œ |
| `apps/web/tests/lib/stretching/sports-routine.test.ts` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.5: ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§ (1.5ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 1.5ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.3 (ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ ë§¤í•‘)
- **ë³‘ë ¬ ê°€ëŠ¥**: Yes (W-2.6ê³¼ ë³‘ë ¬)

**ì…ë ¥ ìŠ¤í™**

```typescript
interface ContraindicationInput {
  prescription: ProtocolMappingResult;
  userHealth: {
    conditions: HealthCondition[];
    injuries: RecentInjury[];
    medications: string[];
  };
}

type HealthCondition =
  | 'pregnancy' | 'hypertension' | 'hypotension'
  | 'spinal_issue' | 'osteoporosis' | 'joint_replacement'
  | 'heart_condition' | 'vertigo' | 'herniated_disc';
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface ContraindicationResult {
  safePrescription: FilteredPrescription;
  excludedExercises: ExcludedExercise[];
  warnings: SafetyWarning[];
  disclaimerRequired: boolean;
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] 9ê°œ ì´ìƒ ê±´ê°• ìƒíƒœ í•„í„°ë§
- [ ] ë¶€ìƒ ë¶€ìœ„ë³„ ì œì™¸ ë¡œì§
- [ ] ì œì™¸ ì‚¬ìœ  ëª…í™• ê¸°ë¡
- [ ] False positive < 5%
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 4ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/lib/stretching/contraindication-filter.ts` | ì‹ ê·œ | ê¸ˆê¸°ì‚¬í•­ í•„í„° |
| `apps/web/lib/stretching/data/contraindication-map.ts` | ì‹ ê·œ | ê¸ˆê¸°ì‚¬í•­ ë§¤í•‘ |
| `apps/web/tests/lib/stretching/contraindication-filter.test.ts` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.6: ì—°ë ¹ë³„ ì¡°ì • (1ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 1ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.3 (ìŠ¤íŠ¸ë ˆì¹­ í”„ë¡œí† ì½œ ë§¤í•‘)
- **ë³‘ë ¬ ê°€ëŠ¥**: Yes (W-2.5ì™€ ë³‘ë ¬)

**ì…ë ¥ ìŠ¤í™**

```typescript
interface AgeAdjustmentInput {
  prescription: FilteredPrescription;
  userAge: number;
  fitnessLevel: 'sedentary' | 'lightly_active' | 'active' | 'very_active';
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface AgeAdjustedPrescription {
  exercises: AdjustedExercise[];
  adjustments: {
    durationMultiplier: number;    // 0.7 ~ 1.2
    intensityReduction: number;    // 0 ~ 30%
    restPeriodIncrease: number;    // 0 ~ 50%
  };
  ageSpecificWarnings: string[];
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] ACSM ê°€ì´ë“œë¼ì¸ ì¤€ìˆ˜
- [ ] ì—°ë ¹ëŒ€ë³„ ì¡°ì • ê³„ìˆ˜ (ì²­ì†Œë…„, ì„±ì¸, ì¤‘ë…„, ë…¸ë…„)
- [ ] ì²´ë ¥ ìˆ˜ì¤€ ë°˜ì˜
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 3ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/lib/stretching/age-adjustment.ts` | ì‹ ê·œ | ì—°ë ¹ë³„ ì¡°ì • |
| `apps/web/tests/lib/stretching/age-adjustment.test.ts` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.7: ì²˜ë°© API êµ¬í˜„ (2ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 2ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.3, W-2.5, W-2.6
- **ë³‘ë ¬ ê°€ëŠ¥**: No (ë¡œì§ í†µí•© í•„ìš”)

**ì…ë ¥ ìŠ¤í™**

```typescript
// POST /api/v2/stretching/prescribe
interface PrescribeRequest {
  source: 'janda' | 'sports' | 'custom';
  c2AnalysisId?: string;        // janda ì†ŒìŠ¤ì¼ ë•Œ
  sports?: SportType[];         // sports ì†ŒìŠ¤ì¼ ë•Œ
  timing?: 'pre' | 'post';
  preferences?: UserPreferences;
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface PrescribeResponse {
  success: boolean;
  data: {
    prescriptionId: string;
    routine: StretchingRoutine;
    metadata: {
      generatedAt: string;
      source: string;
      duration: number;
      exerciseCount: number;
    };
  };
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] 3ê°€ì§€ ì†ŒìŠ¤ (janda/sports/custom) ì§€ì›
- [ ] Clerk ì¸ì¦ í™•ì¸
- [ ] Rate Limit ì ìš© (30 req/1h)
- [ ] ì‘ë‹µ ì‹œê°„ < 500ms
- [ ] DB ì €ì¥ (stretching_prescriptions)
- [ ] í†µí•© í…ŒìŠ¤íŠ¸ 5ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/app/api/v2/stretching/prescribe/route.ts` | ì‹ ê·œ | ì²˜ë°© API |
| `apps/web/app/api/v2/stretching/prescribe/janda/route.ts` | ì‹ ê·œ | Janda ì „ìš© |
| `apps/web/app/api/v2/stretching/prescribe/sport/route.ts` | ì‹ ê·œ | ìŠ¤í¬ì¸  ì „ìš© |
| `apps/web/tests/api/stretching/prescribe.test.ts` | ì‹ ê·œ | API í…ŒìŠ¤íŠ¸ |

---

#### W-2.8: ì„¸ì…˜ í”Œë ˆì´ì–´ UI (2ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 2ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.7 (ì²˜ë°© API êµ¬í˜„)
- **ë³‘ë ¬ ê°€ëŠ¥**: Yes (W-2.9, W-2.10ê³¼ ë³‘ë ¬)

**ì…ë ¥ ìŠ¤í™**

```typescript
interface SessionPlayerProps {
  routine: StretchingRoutine;
  onComplete: (result: SessionResult) => void;
  onPause: () => void;
  onSkipExercise: (exerciseId: string, reason?: string) => void;
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface SessionResult {
  completedExercises: CompletedExercise[];
  skippedExercises: SkippedExercise[];
  totalDuration: number;
  completionRate: number;
  userFeedback?: UserFeedback;
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] ìš´ë™ë³„ íƒ€ì´ë¨¸ (ìë™ ì¹´ìš´íŠ¸ë‹¤ìš´)
- [ ] í˜¸í¡ ê°€ì´ë“œ (ë“¤ìˆ¨/ë‚ ìˆ¨ ì‹œê°í™”)
- [ ] ì„¸íŠ¸ê°„ íœ´ì‹ íƒ€ì´ë¨¸
- [ ] ìš´ë™ ê±´ë„ˆë›°ê¸° ê¸°ëŠ¥
- [ ] ì¼ì‹œì •ì§€/ì¬ê°œ ê¸°ëŠ¥
- [ ] ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ 4ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/components/stretching/SessionPlayer.tsx` | ì‹ ê·œ | ì„¸ì…˜ í”Œë ˆì´ì–´ |
| `apps/web/components/stretching/ExerciseTimer.tsx` | ì‹ ê·œ | íƒ€ì´ë¨¸ |
| `apps/web/components/stretching/BreathingGuide.tsx` | ì‹ ê·œ | í˜¸í¡ ê°€ì´ë“œ |
| `apps/web/tests/components/stretching/SessionPlayer.test.tsx` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.9: ì§„í–‰ ì¶”ì  ì‹œìŠ¤í…œ (1.5ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 1.5ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.8 (ì„¸ì…˜ í”Œë ˆì´ì–´ UI)
- **ë³‘ë ¬ ê°€ëŠ¥**: Yes

**ì…ë ¥ ìŠ¤í™**

```typescript
interface ProgressTrackingInput {
  userId: string;
  dateRange: { start: Date; end: Date };
  groupBy: 'day' | 'week' | 'month';
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface ProgressTrackingResult {
  summary: {
    totalSessions: number;
    totalMinutes: number;
    averageCompletionRate: number;
    streakDays: number;
  };
  timeline: TimelineEntry[];
  muscleGroupProgress: MuscleProgress[];
  achievements: Achievement[];
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] ì¼ê°„/ì£¼ê°„/ì›”ê°„ ì§‘ê³„
- [ ] ìŠ¤íŠ¸ë¦­ ê³„ì‚° (ì—°ì† ì¼ìˆ˜)
- [ ] ê·¼ìœ¡êµ°ë³„ ì§„í–‰ ìƒí™©
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 3ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/lib/stretching/progress-tracker.ts` | ì‹ ê·œ | ì§„í–‰ ì¶”ì  |
| `apps/web/components/stretching/ProgressDashboard.tsx` | ì‹ ê·œ | ëŒ€ì‹œë³´ë“œ |
| `apps/web/tests/lib/stretching/progress-tracker.test.ts` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.10: ë£¨í‹´ ì €ì¥/ì´ë ¥ (1.5ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 1.5ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.7, W-2.9
- **ë³‘ë ¬ ê°€ëŠ¥**: Yes

**ì…ë ¥ ìŠ¤í™**

```typescript
// DB í…Œì´ë¸”: stretching_routines
interface RoutineRecord {
  id: string;
  clerk_user_id: string;
  name: string;
  source: 'janda' | 'sports' | 'custom';
  exercises: RoutineExercise[];
  created_at: string;
  updated_at: string;
  is_favorite: boolean;
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface RoutineHistoryResult {
  savedRoutines: RoutineRecord[];
  recentSessions: SessionHistory[];
  favorites: RoutineRecord[];
  totalRoutines: number;
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] RLS ì •ì±… ì ìš© (ë³¸ì¸ ë°ì´í„°ë§Œ)
- [ ] ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥
- [ ] ë£¨í‹´ ë³µì œ/ìˆ˜ì •
- [ ] ì´ë ¥ ì¡°íšŒ (ìµœê·¼ 30ì¼)
- [ ] API í…ŒìŠ¤íŠ¸ 3ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/app/api/v2/stretching/routines/route.ts` | ì‹ ê·œ | ë£¨í‹´ CRUD |
| `apps/web/app/api/v2/stretching/routines/[id]/route.ts` | ì‹ ê·œ | ê°œë³„ ë£¨í‹´ |
| `apps/web/lib/stretching/routine-repository.ts` | ì‹ ê·œ | Repository |
| `apps/web/tests/api/stretching/routines.test.ts` | ì‹ ê·œ | í…ŒìŠ¤íŠ¸ |

---

#### W-2.11: ì•ˆì „ ê°€ì´ë“œ ì‹œìŠ¤í…œ (1ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 1ì‹œê°„
- **ì˜ì¡´ì„±**: ì—†ìŒ (ë…ë¦½ ëª¨ë“ˆ)
- **ë³‘ë ¬ ê°€ëŠ¥**: Yes

**ì…ë ¥ ìŠ¤í™**

```typescript
interface SafetyGuideInput {
  exerciseId: string;
  userConditions?: HealthCondition[];
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface SafetyGuideResult {
  warnings: SafetyWarning[];
  doList: string[];
  dontList: string[];
  medicalDisclaimer: string;
  emergencyStopCriteria: string[];
}
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] ìš´ë™ë³„ ì•ˆì „ ê°€ì´ë“œ ë°ì´í„°
- [ ] ì˜ë£Œ ë©´ì±… ì¡°í•­ í¬í•¨
- [ ] ê¸´ê¸‰ ì¤‘ë‹¨ ê¸°ì¤€ ëª…ì‹œ
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ 2ê°œ ì´ìƒ

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/lib/stretching/safety-guide.ts` | ì‹ ê·œ | ì•ˆì „ ê°€ì´ë“œ |
| `apps/web/lib/stretching/data/safety-data.ts` | ì‹ ê·œ | ì•ˆì „ ë°ì´í„° |
| `apps/web/components/stretching/SafetyDisclaimer.tsx` | ì‹ ê·œ | ë©´ì±… UI |

---

#### W-2.12: í†µí•© í…ŒìŠ¤íŠ¸ (1.5ì‹œê°„)

**ë©”íƒ€ë°ì´í„°**
- **ì†Œìš”ì‹œê°„**: 1.5ì‹œê°„
- **ì˜ì¡´ì„±**: W-2.1 ~ W-2.11 ì „ì²´
- **ë³‘ë ¬ ê°€ëŠ¥**: No (ë§ˆì§€ë§‰ ë‹¨ê³„)

**í…ŒìŠ¤íŠ¸ ë²”ìœ„**

```typescript
describe('W-2 í†µí•© í…ŒìŠ¤íŠ¸', () => {
  // E2E ì‹œë‚˜ë¦¬ì˜¤ 1: Janda ê¸°ë°˜ ì²˜ë°©
  it('C-2 â†’ Janda ë¶„ì„ â†’ ì²˜ë°© â†’ ì„¸ì…˜ ì™„ë£Œ', async () => {});

  // E2E ì‹œë‚˜ë¦¬ì˜¤ 2: ìŠ¤í¬ì¸  ê¸°ë°˜ ì²˜ë°©
  it('ìŠ¤í¬ì¸  ì„ íƒ â†’ ë£¨í‹´ ìƒì„± â†’ ì„¸ì…˜ ì™„ë£Œ', async () => {});

  // E2E ì‹œë‚˜ë¦¬ì˜¤ 3: ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§
  it('ê±´ê°• ìƒíƒœ ì…ë ¥ â†’ ì•ˆì „ ì²˜ë°© ìƒì„±', async () => {});

  // E2E ì‹œë‚˜ë¦¬ì˜¤ 4: ì§„í–‰ ì¶”ì 
  it('ì„¸ì…˜ ì™„ë£Œ â†’ ì§„í–‰ ì¶”ì  â†’ í†µê³„ í™•ì¸', async () => {});
});
```

**ì„±ê³µ ê¸°ì¤€**
- [ ] E2E ì‹œë‚˜ë¦¬ì˜¤ 4ê°œ ì´ìƒ
- [ ] ì»¤ë²„ë¦¬ì§€ 80% ì´ìƒ
- [ ] ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
- [ ] typecheck í†µê³¼
- [ ] lint í†µê³¼

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/tests/integration/stretching/janda-flow.test.ts` | ì‹ ê·œ | Janda í”Œë¡œìš° |
| `apps/web/tests/integration/stretching/sports-flow.test.ts` | ì‹ ê·œ | ìŠ¤í¬ì¸  í”Œë¡œìš° |
| `apps/web/tests/integration/stretching/safety-flow.test.ts` | ì‹ ê·œ | ì•ˆì „ í”Œë¡œìš° |
| `apps/web/e2e/stretching/stretching.spec.ts` | ì‹ ê·œ | E2E í…ŒìŠ¤íŠ¸ |

---

## 8. Mock ë°ì´í„°

> **v1.4 ì—…ë°ì´íŠ¸**: UCS/LCS ìƒ˜í”Œ, ìŠ¤í¬ì¸  ë£¨í‹´, 20ê°œ ìŠ¤íŠ¸ë ˆì¹­ ìš´ë™ ì¶”ê°€

### 8.1 UCS/LCS ìƒ˜í”Œ ë°ì´í„°

#### 8.1.1 ìƒë¶€êµì°¨ì¦í›„êµ° (UCS) Mock

```typescript
// tests/factories/janda-mocks.ts

/**
 * ìƒë¶€êµì°¨ì¦í›„êµ° - ì¤‘ë“±ë„ ìƒ˜í”Œ
 * - ê¸´ì¥: ëŒ€í‰ê·¼, ìƒë¶€ìŠ¹ëª¨ê·¼, ê²¬ê°‘ê±°ê·¼, í‰ì‡„ìœ ëŒê·¼, í›„ë‘í•˜ê·¼
 * - ì•½í™”: ì‹¬ë¶€ ê²½ì¶” êµ´ê³¡ê·¼, í•˜ë¶€ìŠ¹ëª¨ê·¼, ì „ê±°ê·¼
 */
export const mockUpperCrossSyndromeModerate = {
  type: 'upper_cross_syndrome' as const,
  severity: 'moderate' as const,
  confidence: 0.85,

  tightMuscles: [
    {
      muscleId: 'pectoralis_major',
      muscleName: 'ëŒ€í‰ê·¼',
      tightness: 75,      // 0-100 scale
      location: 'chest',
      priority: 1,
    },
    {
      muscleId: 'upper_trapezius',
      muscleName: 'ìƒë¶€ìŠ¹ëª¨ê·¼',
      tightness: 80,
      location: 'shoulder',
      priority: 2,
    },
    {
      muscleId: 'levator_scapulae',
      muscleName: 'ê²¬ê°‘ê±°ê·¼',
      tightness: 70,
      location: 'neck',
      priority: 3,
    },
    {
      muscleId: 'sternocleidomastoid',
      muscleName: 'í‰ì‡„ìœ ëŒê·¼',
      tightness: 65,
      location: 'neck',
      priority: 4,
    },
    {
      muscleId: 'suboccipitals',
      muscleName: 'í›„ë‘í•˜ê·¼',
      tightness: 60,
      location: 'neck',
      priority: 5,
    },
  ],

  weakMuscles: [
    {
      muscleId: 'deep_cervical_flexors',
      muscleName: 'ì‹¬ë¶€ ê²½ì¶” êµ´ê³¡ê·¼',
      weakness: 70,
      location: 'neck',
    },
    {
      muscleId: 'lower_trapezius',
      muscleName: 'í•˜ë¶€ìŠ¹ëª¨ê·¼',
      weakness: 65,
      location: 'back',
    },
    {
      muscleId: 'serratus_anterior',
      muscleName: 'ì „ê±°ê·¼',
      weakness: 60,
      location: 'side',
    },
  ],

  associatedPostures: ['forward_head', 'rounded_shoulders', 'thoracic_kyphosis'],

  recommendedStretches: [
    'doorway_pec_stretch',
    'upper_trap_stretch',
    'levator_scapulae_stretch',
    'chin_tuck',
    'suboccipital_release',
  ],

  recommendedActivations: [
    'chin_tuck_hold',
    'prone_y_raise',
    'wall_angel',
  ],
};

/**
 * ìƒë¶€êµì°¨ì¦í›„êµ° - ê²½ë¯¸ ìƒ˜í”Œ
 */
export const mockUpperCrossSyndromeMild = {
  type: 'upper_cross_syndrome' as const,
  severity: 'mild' as const,
  confidence: 0.78,

  tightMuscles: [
    {
      muscleId: 'upper_trapezius',
      muscleName: 'ìƒë¶€ìŠ¹ëª¨ê·¼',
      tightness: 55,
      location: 'shoulder',
      priority: 1,
    },
    {
      muscleId: 'pectoralis_minor',
      muscleName: 'ì†Œí‰ê·¼',
      tightness: 50,
      location: 'chest',
      priority: 2,
    },
  ],

  weakMuscles: [
    {
      muscleId: 'deep_cervical_flexors',
      muscleName: 'ì‹¬ë¶€ ê²½ì¶” êµ´ê³¡ê·¼',
      weakness: 45,
      location: 'neck',
    },
  ],

  associatedPostures: ['forward_head'],
  recommendedStretches: ['upper_trap_stretch', 'doorway_pec_stretch'],
  recommendedActivations: ['chin_tuck_hold'],
};
```

#### 8.1.2 í•˜ë¶€êµì°¨ì¦í›„êµ° (LCS) Mock

```typescript
/**
 * í•˜ë¶€êµì°¨ì¦í›„êµ° - ì¤‘ë“±ë„ ìƒ˜í”Œ
 * - ê¸´ì¥: ì¥ìš”ê·¼, ëŒ€í‡´ì§ê·¼, ì²™ì¶”ê¸°ë¦½ê·¼, ëŒ€í‡´ê·¼ë§‰ì¥ê·¼
 * - ì•½í™”: ë³µì§ê·¼, ëŒ€ë‘”ê·¼
 */
export const mockLowerCrossSyndromeModerate = {
  type: 'lower_cross_syndrome' as const,
  severity: 'moderate' as const,
  confidence: 0.82,

  tightMuscles: [
    {
      muscleId: 'iliopsoas',
      muscleName: 'ì¥ìš”ê·¼',
      tightness: 80,
      location: 'hip_front',
      priority: 1,
    },
    {
      muscleId: 'rectus_femoris',
      muscleName: 'ëŒ€í‡´ì§ê·¼',
      tightness: 75,
      location: 'thigh_front',
      priority: 2,
    },
    {
      muscleId: 'erector_spinae',
      muscleName: 'ì²™ì¶”ê¸°ë¦½ê·¼ (ìš”ë¶€)',
      tightness: 70,
      location: 'lower_back',
      priority: 3,
    },
    {
      muscleId: 'tensor_fasciae_latae',
      muscleName: 'ëŒ€í‡´ê·¼ë§‰ì¥ê·¼',
      tightness: 65,
      location: 'hip_side',
      priority: 4,
    },
  ],

  weakMuscles: [
    {
      muscleId: 'rectus_abdominis',
      muscleName: 'ë³µì§ê·¼',
      weakness: 70,
      location: 'abdomen',
    },
    {
      muscleId: 'gluteus_maximus',
      muscleName: 'ëŒ€ë‘”ê·¼',
      weakness: 75,
      location: 'buttocks',
    },
    {
      muscleId: 'gluteus_medius',
      muscleName: 'ì¤‘ë‘”ê·¼',
      weakness: 60,
      location: 'hip_side',
    },
  ],

  associatedPostures: ['anterior_pelvic_tilt', 'lumbar_lordosis'],

  recommendedStretches: [
    'kneeling_hip_flexor_stretch',
    'couch_stretch',
    'standing_quad_stretch',
    'cat_cow',
    'tfl_stretch',
  ],

  recommendedActivations: [
    'glute_bridge',
    'dead_bug',
    'bird_dog',
  ],
};
```

### 8.2 ìŠ¤í¬ì¸ ë³„ ë£¨í‹´ Mock

#### 8.2.1 ëŸ¬ë‹ ë£¨í‹´ (Pre-workout)

```typescript
/**
 * ëŸ¬ë‹ ì „ ë™ì  ìŠ¤íŠ¸ë ˆì¹­ ë£¨í‹´
 * - ì†Œìš”ì‹œê°„: 8ë¶„
 * - ëŒ€ìƒ ê·¼ìœ¡: ëŒ€í‡´ì‚¬ë‘ê·¼, í–„ìŠ¤íŠ¸ë§, ì¢…ì•„ë¦¬, ê³ ê´€ì ˆ
 */
export const mockRunningPreWorkoutRoutine = {
  routineId: 'running_pre_001',
  name: 'ëŸ¬ë‹ ì „ ë™ì  ìŠ¤íŠ¸ë ˆì¹­',
  sport: 'running' as const,
  timing: 'pre' as const,
  duration: 8,
  level: 'all',

  exercises: [
    {
      exerciseId: 'leg_swings_forward',
      name: 'ë‹¤ë¦¬ ì „í›„ ìŠ¤ìœ™',
      type: 'dynamic',
      targetMuscles: ['hip_flexors', 'hamstrings'],
      duration: 30,
      reps: 15,
      sets: 2,
      sides: 'bilateral',
      instructions: 'ë²½ì„ ì¡ê³  ë‹¤ë¦¬ë¥¼ ì•ë’¤ë¡œ í”ë“¤ê¸°',
      sequence: 1,
    },
    {
      exerciseId: 'leg_swings_lateral',
      name: 'ë‹¤ë¦¬ ì¢Œìš° ìŠ¤ìœ™',
      type: 'dynamic',
      targetMuscles: ['hip_adductors', 'hip_abductors'],
      duration: 30,
      reps: 15,
      sets: 2,
      sides: 'bilateral',
      instructions: 'ë²½ì„ ì¡ê³  ë‹¤ë¦¬ë¥¼ ì¢Œìš°ë¡œ í”ë“¤ê¸°',
      sequence: 2,
    },
    {
      exerciseId: 'high_knees',
      name: 'í•˜ì´ë‹ˆ',
      type: 'dynamic',
      targetMuscles: ['hip_flexors', 'quadriceps'],
      duration: 30,
      reps: 20,
      sets: 2,
      sides: 'alternating',
      instructions: 'ì œìë¦¬ì—ì„œ ë¬´ë¦ì„ ë†’ì´ ë“¤ì–´ì˜¬ë¦¬ê¸°',
      sequence: 3,
    },
    {
      exerciseId: 'butt_kicks',
      name: 'ë²„íŠ¸í‚¥',
      type: 'dynamic',
      targetMuscles: ['quadriceps', 'hamstrings'],
      duration: 30,
      reps: 20,
      sets: 2,
      sides: 'alternating',
      instructions: 'ì œìë¦¬ì—ì„œ ë°œë’¤ê¿ˆì¹˜ë¥¼ ì—‰ë©ì´ì— ë‹¿ê²Œ í•˜ê¸°',
      sequence: 4,
    },
    {
      exerciseId: 'ankle_circles',
      name: 'ë°œëª© ëŒë¦¬ê¸°',
      type: 'dynamic',
      targetMuscles: ['ankle_dorsiflexors', 'ankle_plantarflexors'],
      duration: 30,
      reps: 10,
      sets: 2,
      sides: 'bilateral',
      instructions: 'ë°œëª©ì„ ì‹œê³„ë°©í–¥, ë°˜ì‹œê³„ë°©í–¥ìœ¼ë¡œ ëŒë¦¬ê¸°',
      sequence: 5,
    },
    {
      exerciseId: 'walking_lunges',
      name: 'ì›Œí‚¹ ëŸ°ì§€',
      type: 'dynamic',
      targetMuscles: ['quadriceps', 'glutes', 'hip_flexors'],
      duration: 60,
      reps: 10,
      sets: 1,
      sides: 'alternating',
      instructions: 'ì•ìœ¼ë¡œ ê±¸ìœ¼ë©° ëŸ°ì§€ ë™ì‘',
      sequence: 6,
    },
  ],

  tips: [
    'ì²œì²œíˆ ì‹œì‘í•˜ì—¬ ì ì  ê°€ë™ë²”ìœ„ë¥¼ ë„“í˜€ê°€ì„¸ìš”',
    'í˜¸í¡ì„ ìì—°ìŠ¤ëŸ½ê²Œ ìœ ì§€í•˜ì„¸ìš”',
    'í†µì¦ì´ ìˆìœ¼ë©´ í•´ë‹¹ ë™ì‘ì€ ê±´ë„ˆë›°ì„¸ìš”',
  ],
};
```

#### 8.2.2 ê³¨í”„ ë£¨í‹´ (Pre-workout)

```typescript
/**
 * ê³¨í”„ ì „ ë™ì  ìŠ¤íŠ¸ë ˆì¹­ ë£¨í‹´
 * - ì†Œìš”ì‹œê°„: 10ë¶„
 * - ëŒ€ìƒ ê·¼ìœ¡: íšŒì „ê·¼ê°œ, í‰ì¶”, ê³ ê´€ì ˆ, ì½”ì–´
 */
export const mockGolfPreWorkoutRoutine = {
  routineId: 'golf_pre_001',
  name: 'ê³¨í”„ ì „ ë™ì  ìŠ¤íŠ¸ë ˆì¹­',
  sport: 'golf' as const,
  timing: 'pre' as const,
  duration: 10,
  level: 'all',

  exercises: [
    {
      exerciseId: 'arm_circles',
      name: 'íŒ” ëŒë¦¬ê¸°',
      type: 'dynamic',
      targetMuscles: ['rotator_cuff', 'deltoids'],
      duration: 30,
      reps: 15,
      sets: 2,
      sides: 'bilateral',
      instructions: 'ì‘ì€ ì›ì—ì„œ í° ì›ìœ¼ë¡œ ì ì  í‚¤ìš°ê¸°',
      sequence: 1,
    },
    {
      exerciseId: 'thoracic_rotations',
      name: 'í‰ì¶” íšŒì „',
      type: 'dynamic',
      targetMuscles: ['thoracic_spine', 'obliques'],
      duration: 45,
      reps: 10,
      sets: 2,
      sides: 'bilateral',
      instructions: 'í´ëŸ½ì„ ì–´ê¹¨ì— ë©”ê³  íšŒì „',
      sequence: 2,
    },
    {
      exerciseId: 'hip_circles',
      name: 'ê³ ê´€ì ˆ ëŒë¦¬ê¸°',
      type: 'dynamic',
      targetMuscles: ['hip_rotators', 'glutes'],
      duration: 30,
      reps: 10,
      sets: 2,
      sides: 'bilateral',
      instructions: 'í•œ ë°œë¡œ ì„œì„œ ë°˜ëŒ€ ë‹¤ë¦¬ë¡œ ì› ê·¸ë¦¬ê¸°',
      sequence: 3,
    },
    {
      exerciseId: 'golf_swing_warm_up',
      name: 'ìŠ¤ìœ™ ì›Œë°ì—…',
      type: 'dynamic',
      targetMuscles: ['core', 'lats', 'hip_rotators'],
      duration: 60,
      reps: 10,
      sets: 3,
      sides: 'bilateral',
      instructions: '50% â†’ 75% â†’ 90% ê°•ë„ë¡œ ì ì§„ì  ìŠ¤ìœ™',
      sequence: 4,
    },
    {
      exerciseId: 'standing_trunk_twist',
      name: 'ì„œì„œ ëª¸í†µ ë¹„í‹€ê¸°',
      type: 'dynamic',
      targetMuscles: ['obliques', 'thoracic_spine'],
      duration: 30,
      reps: 15,
      sets: 2,
      sides: 'alternating',
      instructions: 'íŒ”ì„ ë²Œë¦¬ê³  ì¢Œìš°ë¡œ íšŒì „',
      sequence: 5,
    },
  ],

  tips: [
    'íšŒì „ ë™ì‘ ì „ ì½”ì–´ë¥¼ í™œì„±í™”í•˜ì„¸ìš”',
    'ìŠ¤ìœ™ ê°•ë„ë¥¼ ì ì§„ì ìœ¼ë¡œ ë†’ì´ì„¸ìš”',
    'ì–´ê¹¨ ê¸´ì¥ì„ í’€ê³  ì‹œì‘í•˜ì„¸ìš”',
  ],
};
```

### 8.3 ìŠ¤íŠ¸ë ˆì¹­ ìš´ë™ ë°ì´í„°ë² ì´ìŠ¤ (20ê°œ)

```typescript
// lib/stretching/data/exercise-database.ts

export const STRETCHING_EXERCISES: StretchingExercise[] = [
  // === ëª©/ì–´ê¹¨ ì˜ì—­ (Neck/Shoulder) ===
  {
    id: 'upper_trap_stretch',
    nameKo: 'ìƒë¶€ìŠ¹ëª¨ê·¼ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Upper Trapezius Stretch',
    category: 'neck_shoulder',
    type: 'static',
    targetMuscles: ['upper_trapezius'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['none'],
    instructions: [
      'ë°”ë¥´ê²Œ ì•‰ê±°ë‚˜ ì„ ë‹¤',
      'í•œ ì†ìœ¼ë¡œ ë°˜ëŒ€ìª½ ë¨¸ë¦¬ë¥¼ ì¡ëŠ”ë‹¤',
      'ì²œì²œíˆ ë¨¸ë¦¬ë¥¼ ì˜†ìœ¼ë¡œ ë‹¹ê¸´ë‹¤',
      '30ì´ˆê°„ ìœ ì§€ í›„ ë°˜ëŒ€ìª½ ë°˜ë³µ',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'ìŠ¤íŠ¸ë ˆì¹­ ì‹œì‘',
      hold: 'ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡ ìœ ì§€',
    },
    safetyNotes: ['ëª© ë””ìŠ¤í¬ ìˆìœ¼ë©´ ì£¼ì˜', 'ê°‘ìê¸° ë‹¹ê¸°ì§€ ì•Šê¸°'],
    contraindications: ['cervical_disc', 'acute_neck_injury'],
  },
  {
    id: 'levator_scapulae_stretch',
    nameKo: 'ê²¬ê°‘ê±°ê·¼ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Levator Scapulae Stretch',
    category: 'neck_shoulder',
    type: 'static',
    targetMuscles: ['levator_scapulae'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['none'],
    instructions: [
      'ë°”ë¥´ê²Œ ì•‰ëŠ”ë‹¤',
      'í•œ ì†ì„ ë“± ë’¤ë¡œ ë†“ëŠ”ë‹¤',
      'ë°˜ëŒ€ ì†ìœ¼ë¡œ ë¨¸ë¦¬ë¥¼ 45ë„ ëŒ€ê°ì„  ì•„ë˜ë¡œ ë‹¹ê¸´ë‹¤',
      '30ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'ëŒ€ê°ì„ ìœ¼ë¡œ ë‹¹ê¸°ê¸°',
      hold: 'ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡',
    },
    safetyNotes: ['ì–´ê¹¨ í†µì¦ ì‹œ ì¤‘ë‹¨'],
    contraindications: ['shoulder_impingement'],
  },
  {
    id: 'doorway_pec_stretch',
    nameKo: 'ê°€ìŠ´ ìŠ¤íŠ¸ë ˆì¹­ (ë¬¸í‹€)',
    nameEn: 'Doorway Pec Stretch',
    category: 'chest',
    type: 'static',
    targetMuscles: ['pectoralis_major', 'pectoralis_minor'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['doorframe'],
    instructions: [
      'ë¬¸í‹€ì— íŒ”ê¿ˆì¹˜ë¥¼ 90ë„ë¡œ ì„¸ìš´ë‹¤',
      'í•œ ë°œì„ ì•ìœ¼ë¡œ ë‚´ë”›ëŠ”ë‹¤',
      'ê°€ìŠ´ì„ ì•ìœ¼ë¡œ ë°€ì–´ ìŠ¤íŠ¸ë ˆì¹­',
      '30ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'ê°€ìŠ´ ë°€ê¸°',
      hold: 'ê¹Šì€ í˜¸í¡',
    },
    safetyNotes: ['ì–´ê¹¨ ì „ë°© í†µì¦ ì‹œ ê°ë„ ì¡°ì ˆ'],
    contraindications: ['shoulder_dislocation_history'],
  },
  {
    id: 'chin_tuck',
    nameKo: 'ì¹œí„± (í„± ë‹¹ê¸°ê¸°)',
    nameEn: 'Chin Tuck',
    category: 'neck_shoulder',
    type: 'static',
    targetMuscles: ['suboccipitals', 'sternocleidomastoid'],
    defaultDuration: 10,
    defaultSets: 10,
    difficulty: 'beginner',
    equipment: ['none'],
    instructions: [
      'ë°”ë¥´ê²Œ ì•‰ê±°ë‚˜ ì„ ë‹¤',
      'í„±ì„ ë’¤ë¡œ ë‹¹ê²¨ ì´ì¤‘í„±ì„ ë§Œë“ ë‹¤',
      '10ì´ˆê°„ ìœ ì§€',
      '10íšŒ ë°˜ë³µ',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'í„± ë‹¹ê¸°ê¸°',
      hold: 'ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡',
    },
    safetyNotes: ['ê±°ë¶ëª© êµì •ì— íš¨ê³¼ì '],
    contraindications: [],
  },
  {
    id: 'thread_the_needle',
    nameKo: 'ì‹¤ ê¿°ê¸° ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Thread the Needle',
    category: 'back',
    type: 'dynamic',
    targetMuscles: ['thoracic_spine', 'rhomboids', 'rear_deltoid'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'intermediate',
    equipment: ['mat'],
    instructions: [
      'ë„¤ë°œê¸°ê¸° ìì„¸ë¡œ ì‹œì‘',
      'í•œ íŒ”ì„ ë°˜ëŒ€ìª½ ê²¨ë“œë‘ì´ ì•„ë˜ë¡œ í†µê³¼ì‹œí‚¨ë‹¤',
      'ì–´ê¹¨ì™€ ê·€ê°€ ë°”ë‹¥ì— ë‹¿ì„ ë•Œê¹Œì§€ íšŒì „',
      '3ì´ˆ ìœ ì§€ í›„ ë°˜ë³µ',
    ],
    breathingGuide: {
      inhale: 'íŒ” ë“¤ê¸°',
      exhale: 'íŒ” í†µê³¼',
      hold: 'ê¹Šì€ í˜¸í¡',
    },
    safetyNotes: ['ì–´ê¹¨ ì¶©ëŒì¦í›„êµ° ì‹œ ì£¼ì˜'],
    contraindications: ['shoulder_impingement'],
  },

  // === í—ˆë¦¬/ê³¨ë°˜ ì˜ì—­ (Lower Back/Hip) ===
  {
    id: 'kneeling_hip_flexor_stretch',
    nameKo: 'ë¬´ë¦ ê¿‡ê³  ê³ ê´€ì ˆ êµ´ê³¡ê·¼ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Kneeling Hip Flexor Stretch',
    category: 'hip',
    type: 'static',
    targetMuscles: ['iliopsoas', 'rectus_femoris'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['mat'],
    instructions: [
      'í•œìª½ ë¬´ë¦ì„ ë•…ì— ëŒ€ê³  ëŸ°ì§€ ìì„¸',
      'ê³¨ë°˜ì„ ì•ìœ¼ë¡œ ë°€ì–´ë‚¸ë‹¤',
      'ê°™ì€ ìª½ íŒ”ì„ ìœ„ë¡œ ë»—ìœ¼ë©´ ê°•ë„ ì¦ê°€',
      '30ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'ê³¨ë°˜ ë°€ê¸°',
      hold: 'ê¹Šì€ í˜¸í¡',
    },
    safetyNotes: ['ë¬´ë¦ ì•„ë˜ ì¿ ì…˜ ì‚¬ìš© ê¶Œì¥'],
    contraindications: ['knee_injury'],
  },
  {
    id: 'couch_stretch',
    nameKo: 'ì¹´ìš°ì¹˜ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Couch Stretch',
    category: 'hip',
    type: 'static',
    targetMuscles: ['iliopsoas', 'rectus_femoris', 'quadriceps'],
    defaultDuration: 60,
    defaultSets: 2,
    difficulty: 'intermediate',
    equipment: ['wall', 'couch'],
    instructions: [
      'ë²½ ì•ì—ì„œ í•œìª½ ë¬´ë¦ì„ ë°”ë‹¥ì—, ë°œì€ ë²½ì— ëŒ„ë‹¤',
      'ë°˜ëŒ€ ë°œì€ ì•ìœ¼ë¡œ ëŸ°ì§€ ìì„¸',
      'ìƒì²´ë¥¼ ì„¸ìš´ë‹¤',
      '60ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ìƒì²´ ì„¸ìš°ê¸°',
      exhale: 'ê³¨ë°˜ ë°€ê¸°',
      hold: 'ê¹Šì€ í˜¸í¡',
    },
    safetyNotes: ['ê°•ë„ê°€ ë†’ìœ¼ë¯€ë¡œ ì ì§„ì ìœ¼ë¡œ'],
    contraindications: ['knee_injury', 'severe_hip_pain'],
  },
  {
    id: 'piriformis_stretch',
    nameKo: 'ì´ìƒê·¼ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Piriformis Stretch',
    category: 'hip',
    type: 'static',
    targetMuscles: ['piriformis', 'hip_external_rotators'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['mat'],
    instructions: [
      'ëˆ„ì›Œì„œ í•œìª½ ë¬´ë¦ì„ êµ¬ë¶€ë¦°ë‹¤',
      'ë°˜ëŒ€ìª½ ë°œëª©ì„ ë¬´ë¦ ìœ„ì— ì˜¬ë¦°ë‹¤',
      'êµ¬ë¶€ë¦° ë¬´ë¦ì„ ê°€ìŠ´ ìª½ìœ¼ë¡œ ë‹¹ê¸´ë‹¤',
      '30ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'ë‹¹ê¸°ê¸°',
      hold: 'ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡',
    },
    safetyNotes: ['ì¢Œê³¨ì‹ ê²½í†µ ì¦ìƒ ì‹œ ì£¼ì˜'],
    contraindications: ['acute_sciatica'],
  },
  {
    id: 'cat_cow',
    nameKo: 'ê³ ì–‘ì´-ì†Œ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Cat-Cow Stretch',
    category: 'back',
    type: 'dynamic',
    targetMuscles: ['erector_spinae', 'rectus_abdominis'],
    defaultDuration: 60,
    defaultSets: 1,
    difficulty: 'beginner',
    equipment: ['mat'],
    instructions: [
      'ë„¤ë°œê¸°ê¸° ìì„¸',
      'ìˆ¨ì„ ë“¤ì´ì‰¬ë©° í—ˆë¦¬ë¥¼ ì•„ë˜ë¡œ (ì†Œ)',
      'ìˆ¨ì„ ë‚´ì‰¬ë©° í—ˆë¦¬ë¥¼ ìœ„ë¡œ (ê³ ì–‘ì´)',
      '10-15íšŒ ë°˜ë³µ',
    ],
    breathingGuide: {
      inhale: 'ì†Œ ìì„¸ (í—ˆë¦¬ ì•„ë˜ë¡œ)',
      exhale: 'ê³ ì–‘ì´ ìì„¸ (í—ˆë¦¬ ìœ„ë¡œ)',
      hold: 'ì—†ìŒ',
    },
    safetyNotes: ['ì²™ì¶” í†µì¦ ì‹œ ê°€ë™ë²”ìœ„ ì¤„ì´ê¸°'],
    contraindications: [],
  },
  {
    id: 'seated_hamstring_stretch',
    nameKo: 'ì•‰ì•„ì„œ í–„ìŠ¤íŠ¸ë§ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Seated Hamstring Stretch',
    category: 'leg',
    type: 'static',
    targetMuscles: ['hamstrings'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['mat'],
    instructions: [
      'í•œ ë‹¤ë¦¬ë¥¼ í´ê³  ì•‰ëŠ”ë‹¤',
      'ë°˜ëŒ€ ë°œì€ í—ˆë²…ì§€ ì•ˆìª½ì— ëŒ„ë‹¤',
      'ìƒì²´ë¥¼ ì•ìœ¼ë¡œ ìˆ™ì¸ë‹¤',
      '30ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ì²™ì¶” ëŠ˜ë¦¬ê¸°',
      exhale: 'ì•ìœ¼ë¡œ ìˆ™ì´ê¸°',
      hold: 'ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡',
    },
    safetyNotes: ['í—ˆë¦¬ê°€ ì•„ë‹Œ ê³ ê´€ì ˆì—ì„œ ìˆ™ì´ê¸°'],
    contraindications: ['lumbar_disc'],
  },

  // === ë‹¤ë¦¬ ì˜ì—­ (Legs) ===
  {
    id: 'standing_quad_stretch',
    nameKo: 'ì„œì„œ ëŒ€í‡´ì‚¬ë‘ê·¼ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Standing Quad Stretch',
    category: 'leg',
    type: 'static',
    targetMuscles: ['quadriceps', 'rectus_femoris'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['none'],
    instructions: [
      'í•œ ë°œë¡œ ì„œì„œ ë°˜ëŒ€ ë°œì„ ë’¤ë¡œ ì¡ëŠ”ë‹¤',
      'ë¬´ë¦ì„ ì•„ë˜ë¡œ í–¥í•˜ê²Œ ìœ ì§€',
      'ê³¨ë°˜ì„ ì•ìœ¼ë¡œ ë°€ë©´ ê°•ë„ ì¦ê°€',
      '30ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'ìŠ¤íŠ¸ë ˆì¹­ ì‹¬í™”',
      hold: 'ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡',
    },
    safetyNotes: ['ê· í˜•ì´ ì–´ë ¤ìš°ë©´ ë²½ ì¡ê¸°'],
    contraindications: ['knee_injury'],
  },
  {
    id: 'standing_calf_stretch',
    nameKo: 'ì¢…ì•„ë¦¬ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Standing Calf Stretch',
    category: 'leg',
    type: 'static',
    targetMuscles: ['gastrocnemius', 'soleus'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['wall'],
    instructions: [
      'ë²½ì— ì†ì„ ëŒ€ê³  ì„ ë‹¤',
      'í•œ ë°œì„ ë’¤ë¡œ ë»—ê³  ë°œë’¤ê¿ˆì¹˜ë¥¼ ë°”ë‹¥ì— ë¶™ì¸ë‹¤',
      'ì• ë¬´ë¦ì„ êµ¬ë¶€ë ¤ ìŠ¤íŠ¸ë ˆì¹­',
      '30ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'ì•ìœ¼ë¡œ ë°€ê¸°',
      hold: 'ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡',
    },
    safetyNotes: ['ì•„í‚¬ë ˆìŠ¤ê±´ í†µì¦ ì‹œ ì¤‘ë‹¨'],
    contraindications: ['achilles_tendinitis'],
  },
  {
    id: 'standing_it_band_stretch',
    nameKo: 'ITë°´ë“œ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: 'Standing IT Band Stretch',
    category: 'leg',
    type: 'static',
    targetMuscles: ['tensor_fasciae_latae', 'iliotibial_band'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'intermediate',
    equipment: ['wall'],
    instructions: [
      'ë²½ ì˜†ì— ì„œì„œ ê°€ê¹Œìš´ ë°œì„ ë’¤ë¡œ êµì°¨',
      'ê³¨ë°˜ì„ ë²½ ìª½ìœ¼ë¡œ ë°€ì–´ë‚¸ë‹¤',
      'ë°”ê¹¥ìª½ í—ˆë²…ì§€ ë‹¹ê¹€ ëŠë‚Œ',
      '30ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ì¤€ë¹„',
      exhale: 'ê³¨ë°˜ ë°€ê¸°',
      hold: 'ìì—°ìŠ¤ëŸ¬ìš´ í˜¸í¡',
    },
    safetyNotes: ['ë¬´ë¦ ë°”ê¹¥ìª½ í†µì¦ ì‹œ ì£¼ì˜'],
    contraindications: ['knee_lateral_pain'],
  },

  // === ë™ì  ìŠ¤íŠ¸ë ˆì¹­ (Dynamic) ===
  {
    id: 'leg_swings_forward',
    nameKo: 'ë‹¤ë¦¬ ì „í›„ ìŠ¤ìœ™',
    nameEn: 'Forward/Backward Leg Swings',
    category: 'dynamic',
    type: 'dynamic',
    targetMuscles: ['hip_flexors', 'hamstrings', 'glutes'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['wall'],
    instructions: [
      'ë²½ì— ì†ì„ ëŒ€ê³  ì„ ë‹¤',
      'ë‹¤ë¦¬ë¥¼ ì•ë’¤ë¡œ í”ë“ ë‹¤',
      'ì ì  ê°€ë™ë²”ìœ„ë¥¼ ëŠ˜ë¦°ë‹¤',
      '15íšŒì”© ì–‘ìª½',
    ],
    breathingGuide: {
      inhale: 'ë’¤ë¡œ ìŠ¤ìœ™',
      exhale: 'ì•ìœ¼ë¡œ ìŠ¤ìœ™',
      hold: 'ì—†ìŒ',
    },
    safetyNotes: ['ê°‘ìê¸° í¬ê²Œ í”ë“¤ì§€ ì•Šê¸°'],
    contraindications: [],
  },
  {
    id: 'arm_circles',
    nameKo: 'íŒ” ëŒë¦¬ê¸°',
    nameEn: 'Arm Circles',
    category: 'dynamic',
    type: 'dynamic',
    targetMuscles: ['deltoids', 'rotator_cuff'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'beginner',
    equipment: ['none'],
    instructions: [
      'íŒ”ì„ ì˜†ìœ¼ë¡œ ë²Œë¦°ë‹¤',
      'ì‘ì€ ì›ì—ì„œ ì‹œì‘í•˜ì—¬ ì ì  í¬ê²Œ',
      'ì‹œê³„ë°©í–¥, ë°˜ì‹œê³„ë°©í–¥ ëª¨ë‘',
      '15íšŒì”©',
    ],
    breathingGuide: {
      inhale: 'ìì—°ìŠ¤ëŸ½ê²Œ',
      exhale: 'ìì—°ìŠ¤ëŸ½ê²Œ',
      hold: 'ì—†ìŒ',
    },
    safetyNotes: ['ì–´ê¹¨ í†µì¦ ì‹œ í¬ê¸° ì¤„ì´ê¸°'],
    contraindications: ['shoulder_impingement'],
  },
  {
    id: 'walking_lunges',
    nameKo: 'ì›Œí‚¹ ëŸ°ì§€',
    nameEn: 'Walking Lunges',
    category: 'dynamic',
    type: 'dynamic',
    targetMuscles: ['quadriceps', 'glutes', 'hip_flexors'],
    defaultDuration: 60,
    defaultSets: 1,
    difficulty: 'intermediate',
    equipment: ['none'],
    instructions: [
      'í•œ ë°œì„ ì•ìœ¼ë¡œ í¬ê²Œ ë‚´ë”›ëŠ”ë‹¤',
      'ë’·ë¬´ë¦ì´ ë°”ë‹¥ì— ê±°ì˜ ë‹¿ì„ ë•Œê¹Œì§€',
      'ì• ë¬´ë¦ì´ ë°œëì„ ë„˜ì§€ ì•Šê²Œ',
      '10íšŒì”© ì–‘ìª½',
    ],
    breathingGuide: {
      inhale: 'ë‚´ë”›ê¸°',
      exhale: 'ì¼ì–´ì„œê¸°',
      hold: 'ì—†ìŒ',
    },
    safetyNotes: ['ë¬´ë¦ í†µì¦ ì‹œ ê°€ë™ë²”ìœ„ ì¤„ì´ê¸°'],
    contraindications: ['knee_injury'],
  },
  {
    id: 'high_knees',
    nameKo: 'í•˜ì´ë‹ˆ',
    nameEn: 'High Knees',
    category: 'dynamic',
    type: 'dynamic',
    targetMuscles: ['hip_flexors', 'quadriceps', 'core'],
    defaultDuration: 30,
    defaultSets: 2,
    difficulty: 'intermediate',
    equipment: ['none'],
    instructions: [
      'ì œìë¦¬ì—ì„œ ë¬´ë¦ì„ ë†’ì´ ë“¤ì–´ì˜¬ë¦°ë‹¤',
      'ë¬´ë¦ì´ í—ˆë¦¬ ë†’ì´ê¹Œì§€',
      'íŒ”ì„ êµì°¨ë¡œ í”ë“ ë‹¤',
      '20íšŒ',
    ],
    breathingGuide: {
      inhale: 'ìì—°ìŠ¤ëŸ½ê²Œ',
      exhale: 'ìì—°ìŠ¤ëŸ½ê²Œ',
      hold: 'ì—†ìŒ',
    },
    safetyNotes: ['ì‹¬ì¥ ì§ˆí™˜ì ì£¼ì˜'],
    contraindications: ['heart_condition'],
  },

  // === ì „ì‹ /ë³µí•© (Full Body) ===
  {
    id: 'worlds_greatest_stretch',
    nameKo: 'ì›”ë“œ ê·¸ë ˆì´í‹°ìŠ¤íŠ¸ ìŠ¤íŠ¸ë ˆì¹­',
    nameEn: "World's Greatest Stretch",
    category: 'full_body',
    type: 'dynamic',
    targetMuscles: ['hip_flexors', 'hamstrings', 'thoracic_spine', 'groin'],
    defaultDuration: 60,
    defaultSets: 2,
    difficulty: 'intermediate',
    equipment: ['mat'],
    instructions: [
      'ëŸ°ì§€ ìì„¸ë¡œ ì‹œì‘',
      'ê°™ì€ ìª½ íŒ”ê¿ˆì¹˜ë¥¼ ë°”ë‹¥ì— ê°€ì ¸ê°„ë‹¤',
      'ê·¸ íŒ”ì„ ì²œì¥ìœ¼ë¡œ ë»—ìœ¼ë©° íšŒì „',
      'ë°˜ëŒ€ìª½ ë°˜ë³µ',
    ],
    breathingGuide: {
      inhale: 'íŒ” ì˜¬ë¦¬ê¸°',
      exhale: 'íŒ” ë‚´ë¦¬ê¸°',
      hold: 'ì—†ìŒ',
    },
    safetyNotes: ['ì—¬ëŸ¬ ë¶€ìœ„ë¥¼ ë™ì‹œì— ìŠ¤íŠ¸ë ˆì¹­í•˜ëŠ” íš¨ìœ¨ì  ë™ì‘'],
    contraindications: ['acute_low_back_pain'],
  },
  {
    id: 'childs_pose',
    nameKo: 'ì°¨ì¼ë“œ í¬ì¦ˆ',
    nameEn: "Child's Pose",
    category: 'full_body',
    type: 'static',
    targetMuscles: ['lats', 'erector_spinae', 'glutes'],
    defaultDuration: 60,
    defaultSets: 1,
    difficulty: 'beginner',
    equipment: ['mat'],
    instructions: [
      'ë¬´ë¦ì„ ê¿‡ê³  ì—‰ë©ì´ë¥¼ ë°œë’¤ê¿ˆì¹˜ì—',
      'ìƒì²´ë¥¼ ì•ìœ¼ë¡œ ìˆ™ì´ê³  íŒ”ì„ ì•ìœ¼ë¡œ ë»—ëŠ”ë‹¤',
      'ì´ë§ˆë¥¼ ë°”ë‹¥ì— ëŒ€ê³  íœ´ì‹',
      '60ì´ˆê°„ ìœ ì§€',
    ],
    breathingGuide: {
      inhale: 'ë“± í™•ì¥',
      exhale: 'ê¹Šì´ ì´ì™„',
      hold: 'ê¹Šì€ í˜¸í¡',
    },
    safetyNotes: ['ë¬´ë¦ í†µì¦ ì‹œ ì¿ ì…˜ ì‚¬ìš©'],
    contraindications: ['knee_injury'],
  },
];

export const EXERCISE_COUNT = STRETCHING_EXERCISES.length; // 20ê°œ
```

### 8.4 í‘œì¤€ ì…ë ¥ Mock (ê¸°ì¡´)

> ê¸°ì¡´ì— ì •ì˜ëœ í‘œì¤€ ìì„¸ ë¶„ì„ ì…ë ¥ Mockì…ë‹ˆë‹¤. (Section 8.5~8.8 ì°¸ì¡°)

---

### 8.5 í‘œì¤€ ìì„¸ ë¶„ì„ ì…ë ¥

**ì…ë ¥ ìŠ¤í™**

```typescript
// POST /api/v2/stretching/prescribe/posture
interface PosturePrescribeRequest {
  postureAssessmentId: string;   // C-1 ë¶„ì„ ê²°ê³¼ ID
  options?: {
    maxExercises?: number;       // ê¸°ë³¸ 8
    includePNF?: boolean;        // ê¸°ë³¸ false
    sessionDuration?: number;    // ëª©í‘œ ì‹œê°„ (ë¶„)
  };
}
```

**ì¶œë ¥ ìŠ¤í™**

```typescript
interface PosturePrescribeResponse {
  success: true;
  data: {
    id: string;                  // ì²˜ë°© ID
    prescription: PosturePrescriptionResult;
    assessmentSummary: {
      imbalanceCount: number;
      severeCount: number;
      overallScore: number;
    };
    savedToHistory: boolean;
  };
}
```

**ì„±ê³µ ê¸°ì¤€**

- [ ] ì¸ì¦ í™•ì¸ (Clerk)
- [ ] Rate Limit ì ìš© (20 req/1h)
- [ ] postureAssessmentIdë¡œ C-1 ê²°ê³¼ ì¡°íšŒ
- [ ] ë³¸ì¸ ë°ì´í„°ë§Œ ì ‘ê·¼ (RLS)
- [ ] W2-006 ì²˜ë°© ë¡œì§ í˜¸ì¶œ
- [ ] W2-012 ì•ˆì „ ì²´í¬ ì‹¤í–‰
- [ ] ì²˜ë°© ê²°ê³¼ stretching_prescriptions í…Œì´ë¸” ì €ì¥
- [ ] í†µí•© í…ŒìŠ¤íŠ¸ 5ê°œ ì´ìƒ
- [ ] typecheck í†µê³¼

**ì•Œê³ ë¦¬ì¦˜ ê°œìš”**
1. **ì¸ì¦ ë‹¨ê³„**:
   - Clerk `auth()` í˜¸ì¶œë¡œ userId ì¶”ì¶œ
   - userId ì—†ìœ¼ë©´ 401 AUTH_ERROR ë°˜í™˜
2. **Rate Limit ì²´í¬**:
   - `checkRateLimit(userId, 'stretching_prescribe')` (20 req/1h)
3. **ìì„¸ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ**:
   ```sql
   SELECT * FROM posture_assessments
   WHERE id = :postureAssessmentId
   AND clerk_user_id = :userId  -- RLS
   ```
4. **ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ**:
   ```sql
   SELECT * FROM stretching_user_profiles
   WHERE clerk_user_id = :userId
   ```
5. **ì²˜ë°© ìƒì„±** (W2-006 í˜¸ì¶œ):
   ```typescript
   const prescription = await prescribePostureStretching(
     postureAssessment,
     userProfile
   );
   ```
6. **ì•ˆì „ ì²´í¬** (W2-012 í˜¸ì¶œ):
   - ê²½ê³ /ë©´ì±… ì¡°í•­ í™•ì¸
7. **ê²°ê³¼ ì €ì¥**:
   ```sql
   INSERT INTO stretching_prescriptions
   (clerk_user_id, type, assessment_id, prescription_data, warnings)
   VALUES (...)
   ```
8. **ì‘ë‹µ ë°˜í™˜**:
   - ì„±ê³µ: prescription + ìš”ì•½ ì •ë³´
   - ì‹¤íŒ¨: ì ì ˆí•œ ì—ëŸ¬ ì½”ë“œ (401, 404, 429, 500)

**íŒŒì¼ ë°°ì¹˜**

| íŒŒì¼ ê²½ë¡œ | ë³€ê²½ ìœ í˜• | ì„¤ëª… |
|-----------|----------|------|
| `apps/web/app/api/v2/stretching/prescribe/posture/route.ts` | ì‹ ê·œ | API ë¼ìš°íŠ¸ |
| `apps/web/tests/api/stretching/prescribe-posture.test.ts` | ì‹ ê·œ | API í…ŒìŠ¤íŠ¸ |

---

> **ì°¸ê³ **: ìƒì„¸ êµ¬í˜„ ì›ì ì •ì˜ëŠ” Section 7ì˜ P3 ì›ì ë¶„í•´ (12ê°œ, 19ì‹œê°„)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

### 8.6 ê¸°ì¡´ í‘œì¤€ ì…ì¶œë ¥ Mock (ë ˆê±°ì‹œ)

> ê¸°ì¡´ì— ì •ì˜ëœ í‘œì¤€ Mock ë°ì´í„°ì…ë‹ˆë‹¤. Section 8.1-8.3ì˜ ì‹ ê·œ Mockê³¼ í•¨ê»˜ ì‚¬ìš©ë©ë‹ˆë‹¤.

---

## 9. ì¸í„°í˜ì´ìŠ¤ ì •ì˜

> **v1.4 ì¶”ê°€**: ì£¼ìš” TypeScript ì¸í„°í˜ì´ìŠ¤ ëª¨ìŒ

### 9.1 ì…ë ¥ ì¸í„°í˜ì´ìŠ¤

```typescript
// lib/stretching/types/input.ts

/**
 * ìŠ¤íŠ¸ë ˆì¹­ ë£¨í‹´ ìš”ì²­ ì…ë ¥
 */
export interface StretchingRoutineInput {
  source: 'janda' | 'sports' | 'custom';

  // Janda ê¸°ë°˜ ì²˜ë°© ì‹œ
  jandaParams?: {
    c2AnalysisId: string;
    includeActivations: boolean;
    focusSeverity?: 'mild' | 'moderate' | 'severe' | 'all';
  };

  // ìŠ¤í¬ì¸  ê¸°ë°˜ ì²˜ë°© ì‹œ
  sportsParams?: {
    sports: SportType[];
    timing: 'pre' | 'post';
    duration?: number;
  };

  // ê³µí†µ ì˜µì…˜
  options: {
    maxExercises: number;           // ê¸°ë³¸: 8
    maxDuration: number;            // ë¶„, ê¸°ë³¸: 20
    difficulty: 'beginner' | 'intermediate' | 'advanced';
    equipmentAvailable: Equipment[];
    excludeExercises?: string[];    // ì œì™¸í•  ìš´ë™ ID
  };

  // ì‚¬ìš©ì í”„ë¡œí•„
  userProfile: {
    age: number;
    fitnessLevel: FitnessLevel;
    healthConditions: HealthCondition[];
    recentInjuries: RecentInjury[];
  };
}

/**
 * ìŠ¤í¬ì¸  íƒ€ì…
 */
export type SportType =
  | 'running'
  | 'golf'
  | 'hiking'
  | 'swimming'
  | 'tennis'
  | 'desk_work'
  | 'cycling'
  | 'weight_training';

/**
 * ì¥ë¹„ íƒ€ì…
 */
export type Equipment =
  | 'none'
  | 'mat'
  | 'foam_roller'
  | 'resistance_band'
  | 'yoga_block'
  | 'wall'
  | 'chair'
  | 'doorframe';

/**
 * ì²´ë ¥ ìˆ˜ì¤€
 */
export type FitnessLevel =
  | 'sedentary'
  | 'lightly_active'
  | 'moderately_active'
  | 'very_active'
  | 'athlete';
```

### 9.2 ì¶œë ¥ ì¸í„°í˜ì´ìŠ¤

```typescript
// lib/stretching/types/output.ts

/**
 * ìŠ¤íŠ¸ë ˆì¹­ ë£¨í‹´ ê²°ê³¼
 */
export interface StretchingRoutineResult {
  routineId: string;
  createdAt: string;
  source: 'janda' | 'sports' | 'custom';

  exercises: StretchExercise[];
  totalDuration: number;             // ë¶„
  estimatedCalories: number;

  // Janda ê¸°ë°˜ì¼ ë•Œ
  jandaSummary?: {
    upperCrossSeverity: SeverityLevel;
    lowerCrossSeverity: SeverityLevel;
    priorityMuscles: string[];
    expectedImprovement: string;
  };

  // ìŠ¤í¬ì¸  ê¸°ë°˜ì¼ ë•Œ
  sportsSummary?: {
    targetSports: SportType[];
    timing: 'pre' | 'post';
    focusMuscles: string[];
    performanceTips: string[];
  };

  // ì•ˆì „ ì •ë³´
  safety: {
    disclaimerRequired: boolean;
    warnings: SafetyWarning[];
    excludedExercises: ExcludedExercise[];
  };

  // ë©”íƒ€ë°ì´í„°
  metadata: {
    generatedBy: 'ai' | 'rule_based';
    confidence: number;
    appliedAdjustments: string[];
  };
}

/**
 * ê°œë³„ ìŠ¤íŠ¸ë ˆì¹­ ìš´ë™
 */
export interface StretchExercise {
  id: string;
  nameKo: string;
  nameEn: string;

  // ìš´ë™ ì •ë³´
  category: ExerciseCategory;
  type: 'static' | 'dynamic' | 'pnf';
  targetMuscles: string[];

  // ì²˜ë°© ì •ë³´
  duration: number;                  // ì´ˆ
  sets: number;
  reps?: number;                     // ë™ì  ìŠ¤íŠ¸ë ˆì¹­ìš©
  holdTime?: number;                 // ì •ì  ìŠ¤íŠ¸ë ˆì¹­ìš© (ì´ˆ)

  // ì‹¤í–‰ ì •ë³´
  sequence: number;
  priority: 'high' | 'medium' | 'low';
  sides: 'bilateral' | 'left' | 'right' | 'alternating';

  // ê°€ì´ë“œ
  instructions: string[];
  breathingGuide: BreathingGuide;
  imageUrl?: string;
  videoUrl?: string;

  // ìˆ˜ì • ì‚¬í•­
  adjustments: ExerciseAdjustment[];
  notes: string[];
}

/**
 * ìš´ë™ ì¹´í…Œê³ ë¦¬
 */
export type ExerciseCategory =
  | 'neck_shoulder'
  | 'chest'
  | 'back'
  | 'hip'
  | 'leg'
  | 'full_body'
  | 'dynamic';

/**
 * í˜¸í¡ ê°€ì´ë“œ
 */
export interface BreathingGuide {
  inhale: string;
  exhale: string;
  hold?: string;
}

/**
 * ìš´ë™ ì¡°ì • ë‚´ì—­
 */
export interface ExerciseAdjustment {
  type: 'age' | 'fitness' | 'injury' | 'equipment';
  description: string;
  originalValue?: number | string;
  adjustedValue?: number | string;
}

/**
 * ì‹¬ê°ë„ ë ˆë²¨
 */
export type SeverityLevel = 'none' | 'mild' | 'moderate' | 'severe';
```

### 9.3 ìì„¸ êµì • ê³„íš ì¸í„°í˜ì´ìŠ¤

```typescript
// lib/stretching/types/correction.ts

/**
 * ìì„¸ êµì • ê³„íš
 */
export interface PostureCorrectionPlan {
  planId: string;
  userId: string;
  createdAt: string;
  updatedAt: string;

  // C-2 ë¶„ì„ ì—°ë™
  sourceAnalysis: {
    c2AnalysisId: string;
    analyzedAt: string;
    overallPostureScore: number;
  };

  // Janda ì§„ë‹¨
  jandaDiagnosis: {
    upperCross: CrossSyndromeDiagnosis;
    lowerCross: CrossSyndromeDiagnosis;
    combinedSeverity: SeverityLevel;
  };

  // êµì • ë‹¨ê³„
  phases: CorrectionPhase[];
  currentPhase: number;
  estimatedTotalWeeks: number;

  // ì£¼ê°„ ë£¨í‹´
  weeklyRoutines: WeeklyRoutine[];

  // ì§„í–‰ ìƒí™©
  progress: {
    startDate: string;
    currentWeek: number;
    completedSessions: number;
    averageCompletionRate: number;
    postureScoreHistory: PostureScoreEntry[];
  };

  // ë‹¤ìŒ ë‹¨ê³„ ì¶”ì²œ
  nextSteps: {
    recommendation: string;
    suggestedExercises: string[];
    scheduleAdjustment?: string;
  };
}

/**
 * Cross Syndrome ì§„ë‹¨
 */
export interface CrossSyndromeDiagnosis {
  detected: boolean;
  severity: SeverityLevel;
  confidence: number;

  tightMuscles: MuscleAssessment[];
  weakMuscles: MuscleAssessment[];

  associatedPostures: string[];
  rootCause: string;
}

/**
 * ê·¼ìœ¡ í‰ê°€
 */
export interface MuscleAssessment {
  muscleId: string;
  muscleName: string;
  assessmentScore: number;     // 0-100 (ë†’ì„ìˆ˜ë¡ ì‹¬ê°)
  location: string;
  priority: number;
}

/**
 * êµì • ë‹¨ê³„
 */
export interface CorrectionPhase {
  phaseNumber: number;
  name: string;
  description: string;
  durationWeeks: number;

  goals: string[];
  focusMuscles: string[];

  stretchingProtocol: {
    type: 'static' | 'dynamic' | 'pnf' | 'mixed';
    frequency: string;         // "3-5íšŒ/ì£¼"
    duration: string;          // "15-20ë¶„/ì„¸ì…˜"
  };

  activationProtocol?: {
    exercises: string[];
    frequency: string;
  };

  progressionCriteria: string[];
  warnings: string[];
}

/**
 * ì£¼ê°„ ë£¨í‹´
 */
export interface WeeklyRoutine {
  weekNumber: number;
  phase: number;

  sessions: DailySession[];
  totalMinutes: number;

  focusAreas: ('upper' | 'lower' | 'full')[];
  intensity: 'light' | 'moderate' | 'intensive';
}

/**
 * ì¼ì¼ ì„¸ì…˜
 */
export interface DailySession {
  dayOfWeek: DayOfWeek;
  isRestDay: boolean;

  exercises: StretchExercise[];
  estimatedDuration: number;
  focusArea: 'upper' | 'lower' | 'full';
  intensity: 'light' | 'moderate' | 'intensive';
}

/**
 * ìì„¸ ì ìˆ˜ ê¸°ë¡
 */
export interface PostureScoreEntry {
  date: string;
  overallScore: number;
  upperCrossScore: number;
  lowerCrossScore: number;
  notes?: string;
}

/**
 * ìš”ì¼
 */
export type DayOfWeek = 'monday' | 'tuesday' | 'wednesday' | 'thursday' | 'friday' | 'saturday' | 'sunday';
```

### 9.4 ì•ˆì „ ê´€ë ¨ ì¸í„°í˜ì´ìŠ¤

```typescript
// lib/stretching/types/safety.ts

/**
 * ê±´ê°• ìƒíƒœ
 */
export type HealthCondition =
  | 'pregnancy'
  | 'hypertension'
  | 'hypotension'
  | 'spinal_issue'
  | 'osteoporosis'
  | 'joint_replacement'
  | 'heart_condition'
  | 'vertigo'
  | 'herniated_disc'
  | 'recent_surgery'
  | 'chronic_pain';

/**
 * ìµœê·¼ ë¶€ìƒ
 */
export interface RecentInjury {
  bodyPart: string;
  severity: 'mild' | 'moderate' | 'severe';
  daysSinceInjury: number;
  isHealing: boolean;
  notes?: string;
}

/**
 * ì•ˆì „ ê²½ê³ 
 */
export interface SafetyWarning {
  level: 'info' | 'caution' | 'warning' | 'danger';
  message: string;
  affectedExercises: string[];
  recommendation: string;
}

/**
 * ì œì™¸ëœ ìš´ë™
 */
export interface ExcludedExercise {
  exerciseId: string;
  exerciseName: string;
  reason: string;
  relatedCondition: HealthCondition | string;
  alternative?: string;
}

/**
 * ì˜ë£Œ ë©´ì±… ì¡°í•­
 */
export interface MedicalDisclaimer {
  required: boolean;
  type: 'standard' | 'enhanced' | 'professional_required';
  text: string;
  mustAcknowledge: boolean;
  acknowledgedAt?: string;
}
```

---

## 10. ìƒì„¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë° ì—ëŸ¬ í•¸ë“¤ë§

> P3 ì›ì¹™ ì¤€ìˆ˜: â‰¤2ì‹œê°„ ë…ë¦½ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ì›ì ë‹¨ìœ„

### 10.0 Happy Path í…ŒìŠ¤íŠ¸ (Expected Values)

#### 10.0.1 ìš´ë™ ì‹œê°„/ê°•ë„ ê³„ì‚° ê³µì‹ ê²€ì¦

| TC-ID | í…ŒìŠ¤íŠ¸ëª… | ì…ë ¥ ì¡°ê±´ | Expected Value | í—ˆìš© ì˜¤ì°¨ | ê²€ì¦ ê³µì‹ |
|-------|----------|----------|----------------|----------|----------|
| **W2-HP01** | ê¸°ë³¸ ìŠ¤íŠ¸ë ˆì¹­ ì‹œê°„ | `severity: 'mild'`, `age: 30` | `baseDuration: 30` (ì´ˆ) | Â±0 | ê³ ì •ê°’ |
| **W2-HP02** | ì¤‘ê°„ ë¶ˆê· í˜• ì‹œê°„ | `severity: 'moderate'`, `age: 30` | `baseDuration: 45` (ì´ˆ) | Â±0 | ê³ ì •ê°’ |
| **W2-HP03** | ì‹¬ê° ë¶ˆê· í˜• ì‹œê°„ | `severity: 'severe'`, `age: 30` | `baseDuration: 60` (ì´ˆ) | Â±0 | ê³ ì •ê°’ |
| **W2-HP04** | ê³ ë ¹ì ì‹œê°„ ì¡°ì • (60ì„¸) | `age: 60`, `baseDuration: 45` | `adjustedDuration: 36` (ì´ˆ) | Â±1 | `base Ã— 0.8` |
| **W2-HP05** | ê³ ë ¹ì ì‹œê°„ ì¡°ì • (70ì„¸) | `age: 70`, `baseDuration: 45` | `adjustedDuration: 31` (ì´ˆ) | Â±1 | `base Ã— 0.7` |
| **W2-HP06** | ê³ ë ¹ì ì‹œê°„ ì¡°ì • (80ì„¸) | `age: 80`, `baseDuration: 45` | `adjustedDuration: 27` (ì´ˆ) | Â±1 | `base Ã— 0.6` |
| **W2-HP07** | ì²­ì†Œë…„ ì‹œê°„ ì¡°ì • | `age: 16`, `baseDuration: 45` | `adjustedDuration: 36` (ì´ˆ) | Â±1 | `base Ã— 0.8` |
| **W2-HP08** | ì´ˆë³´ì ê°•ë„ ì¡°ì • | `experience: 'none'` | `intensityLevel: 1` (1-5) | Â±0 | ê³ ì •ê°’ |
| **W2-HP09** | ì¤‘ê¸‰ì ê°•ë„ ì¡°ì • | `experience: 'intermediate'` | `intensityLevel: 3` (1-5) | Â±0 | ê³ ì •ê°’ |
| **W2-HP10** | ê³ ê¸‰ì ê°•ë„ ì¡°ì • | `experience: 'advanced'` | `intensityLevel: 5` (1-5) | Â±0 | ê³ ì •ê°’ |
| **W2-HP11** | ì´ ì„¸ì…˜ ì‹œê°„ ê³„ì‚° | `exercises: 6`, `avgDuration: 40s` | `totalDuration: 288` (ì´ˆ) | Â±10% | `n Ã— avg Ã— 1.2` (ì „í™˜ì‹œê°„ í¬í•¨) |
| **W2-HP12** | PNF ê°•ë„ ê³„ì‚° | `maxResistance: 100%` | `pnfIntensity: 75%` | Â±5% | ìµœëŒ€ 75% ì œí•œ |

#### 10.0.2 ìì„¸ ê°ë„ ê¸°ë°˜ ì²˜ë°© ê²€ì¦

| TC-ID | í…ŒìŠ¤íŠ¸ëª… | ì…ë ¥ ê°ë„ | Expected ì²˜ë°© | ê²€ì¦ ê¸°ì¤€ |
|-------|----------|----------|--------------|----------|
| **W2-HP13** | ì „ë°© ë¨¸ë¦¬ ìì„¸ | `headForwardAngle: 45Â°` | UCS í”„ë¡œí† ì½œ + ê²½ì¶” ìŠ¤íŠ¸ë ˆì¹­ | ê°ë„ > 30Â° ì‹œ íŠ¸ë¦¬ê±° |
| **W2-HP14** | ë‘¥ê·¼ ì–´ê¹¨ | `shoulderRounding: 25Â°` | UCS í”„ë¡œí† ì½œ + í‰ê·¼ ìŠ¤íŠ¸ë ˆì¹­ | ê°ë„ > 15Â° ì‹œ íŠ¸ë¦¬ê±° |
| **W2-HP15** | ê³¨ë°˜ ì „ë°© ê²½ì‚¬ | `pelvicTilt: 15Â°` | LCS í”„ë¡œí† ì½œ + ì¥ìš”ê·¼ ìŠ¤íŠ¸ë ˆì¹­ | ê°ë„ > 10Â° ì‹œ íŠ¸ë¦¬ê±° |
| **W2-HP16** | ë¬´ë¦ ê³¼ì‹ ì „ | `kneeHyperextension: 10Â°` | í–„ìŠ¤íŠ¸ë§ ê°•í™” + ëŒ€í‡´ì‚¬ë‘ê·¼ ìŠ¤íŠ¸ë ˆì¹­ | ê°ë„ > 5Â° ì‹œ íŠ¸ë¦¬ê±° |
| **W2-HP17** | ë³µí•© ë¶ˆê· í˜• | UCS + LCS ë™ì‹œ | ìƒë¶€ + í•˜ë¶€ í”„ë¡œí† ì½œ ë³‘í•© | ìš°ì„ ìˆœìœ„: ìƒë¶€ ë¨¼ì € |

#### 10.0.3 ìŠ¤í¬ì¸ ë³„ í”„ë¡œí† ì½œ ê²€ì¦

| TC-ID | í…ŒìŠ¤íŠ¸ëª… | ìŠ¤í¬ì¸  + Phase | Expected ìŠ¤íŠ¸ë ˆì¹­ íƒ€ì… | ê²€ì¦ ê¸°ì¤€ |
|-------|----------|---------------|---------------------|----------|
| **W2-HP18** | ëŸ¬ë‹ ì›Œë°ì—… | `sport: 'running'`, `phase: 'warmup'` | ë™ì  ìŠ¤íŠ¸ë ˆì¹­ 100% | ì •ì  ìŠ¤íŠ¸ë ˆì¹­ 0% |
| **W2-HP19** | ëŸ¬ë‹ ì¿¨ë‹¤ìš´ | `sport: 'running'`, `phase: 'cooldown'` | ì •ì  ìŠ¤íŠ¸ë ˆì¹­ â‰¥80% | ë™ì  ìŠ¤íŠ¸ë ˆì¹­ â‰¤20% |
| **W2-HP20** | ê³¨í”„ ì›Œë°ì—… | `sport: 'golf'`, `phase: 'warmup'` | íšŒì „ ë™ì  ìŠ¤íŠ¸ë ˆì¹­ í¬í•¨ | thoracic rotation í•„ìˆ˜ |
| **W2-HP21** | ìˆ˜ì˜ ì¿¨ë‹¤ìš´ | `sport: 'swimming'`, `phase: 'cooldown'` | ì–´ê¹¨/ë“± ì •ì  ìŠ¤íŠ¸ë ˆì¹­ | shoulder stretches í•„ìˆ˜ |

### 10.1 Edge Case í…ŒìŠ¤íŠ¸

#### 10.1.1 ì—°ë ¹ ê´€ë ¨ Edge Cases

| TC-ID | í…ŒìŠ¤íŠ¸ëª… | ì…ë ¥ ì¡°ê±´ | Expected ë™ì‘ | ìš°ì„ ìˆœìœ„ |
|-------|----------|----------|--------------|----------|
| **W2-E01** | ê³ ë ¹ì ê²½ê³„ê°’ (60ì„¸ ì •í™•íˆ) | `age: 60` | ê³ ë ¹ì í”„ë¡œí† ì½œ ì ìš©, ì‹œê°„ 20% ê°ì†Œ | P0 |
| **W2-E02** | ê³ ë ¹ì ìƒí•œ (90ì„¸ ì´ìƒ) | `age: 95` | ìµœì†Œ ì‹œê°„ (20ì´ˆ) ì ìš©, ì „ë¬¸ê°€ ìƒë‹´ ê¶Œê³  | P0 |
| **W2-E03** | ì²­ì†Œë…„ ê²½ê³„ê°’ (18ì„¸ ë¯¸ë§Œ) | `age: 17` | ì„±ì¥ê¸° ì£¼ì˜ì‚¬í•­ í¬í•¨, ì‹œê°„ 20% ê°ì†Œ | P1 |
| **W2-E04** | ì—°ë ¹ null | `age: null` | ê¸°ë³¸ ì„±ì¸ (30ì„¸) í”„ë¡œí† ì½œ ì ìš© | P1 |
| **W2-E05** | ì—°ë ¹ 0ì„¸ (ì˜ëª»ëœ ì…ë ¥) | `age: 0` | `VALIDATION_ERROR` ë°˜í™˜ | P1 |
| **W2-E06** | ì—°ë ¹ ìŒìˆ˜ | `age: -5` | `VALIDATION_ERROR` ë°˜í™˜ | P1 |

#### 10.1.2 ë¶€ìƒ ì´ë ¥ Edge Cases

| TC-ID | í…ŒìŠ¤íŠ¸ëª… | ì…ë ¥ ì¡°ê±´ | Expected ë™ì‘ | ìš°ì„ ìˆœìœ„ |
|-------|----------|----------|--------------|----------|
| **W2-E07** | ë‹¨ì¼ ë¶€ìƒ ì´ë ¥ | `injuries: [{area: 'lower_back', type: 'disc_herniation'}]` | ìš”ì¶” êµ´ê³¡ ìš´ë™ ì œì™¸, ëŒ€ì²´ ìš´ë™ ì œê³µ | P0 |
| **W2-E08** | ë‹¤ì¤‘ ë¶€ìƒ ì´ë ¥ | `injuries: [{area: 'lower_back'}, {area: 'knee'}]` | í•´ë‹¹ ë¶€ìœ„ ëª¨ë‘ ì œì™¸, ì¶•ì†Œëœ ë£¨í‹´ | P0 |
| **W2-E09** | ê¸‰ì„± ë¶€ìƒ (72ì‹œê°„ ì´ë‚´) | `injuries: [{...}, {isAcute: true}]` | í•´ë‹¹ ë¶€ìœ„ ì™„ì „ ì œì™¸, ì˜ë£Œ ìƒë‹´ ê¶Œê³  | P0 |
| **W2-E10** | ì¬í™œ ì¤‘ ë¶€ìƒ | `injuries: [{status: 'recovering'}]` | ì €ê°•ë„ë§Œ í—ˆìš©, ì „ë¬¸ê°€ ê°ë… ê¶Œê³  | P1 |
| **W2-E11** | ëª¨ë“  ì£¼ìš” ë¶€ìœ„ ë¶€ìƒ | ìƒì²´+í•˜ì²´+ì½”ì–´ ëª¨ë‘ ë¶€ìƒ | `BLOCKED_ERROR` (422) + ì „ë¬¸ê°€ ìƒë‹´ í•„ìˆ˜ | P0 |
| **W2-E12** | ë¶€ìƒ ì´ë ¥ ë°°ì—´ empty | `injuries: []` | ì¼ë°˜ í”„ë¡œí† ì½œ ì ìš© | P2 |

#### 10.1.3 íŠ¹ìˆ˜ ìƒíƒœ Edge Cases

| TC-ID | í…ŒìŠ¤íŠ¸ëª… | ì…ë ¥ ì¡°ê±´ | Expected ë™ì‘ | ìš°ì„ ìˆœìœ„ |
|-------|----------|----------|--------------|----------|
| **W2-E13** | ì„ì‚°ë¶€ (1ë¶„ê¸°) | `specialConditions: ['pregnancy_trimester1']` | ì¼ë°˜ í”„ë¡œí† ì½œ, ë³µë¶€ ì£¼ì˜ | P0 |
| **W2-E14** | ì„ì‚°ë¶€ (3ë¶„ê¸°) | `specialConditions: ['pregnancy_trimester3']` | ì•™ì™€ìœ„ ê¸ˆì§€, ì¸¡ì™€ìœ„ë¡œ ëŒ€ì²´ | P0 |
| **W2-E15** | ê³¨ë‹¤ê³µì¦ | `specialConditions: ['osteoporosis']` | ì²™ì¶” êµ´ê³¡/íšŒì „ ì œì™¸ | P0 |
| **W2-E16** | ê³ í˜ˆì•• | `specialConditions: ['hypertension']` | ì—­ìœ„ ìì„¸ ì œì™¸ | P1 |
| **W2-E17** | ë³µí•© íŠ¹ìˆ˜ ìƒíƒœ | ì„ì‹  + ê³ í˜ˆì•• | ëª¨ë“  ì œí•œì‚¬í•­ ëˆ„ì  ì ìš© | P0 |
| **W2-E18** | ì•Œ ìˆ˜ ì—†ëŠ” íŠ¹ìˆ˜ ìƒíƒœ | `specialConditions: ['unknown_condition']` | ë¬´ì‹œí•˜ê³  ì¼ë°˜ ì²˜ë¦¬, ë¡œê·¸ ê¸°ë¡ | P2 |

#### 10.1.4 ìì„¸ ë¶ˆê· í˜• ì‹¬ê°ë„ Edge Cases

| TC-ID | í…ŒìŠ¤íŠ¸ëª… | ì…ë ¥ ì¡°ê±´ | Expected ë™ì‘ | ìš°ì„ ìˆœìœ„ |
|-------|----------|----------|--------------|----------|
| **W2-E19** | ì‹¬ê°í•œ ë¶ˆê· í˜• ê²½ê³„ê°’ | `severity: 'severe'` | ì „ë¬¸ê°€ ìƒë‹´ ê¶Œê³  ê²½ê³  í¬í•¨ | P0 |
| **W2-E20** | ê·¹ì‹¬í•œ ë¶ˆê· í˜• | ëª¨ë“  ê°ë„ ì§€í‘œ ê·¹ë‹¨ê°’ | ìš´ë™ ì²˜ë°© ê±°ë¶€, ì „ë¬¸ê°€ ìƒë‹´ í•„ìˆ˜ | P0 |
| **W2-E21** | ë¶ˆê· í˜• ì—†ìŒ | ëª¨ë“  ê°ë„ ì •ìƒ ë²”ìœ„ | ìœ ì§€ ìŠ¤íŠ¸ë ˆì¹­ ë£¨í‹´ ì œê³µ | P1 |
| **W2-E22** | ë¶ˆê· í˜• ë°ì´í„° ë¶ˆì™„ì „ | ì¼ë¶€ ê°ë„ë§Œ ì¸¡ì •ë¨ | ê°€ìš© ë°ì´í„°ë¡œ ì²˜ë°©, ì‹ ë¢°ë„ í‘œì‹œ | P1 |

### 10.2 ì—ëŸ¬ í•¸ë“¤ë§ ì‹œë‚˜ë¦¬ì˜¤

#### 10.2.1 Partial Failure ì²˜ë¦¬

| ì‹œë‚˜ë¦¬ì˜¤ | ì‹¤íŒ¨ ì§€ì  | ì²˜ë¦¬ ë°©ì‹ | ì‚¬ìš©ì ì•Œë¦¼ |
|----------|----------|----------|------------|
| C-1 ì—°ë™ ì‹¤íŒ¨ | ìì„¸ ë¶„ì„ ë°ì´í„° ì¡°íšŒ | ì¼ë°˜ ìŠ¤íŠ¸ë ˆì¹­ fallback ì œê³µ | "ê°œì¸í™”ëœ ë¶„ì„ ì—†ì´ ì¼ë°˜ ë£¨í‹´ì„ ì œê³µí•©ë‹ˆë‹¤" |
| ì¼ë¶€ ìš´ë™ ê¸ˆê¸° | íŠ¹ì • ìš´ë™ í•„í„°ë§ ì¤‘ | í•´ë‹¹ ìš´ë™ ì œì™¸, ëŒ€ì²´ ìš´ë™ ì¶”ê°€ | "ì¼ë¶€ ìš´ë™ì´ ê±´ê°• ìƒíƒœì— ë§ê²Œ ì¡°ì •ë˜ì—ˆìŠµë‹ˆë‹¤" |
| í”„ë¡œí•„ ì¡°íšŒ ì‹¤íŒ¨ | ì‚¬ìš©ì í”„ë¡œí•„ DB ì˜¤ë¥˜ | ê¸°ë³¸ í”„ë¡œí•„ (ì„±ì¸, ì´ˆë³´ì) ì ìš© | "ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ë£¨í‹´ì„ ìƒì„±í•©ë‹ˆë‹¤" |
| ì˜ìƒ URL ë¡œë“œ ì‹¤íŒ¨ | ìš´ë™ ì˜ìƒ CDN ì˜¤ë¥˜ | í…ìŠ¤íŠ¸ ì„¤ëª… + ì´ë¯¸ì§€ë§Œ í‘œì‹œ | "ì˜ìƒì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„¤ëª…ì„ ì°¸ê³ í•´ì£¼ì„¸ìš”" |
| ì„¸ì…˜ ì €ì¥ ì‹¤íŒ¨ | ì§„í–‰ ê¸°ë¡ DB ì˜¤ë¥˜ | ë¡œì»¬ ìºì‹œ ì €ì¥ í›„ ì¬ì‹œë„ í | "ê¸°ë¡ì´ ì¼ì‹œì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤" |

#### 10.2.2 Graceful Fallback ì „ëµ

```typescript
// W-2 Fallback ì²´ê³„
interface W2FallbackConfig {
  // Level 1: C-1 ì—°ë™ ì‹¤íŒ¨ ì‹œ
  postureDataUnavailable: {
    action: 'use_general_routine';
    routine: 'full_body_maintenance';
    confidence: 0.5;
    userMessage: 'ìì„¸ ë¶„ì„ ì—†ì´ ì¼ë°˜ ìœ ì§€ ë£¨í‹´ì„ ì œê³µí•©ë‹ˆë‹¤';
  };

  // Level 2: ì‚¬ìš©ì í”„ë¡œí•„ ì—†ìŒ
  profileUnavailable: {
    action: 'use_default_profile';
    defaults: {
      age: 30,
      experience: 'beginner',
      injuries: [],
      specialConditions: []
    };
    confidence: 0.7;
    userMessage: 'ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ë§ì¶¤ ë£¨í‹´ì„ ìƒì„±í•©ë‹ˆë‹¤';
  };

  // Level 3: ëª¨ë“  ìš´ë™ ê¸ˆê¸°
  allExercisesBlocked: {
    action: 'require_professional';
    alternatives: ['ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ìƒë‹´', 'ì˜ì‚¬ ì§„ë£Œ'];
    httpStatus: 422;
    userMessage: 'í˜„ì¬ ê±´ê°• ìƒíƒœì—ì„œëŠ” ì „ë¬¸ê°€ ìƒë‹´ì´ í•„ìš”í•©ë‹ˆë‹¤';
  };
}
```

#### 10.2.3 ì „ë¬¸ê°€ ìƒë‹´ ê¶Œìœ  íŠ¸ë¦¬ê±°

| TC-ID | ì¡°ê±´ | íŠ¸ë¦¬ê±° ê¸°ì¤€ | ê¶Œìœ  ê°•ë„ | ë©”ì‹œì§€ |
|-------|------|------------|----------|--------|
| **W2-PRO01** | ì‹¬ê°í•œ ìì„¸ ë¶ˆê· í˜• | `severity: 'severe'` | ê¶Œê³  (optional) | "ì¦ìƒ ê°œì„ ì´ ë”ë””ë©´ ì „ë¬¸ê°€ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤" |
| **W2-PRO02** | ê·¹ì‹¬í•œ ìì„¸ ë¶ˆê· í˜• | ëª¨ë“  ì§€í‘œ ê·¹ë‹¨ê°’ | í•„ìˆ˜ (blocking) | "í˜„ì¬ ìƒíƒœì—ì„œ ìê°€ ìš´ë™ì€ ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤" |
| **W2-PRO03** | ê¸‰ì„± ë¶€ìƒ + ìš´ë™ ì‹œë„ | `isAcute: true` | í•„ìˆ˜ (blocking) | "ê¸‰ì„± ë¶€ìƒ ì‹œì—ëŠ” ì˜ë£Œ ì „ë¬¸ê°€ ìƒë‹´ì´ í•„ìš”í•©ë‹ˆë‹¤" |
| **W2-PRO04** | í†µì¦ ë¦¬í¬íŠ¸ ë°˜ë³µ | 3íšŒ ì—°ì† í†µì¦ ê¸°ë¡ | ê°•ë ¥ ê¶Œê³  | "ì§€ì†ì ì¸ í†µì¦ì´ ìˆìŠµë‹ˆë‹¤. ì „ë¬¸ê°€ ìƒë‹´ì„ ë°›ì•„ë³´ì„¸ìš”" |
| **W2-PRO05** | ê³ ë ¹ì + ì‹¬ê° ë¶ˆê· í˜• | `age >= 70` && `severity: 'severe'` | í•„ìˆ˜ (blocking) | "ì•ˆì „ì„ ìœ„í•´ ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ìƒë‹´ í›„ ìš´ë™ì„ ì‹œì‘í•˜ì„¸ìš”" |
| **W2-PRO06** | ì§„í–‰ ì •ì²´ | 8ì£¼ ì´ìƒ ê°œì„  ì—†ìŒ | ê¶Œê³  | "ìš´ë™ ë°©ë²• ì ê²€ì„ ìœ„í•´ ì „ë¬¸ê°€ ìƒë‹´ì„ ê³ ë ¤í•´ë³´ì„¸ìš”" |

#### 10.2.4 ì‚¬ìš©ì ì„ íƒ í”Œë¡œìš°

```typescript
// ì‚¬ìš©ì ê²°ì •ì´ í•„ìš”í•œ ìƒí™©
interface UserDecisionPoint {
  // ê¸ˆê¸° ìš´ë™ ëŒ€ì²´ ì„ íƒ
  contraindictedExercise: {
    trigger: 'ê¸ˆê¸° ìš´ë™ ê°ì§€';
    options: [
      { id: 'skip', label: 'ì´ ìš´ë™ ê±´ë„ˆë›°ê¸°' },
      { id: 'alternative', label: 'ëŒ€ì²´ ìš´ë™ ìˆ˜í–‰í•˜ê¸°' },
      { id: 'proceed_caution', label: 'ì£¼ì˜í•˜ë©° ì§„í–‰ (ë¹„ê¶Œì¥)' }
    ];
    default: 'alternative';
    timeout: 30000; // 30ì´ˆ í›„ default ì ìš©
  };

  // ê°•ë„ ì¡°ì ˆ ì„ íƒ
  intensityAdjustment: {
    trigger: 'ì˜ˆìƒë³´ë‹¤ í˜ë“¤ë‹¤ê³  í”¼ë“œë°±';
    options: [
      { id: 'reduce_20', label: 'ê°•ë„ 20% ë‚®ì¶”ê¸°' },
      { id: 'reduce_40', label: 'ê°•ë„ 40% ë‚®ì¶”ê¸°' },
      { id: 'stop_session', label: 'ì˜¤ëŠ˜ ì„¸ì…˜ ì¢…ë£Œ' }
    ];
    default: 'reduce_20';
  };

  // ì „ë¬¸ê°€ ìƒë‹´ ê¶Œê³  ì‘ë‹µ
  professionalConsultation: {
    trigger: 'ì „ë¬¸ê°€ ìƒë‹´ ê¶Œê³  í‘œì‹œ';
    options: [
      { id: 'schedule_later', label: 'ë‚˜ì¤‘ì— ì˜ˆì•½í•˜ê¸°' },
      { id: 'find_provider', label: 'ì£¼ë³€ ì „ë¬¸ê°€ ì°¾ê¸°' },
      { id: 'continue_aware', label: 'ì¸ì§€í•˜ê³  ê³„ì†í•˜ê¸°' }
    ];
    recordChoice: true; // ì„ íƒ ê¸°ë¡ ì €ì¥
  };
}
```

### 10.3 í…ŒìŠ¤íŠ¸ ë°ì´í„° Fixtures

```typescript
// tests/fixtures/w2-stretching.ts

// ê³ ë ¹ì í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
export const elderlyUser = {
  age: 72,
  experience: 'intermediate',
  injuries: [{ area: 'knee', type: 'arthritis', severity: 'mild' }],
  specialConditions: ['hypertension'],
  postureData: {
    headForwardAngle: 35,
    shoulderRounding: 20,
    pelvicTilt: 12
  }
};

// ë¶€ìƒ ì´ë ¥ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
export const injuredUser = {
  age: 35,
  experience: 'advanced',
  injuries: [
    { area: 'lower_back', type: 'disc_herniation', status: 'recovering' },
    { area: 'shoulder', type: 'rotator_cuff', isAcute: false }
  ],
  specialConditions: []
};

// ì„ì‚°ë¶€ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
export const pregnantUser = {
  age: 28,
  experience: 'intermediate',
  injuries: [],
  specialConditions: ['pregnancy_trimester2'],
  postureData: {
    pelvicTilt: 18, // ì„ì‹ ìœ¼ë¡œ ì¸í•œ ìì—°ìŠ¤ëŸ¬ìš´ ë³€í™”
    lumbarLordosis: 45
  }
};

// ì‹¬ê°í•œ ë¶ˆê· í˜• í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
export const severeImbalanceUser = {
  age: 45,
  experience: 'none',
  injuries: [],
  specialConditions: [],
  postureData: {
    headForwardAngle: 55, // ê·¹ë‹¨ê°’
    shoulderRounding: 35, // ê·¹ë‹¨ê°’
    pelvicTilt: 20,
    kneevalgus: 15
  }
};
```

---

## 11. í…ŒìŠ¤íŠ¸ ì „ëµ

> ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ì „ëµê³¼ í†µí•©ë¨. ì‹ ê·œ ì›ì(W-2.1~W-2.12)ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ í¬í•¨.

### 10.0 ì‹ ê·œ ì›ì í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€

| ì›ì ID | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ | í†µí•© í…ŒìŠ¤íŠ¸ | ë¹„ê³  |
|---------|------------|------------|------|
| W-2.1 | íƒ€ì… ë³€í™˜ ì •í™•ë„ | C-2 ì—°ë™ | - |
| W-2.2 | UCS/LCS ì§„ë‹¨ ë¡œì§ | ì§„ë‹¨â†’ì²˜ë°© íë¦„ | - |
| W-2.3 | í”„ë¡œí† ì½œ ë§¤í•‘ | ì²˜ë°© API E2E | - |
| W-2.4 | ìŠ¤í¬ì¸ ë³„ ë£¨í‹´ ìƒì„± | ìŠ¤í¬ì¸  API E2E | - |
| W-2.5 | ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§ | ì•ˆì „ ì²´í¬ í†µí•© | - |
| W-2.6 | ì—°ë ¹ë³„ ì¡°ì • | ê³ ë ¹ì ì‹œë‚˜ë¦¬ì˜¤ | - |
| W-2.7 | API ì‘ë‹µ í˜•ì‹ | ì „ì²´ API E2E | - |
| W-2.8 | UI ì»´í¬ë„ŒíŠ¸ | ì„¸ì…˜ í”Œë ˆì´ì–´ E2E | - |
| W-2.9 | ì§„í–‰ ì¶”ì  ê³„ì‚° | í†µê³„ ëŒ€ì‹œë³´ë“œ | - |
| W-2.10 | ì €ì¥/ì¡°íšŒ | DB íŠ¸ëœì­ì…˜ | - |
| W-2.11 | ê²½ê³  ìƒì„± | ì•ˆì „ ì•Œë¦¼ íë¦„ | - |
| W-2.12 | ì „ì²´ í†µí•© | íšŒê·€ í…ŒìŠ¤íŠ¸ | - |

### 10.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

> ì•„ë˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ê¸°ì¡´ ì •ì˜ì™€ ì‹ ê·œ W-2.1~W-2.12 ì›ìë¥¼ í†µí•© ì»¤ë²„í•©ë‹ˆë‹¤.

| ID | í…ŒìŠ¤íŠ¸ëª… | ì…ë ¥ | ê¸°ëŒ€ ê²°ê³¼ | ìš°ì„ ìˆœìœ„ |
|----|----------|------|----------|----------|
| **W2-U01** | ìƒë¶€êµì°¨ì¦í›„êµ° ì²˜ë°© | imbalances=[upper_cross] | ëŒ€í‰ê·¼+ìƒë¶€ìŠ¹ëª¨ê·¼ ìŠ¤íŠ¸ë ˆì¹­ í¬í•¨ | P0 |
| **W2-U02** | í•˜ë¶€êµì°¨ì¦í›„êµ° ì²˜ë°© | imbalances=[lower_cross] | ì¥ìš”ê·¼+ëŒ€í‡´ì§ê·¼ ìŠ¤íŠ¸ë ˆì¹­ í¬í•¨ | P0 |
| **W2-U03** | ë³µí•© ë¶ˆê· í˜• ì²˜ë°© | imbalances=[upper+lower] | ìƒë¶€+í•˜ë¶€ ëª¨ë‘ í¬í•¨, ìš°ì„ ìˆœìœ„ ì •ë ¬ | P0 |
| **W2-U04** | ê²½ë¯¸í•œ ë¶ˆê· í˜• | severity=mild | ê¸°ë³¸ ì‹œê°„/ì„¸íŠ¸, ê²½ê³  ì—†ìŒ | P1 |
| **W2-U05** | ì‹¬ê°í•œ ë¶ˆê· í˜• | severity=severe | ì „ë¬¸ê°€ ìƒë‹´ ê¶Œê³  ê²½ê³  í¬í•¨ | P0 |
| **W2-U06** | ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§ | contraindications=[disc_herniation] | ì²™ì¶” êµ´ê³¡ ìš´ë™ ì œì™¸ | P0 |
| **W2-U07** | ê³ ë ¹ì ì‹œê°„ ì¡°ì • | age=70 | adjustedDuration 30-60ì´ˆ ë²”ìœ„ | P0 |
| **W2-U08** | ì„ì‚°ë¶€ ìš´ë™ ìˆ˜ì • | specialConditions=[pregnancy] | ì•™ì™€ìœ„ ìš´ë™ ì¸¡ì™€ìœ„ë¡œ ë³€ê²½ | P0 |
| **W2-U09** | ê³¨ë‹¤ê³µì¦ ìš´ë™ ì œì™¸ | specialConditions=[osteoporosis] | ì²™ì¶” êµ´ê³¡ ìš´ë™ ì œì™¸ | P1 |
| **W2-U10** | ì¥ë¹„ í•„í„°ë§ | availableEquipment=[bodyweight] | í¼ë¡¤ëŸ¬ ìš´ë™ ì œì™¸ | P1 |
| **W2-U11** | ì²˜ë°© ìš´ë™ ìˆ˜ ì œí•œ | ë‹¤ìˆ˜ ë¶ˆê· í˜• | ìµœëŒ€ 8ê°œ ìŠ¤íŠ¸ë ˆì¹­ | P1 |
| **W2-U12** | ì´ ì†Œìš”ì‹œê°„ ë²”ìœ„ | ë‹¤ì–‘í•œ ì…ë ¥ | 15-45ë¶„ ë²”ìœ„ | P1 |
| **W2-U13** | ëŸ¬ë‹ ì›Œë°ì—… í”„ë¡œí† ì½œ | sport=running, phase=warmup | ë™ì  ìŠ¤íŠ¸ë ˆì¹­ë§Œ, ì •ì  ì œì™¸ | P0 |
| **W2-U14** | ëŸ¬ë‹ ì¿¨ë‹¤ìš´ í”„ë¡œí† ì½œ | sport=running, phase=cooldown | ì •ì  ìŠ¤íŠ¸ë ˆì¹­ í¬í•¨ | P0 |
| **W2-U15** | ê³¨í”„ ì›Œë°ì—… í”„ë¡œí† ì½œ | sport=golf, phase=warmup | íšŒì „ ë™ì  ìŠ¤íŠ¸ë ˆì¹­ í¬í•¨ | P1 |
| **W2-U16** | PNF ì›Œë°ì—… ê¸ˆì§€ | context=warmup | canApplyPNF=false | P0 |
| **W2-U17** | PNF ì´ˆë³´ì ì œì™¸ | stretchingExperience=none | canApplyPNF=false | P1 |
| **W2-U18** | PNF ê³ ë ¹ì í”„ë¡œí† ì½œ | age=70, context=cooldown | ë³´ìˆ˜ì  í”„ë¡œí† ì½œ ì ìš© | P1 |
| **W2-U19** | ì£¼ê°„ í”Œëœ 3íšŒ | sessionsPerWeek=3 | ì›”-ìˆ˜-ê¸ˆ ë°°ì¹˜ | P1 |
| **W2-U20** | ì£¼ê°„ í”Œëœ ì‹¬ê° | severity=severe | ë§¤ì¼ ìŠ¤íŠ¸ë ˆì¹­ | P1 |
| **W2-U21** | ì•ˆì „ ì²´í¬ - ë¸”ë¡ | 50% ì´ìƒ ìš´ë™ ê¸ˆê¸° | canProceed=false | P0 |
| **W2-U22** | ì•ˆì „ ì²´í¬ - ê²½ê³  | ì¼ë¶€ ìš´ë™ ê¸ˆê¸° | level=warning | P1 |
| **W2-U23** | Red Flag í¬í•¨ í™•ì¸ | ëª¨ë“  ìš´ë™ | redFlags í•„ë“œ ì¡´ì¬ | P0 |
| **W2-U24** | ì˜ë£Œ ë©´ì±…ì¡°í•­ í¬í•¨ | ëª¨ë“  ì²˜ë°© | medicalDisclaimer ì¡´ì¬ | P0 |

### 10.2 í†µí•© í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

| ID | í…ŒìŠ¤íŠ¸ëª… | ì „ì œ ì¡°ê±´ | ì…ë ¥ | ê¸°ëŒ€ ê²°ê³¼ | ìš°ì„ ìˆœìœ„ |
|----|----------|----------|------|----------|----------|
| **W2-I01** | ìì„¸ ì²˜ë°© API ì„±ê³µ | ì¸ì¦+C-1 ê²°ê³¼ ì¡´ì¬ | postureAssessmentId | status=200, stretches ì¡´ì¬ | P0 |
| **W2-I02** | ìŠ¤í¬ì¸  ì²˜ë°© API ì„±ê³µ | ì¸ì¦ë¨ | sport=running, phase=warmup | status=200, ë™ì  ìŠ¤íŠ¸ë ˆì¹­ | P0 |
| **W2-I03** | ì£¼ê°„ í”Œëœ API ì„±ê³µ | ì¸ì¦+ì²˜ë°© ì¡´ì¬ | prescriptionId | status=200, 7ì¼ í”Œëœ | P0 |
| **W2-I04** | DB ì €ì¥ í™•ì¸ | ì²˜ë°© ì™„ë£Œ | ì²˜ë°© ê²°ê³¼ | stretching_prescriptions ë ˆì½”ë“œ ìƒì„± | P0 |
| **W2-I05** | C-1 ì—°ë™ | C-1 ë¶„ì„ ì™„ë£Œ | postureAssessmentId | ìì„¸ ê°ë„ ê¸°ë°˜ ì²˜ë°© | P0 |
| **W2-I06** | ì‚¬ìš©ì í”„ë¡œí•„ ì—°ë™ | í”„ë¡œí•„ ì¡´ì¬ | userId | ê°œì¸í™”ëœ ì²˜ë°© | P1 |
| **W2-I07** | Rate Limit | 20íšŒ ì´ˆê³¼ | 21ë²ˆì§¸ ìš”ì²­ | status=429 | P0 |
| **W2-I08** | Fallback ë°˜í™˜ | C-1 ê²°ê³¼ ì—†ìŒ | ë¹ˆ assessmentId | ì¼ë°˜ ìŠ¤íŠ¸ë ˆì¹­ ë°˜í™˜ | P1 |
| **W2-I09** | ì„¸ì…˜ ê¸°ë¡ ì €ì¥ | ì„¸ì…˜ ì™„ë£Œ | completedExercises | stretching_sessions ì €ì¥ | P1 |
| **W2-I10** | ì§„í–‰ ì¶”ì  ì¡°íšŒ | ê¸°ë¡ ì¡´ì¬ | userId | ì£¼ê°„ í†µê³„ ë°˜í™˜ | P2 |

### 10.3 ì—ëŸ¬ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

| ID | í…ŒìŠ¤íŠ¸ëª… | ì…ë ¥ | ê¸°ëŒ€ ì—ëŸ¬ | HTTP ìƒíƒœ | ìš°ì„ ìˆœìœ„ |
|----|----------|------|----------|----------|----------|
| **W2-E01** | ì¸ì¦ ì—†ìŒ | í† í° ì—†ì´ ìš”ì²­ | AUTH_ERROR | 401 | P0 |
| **W2-E02** | ì˜ëª»ëœ assessmentId | 'invalid-uuid' | VALIDATION_ERROR | 400 | P0 |
| **W2-E03** | ì¡´ì¬í•˜ì§€ ì•ŠëŠ” assessment | ì—†ëŠ” UUID | NOT_FOUND | 404 | P0 |
| **W2-E04** | ë‹¤ë¥¸ ì‚¬ìš©ì assessment | íƒ€ì¸ì˜ assessmentId | NOT_FOUND (RLS) | 404 | P0 |
| **W2-E05** | ì˜ëª»ëœ sport ê°’ | sport='invalid' | VALIDATION_ERROR | 400 | P1 |
| **W2-E06** | ì˜ëª»ëœ phase ê°’ | phase='invalid' | VALIDATION_ERROR | 400 | P1 |
| **W2-E07** | Rate Limit ì´ˆê³¼ | 20íšŒ ì´ˆê³¼ ìš”ì²­ | RATE_LIMIT_ERROR | 429 | P0 |
| **W2-E08** | DB ì €ì¥ ì‹¤íŒ¨ | Supabase ì˜¤ë¥˜ | DB_ERROR | 500 | P1 |
| **W2-E09** | ëª¨ë“  ìš´ë™ ê¸ˆê¸° | ì „ì²´ ê¸ˆê¸°ì‚¬í•­ | BLOCKED_ERROR | 422 | P1 |
| **W2-E10** | í”„ë¡œí•„ ì—†ìŒ | í”„ë¡œí•„ ë¯¸ìƒì„± | ê¸°ë³¸ê°’ìœ¼ë¡œ ì²˜ë°© | 200 | P2 |
| **W2-E11** | ì˜ëª»ëœ options | maxExercises=-1 | VALIDATION_ERROR | 400 | P2 |
| **W2-E12** | ì„¸ì…˜ ID ì—†ìŒ | ì—†ëŠ” sessionId | NOT_FOUND | 404 | P2 |

---

## 11. í–¥í›„ í™•ì¥

### 11.1 Phase 2 í™•ì¥ í•­ëª©

- **ìš´ë™ ë¹„ë””ì˜¤ ì½˜í…ì¸ **: ì „ë¬¸ íŠ¸ë ˆì´ë„ˆ ì´¬ì˜ ì˜ìƒ ì¶”ê°€
- **AI ROM ì¸¡ì •**: ì¹´ë©”ë¼ ê¸°ë°˜ ìë™ ê°€ë™ë²”ìœ„ ì¸¡ì •
- **ìŒì„± ê°€ì´ë“œ**: TTS ê¸°ë°˜ ìš´ë™ ì•ˆë‚´
- **ì†Œì…œ ê¸°ëŠ¥**: ìŠ¤íŠ¸ë ˆì¹­ ê¸°ë¡ ê³µìœ , ì±Œë¦°ì§€
- **ì¶”ê°€ ìŠ¤í¬ì¸ **: ìš”ê°€, í•„ë¼í…ŒìŠ¤, ì¶•êµ¬, ë†êµ¬

### 11.2 ëª¨ë“ˆ ì—°ë™ í™•ì¥

- **N-1 (ì˜ì–‘)**: ìœ ì—°ì„± í–¥ìƒ ì˜ì–‘ì†Œ ì¶”ì²œ (ë¹„íƒ€ë¯¼ D, ë§ˆê·¸ë„¤ìŠ˜)
- **S-1 (í”¼ë¶€)**: ìŠ¤íŠ¸ë ˆì¹­ í›„ í˜ˆì•¡ìˆœí™˜ ê°œì„  íš¨ê³¼ ì—°ê³„
- **Coach AI**: ì‹¤ì‹œê°„ ìì„¸ í”¼ë“œë°±, ê°œì¸í™” ì½”ì¹­

---

## 12. ìš´ë™ ì•ˆì „ ê°€ì´ë“œ

### 12.1 ê¸ˆê¸° ì‚¬í•­

| ìƒíƒœ | ê¶Œì¥ ì¡°ì¹˜ |
|------|----------|
| ê¸‰ì„± ë¶€ìƒ (72ì‹œê°„ ì´ë‚´) | ìŠ¤íŠ¸ë ˆì¹­ ê¸ˆì§€, ì˜ë£Œ ìƒë‹´ |
| ê´€ì ˆ ì—¼ì¦ | í•´ë‹¹ ë¶€ìœ„ ì œì™¸ |
| ì‹¬í˜ˆê´€ ì§ˆí™˜ | ê³ ê°•ë„ ìŠ¤íŠ¸ë ˆì¹­ ì œì™¸ |
| ì„ì‹  | ë³µë¶€/ê³¨ë°˜ ìŠ¤íŠ¸ë ˆì¹­ ì£¼ì˜ |
| ê³¨ë‹¤ê³µì¦ | ê³¼ë„í•œ êµ´ê³¡/íšŒì „ ì œì™¸ |
| ì²™ì¶” ë¶ˆì•ˆì •ì„± | ê²½ì¶”/ìš”ì¶” ìš´ë™ ì œì™¸, ì „ë¬¸ê°€ ìƒë‹´ |
| ë””ìŠ¤í¬ íƒˆì¶œ (ê¸‰ì„±) | ìš”ì¶” êµ´ê³¡ ìš´ë™ ì œì™¸ |
| ê³ í˜ˆì•• | ë¨¸ë¦¬ ì•„ë˜ë¡œ ê°€ëŠ” ìì„¸ ì œí•œ |
| í˜„ê¸°ì¦/ì–´ì§€ëŸ¬ì›€ | ì—­ìœ„ ìì„¸ ì œì™¸ |

### 12.2 ì£¼ì˜ ì‚¬í•­

- **í†µì¦ ë°œìƒ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨**: "ì•„í”„ë©´ ë©ˆì¶”ê¸°" ì›ì¹™
- **ë°˜ë™ ë™ì‘ ê¸ˆì§€**: ì •ì  ìŠ¤íŠ¸ë ˆì¹­ ì‹œ ë°˜ë™(bouncing) ì ˆëŒ€ ê¸ˆì§€
- **í˜¸í¡ ìœ ì§€**: ìˆ¨ ì°¸ì§€ ì•Šê¸° - ìì—°ìŠ¤ëŸ½ê²Œ í˜¸í¡í•˜ë©° ì§„í–‰
- **ì¤€ë¹„ ìš´ë™ í›„ ì‹¤ì‹œ ê¶Œì¥**: ê°€ë²¼ìš´ ìœ ì‚°ì†Œ 5ë¶„ í›„ ìŠ¤íŠ¸ë ˆì¹­
- **ì ì§„ì  ê°•ë„ ì¦ê°€**: ì²« ì£¼ëŠ” 50-70% ê°•ë„ë¡œ ì‹œì‘
- **ìˆ˜ë¶„ ì„­ì·¨**: ìš´ë™ ì „í›„ ì¶©ë¶„í•œ ìˆ˜ë¶„ ì„­ì·¨
- **ìš´ë™ í›„ ì •ì  ìŠ¤íŠ¸ë ˆì¹­**: ìš´ë™ ì „ì—ëŠ” ë™ì  ìŠ¤íŠ¸ë ˆì¹­ ê¶Œì¥

### 12.3 Red Flags (ì¦‰ì‹œ ì¤‘ë‹¨ ì‹ í˜¸)

> ë‹¤ìŒ ì¦ìƒ ë°œìƒ ì‹œ **ì¦‰ì‹œ ì¤‘ë‹¨**í•˜ê³  ì „ë¬¸ì˜ ìƒë‹´

| ì¦ìƒ ìœ í˜• | êµ¬ì²´ì  ì¦ìƒ |
|----------|------------|
| ì‹ ê²½í•™ì  | ë°©ì‚¬í†µ (íŒ”/ë‹¤ë¦¬ë¡œ í¼ì§€ëŠ” í†µì¦), ì €ë¦¼, ë¬´ê°ê°, ë”°ë”ê±°ë¦¼, ê°‘ì‘ìŠ¤ëŸ¬ìš´ ê·¼ë ¥ ì €í•˜ |
| ì‘ê¸‰ | ë°°ë³€/ë°°ë‡¨ ì¥ì•  (ë§ˆë¯¸ì¦í›„êµ°), ì•ˆì¥ ê°ê°ì´ìƒ (íšŒìŒë¶€ ê°ê° ìƒì‹¤) |
| ì‹¬í˜ˆê´€ | ì–´ì§€ëŸ¬ì›€, ì‹¤ì‹ , í‰í†µ + í˜¸í¡ê³¤ë€ |
| ê·¼ê³¨ê²© | "ëš" ì†Œë¦¬ì™€ í•¨ê»˜ ê¸‰ì„± í†µì¦, ê´€ì ˆ ì ê¹€ í˜„ìƒ |

### 12.4 íŠ¹ìˆ˜ ìƒí™©ë³„ ê°€ì´ë“œ

#### ì„ì‚°ë¶€

- 2ì‚¼ë¶„ê¸° ì´í›„ ì•™ì™€ìœ„(ëˆ„ìš´ ìì„¸) ê¸ˆì§€ â†’ ì¢Œì¸¡ ì¸¡ì™€ìœ„ë¡œ ë³€ê²½
- ë³µë¶€ ì••ë°• ìš´ë™ ì œì™¸
- ê³¼ì‹ ì „ ìš´ë™ ì œí•œ
- ê· í˜• ìš´ë™ ì‹œ ì§€ì§€ëŒ€ ì‚¬ìš©

#### ê³ ë ¹ì (65ì„¸ ì´ìƒ)

- ìœ ì§€ ì‹œê°„ 20% ê°ì†Œ (30ì´ˆ â†’ 24ì´ˆ)
- ì„¸íŠ¸ ìˆ˜ ê°ì†Œ (3ì„¸íŠ¸ â†’ 2ì„¸íŠ¸)
- íœ´ì‹ ì‹œê°„ ì¦ê°€ (30ì´ˆ â†’ 45ì´ˆ)
- ì˜ì ë˜ëŠ” ë²½ ì§€ì§€ í™œìš©

#### ì²­ì†Œë…„ (18ì„¸ ë¯¸ë§Œ)

- ê³¼ì‹ ì „ ìš´ë™ ì œí•œ
- ì„±ì¥íŒ ë¶€í•˜ ìš´ë™ ì£¼ì˜
- ê°ë… í•˜ì— ìˆ˜í–‰ ê¶Œì¥

### 12.5 ë©´ì±… ì¡°í•­

> **ì˜ë£Œ ë©´ì±… ì¡°í•­**
>
> ë³¸ ìŠ¤íŠ¸ë ˆì¹­ ì¶”ì²œì€ ì¼ë°˜ì ì¸ ìš´ë™ ê°€ì´ë“œì´ë©°, ê°œì¸ì˜ ê±´ê°• ìƒíƒœì— ë”°ë¼ ì í•©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ê¸°ì¡´ ì§ˆí™˜ì´ ìˆëŠ” ê²½ìš° ë°˜ë“œì‹œ ì „ë¬¸ì˜ ìƒë‹´ í›„ ì‹¤ì‹œí•˜ì„¸ìš”.
>
> - ì´ í”„ë¡œê·¸ë¨ì€ ì˜ë£Œ ì§„ë‹¨ì´ë‚˜ ë¬¼ë¦¬ì¹˜ë£Œë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
> - AI ê¸°ë°˜ ìì„¸ ë¶„ì„ì€ ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì§„ë‹¨ì€ ì „ë¬¸ê°€ì—ê²Œ ë°›ìœ¼ì„¸ìš”.
> - ì‹¬ê°í•œ ìì„¸ ë¶ˆê· í˜•(CVA < 40Â° ë“±)ì€ ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
> - í†µì¦ì´ ë°œìƒí•˜ë©´ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³ , ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.

---

## 13. êµ¬í˜„ íŒŒì¼ ê²½ë¡œ

### 13.1 ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
lib/stretching/
â”œâ”€â”€ index.ts                     # ê³µê°œ API (Barrel Export)
â”œâ”€â”€ types.ts                     # íƒ€ì… ì •ì˜ (W2-001)
â”‚
â”œâ”€â”€ prescription/
â”‚   â”œâ”€â”€ posture-prescription.ts  # W2-006: ìì„¸ ê¸°ë°˜ ì²˜ë°© ë¡œì§
â”‚   â””â”€â”€ sports-prescription.ts   # W2-007: ìŠ¤í¬ì¸  ê¸°ë°˜ ì²˜ë°© ë¡œì§
â”‚
â”œâ”€â”€ planning/
â”‚   â””â”€â”€ weekly-planner.ts        # W2-010: ì£¼ê°„ í”Œëœ ìƒì„±
â”‚
â”œâ”€â”€ protocols/
â”‚   â”œâ”€â”€ posture-protocols.ts     # W2-004: ìì„¸ í”„ë¡œí† ì½œ ë°ì´í„°
â”‚   â”œâ”€â”€ sports-protocols.ts      # W2-005: ìŠ¤í¬ì¸  í”„ë¡œí† ì½œ ë°ì´í„°
â”‚   â””â”€â”€ pnf-protocol.ts          # W2-011: PNF í”„ë¡œí† ì½œ
â”‚
â”œâ”€â”€ adjustments/
â”‚   â””â”€â”€ age-adjustment.ts        # W2-009: ì—°ë ¹ë³„ ì¡°ì • ë¡œì§
â”‚
â”œâ”€â”€ safety/
â”‚   â”œâ”€â”€ contraindication-filter.ts  # W2-008: ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§
â”‚   â”œâ”€â”€ contraindication-map.ts     # ê¸ˆê¸°ì‚¬í•­ ë§¤í•‘ ë°ì´í„°
â”‚   â”œâ”€â”€ safety-check.ts             # W2-012: ì•ˆì „ ì²´í¬ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ disclaimers.ts              # ì˜ë£Œ ë©´ì±…ì¡°í•­
â”‚
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ muscle-groups.ts         # ê·¼ìœ¡êµ° ì •ì˜ (ìƒìˆ˜)
â”‚   â”œâ”€â”€ stretch-db.ts            # ìŠ¤íŠ¸ë ˆì¹­ DB ì¡°íšŒ ìœ í‹¸
â”‚   â””â”€â”€ difficulty-scale.ts      # ë‚œì´ë„ ì¡°ì • ë¡œì§
â”‚
â””â”€â”€ __tests__/
    â”œâ”€â”€ posture-prescription.test.ts
    â”œâ”€â”€ sports-prescription.test.ts
    â”œâ”€â”€ contraindication-filter.test.ts
    â”œâ”€â”€ weekly-planner.test.ts
    â”œâ”€â”€ age-adjustment.test.ts
    â”œâ”€â”€ pnf-protocol.test.ts
    â””â”€â”€ safety-check.test.ts
```

### 13.2 API ë¼ìš°íŠ¸ êµ¬ì¡°

```
app/api/v2/stretching/
â”œâ”€â”€ prescribe/
â”‚   â”œâ”€â”€ posture/
â”‚   â”‚   â””â”€â”€ route.ts             # W2-013: POST /api/v2/stretching/prescribe/posture
â”‚   â””â”€â”€ sport/
â”‚       â””â”€â”€ route.ts             # W2-014: POST /api/v2/stretching/prescribe/sport
â”‚
â”œâ”€â”€ plan/
â”‚   â””â”€â”€ weekly/
â”‚       â””â”€â”€ route.ts             # W2-015: GET/POST /api/v2/stretching/plan/weekly
â”‚
â”œâ”€â”€ session/
â”‚   â”œâ”€â”€ route.ts                 # W2-016: POST /api/v2/stretching/session
â”‚   â”œâ”€â”€ [id]/
â”‚   â”‚   â””â”€â”€ route.ts             # W2-016: PATCH /api/v2/stretching/session/[id]
â”‚   â””â”€â”€ history/
â”‚       â””â”€â”€ route.ts             # W2-016: GET /api/v2/stretching/session/history
â”‚
â””â”€â”€ profile/
    â””â”€â”€ route.ts                 # W2-017: GET/PUT /api/v2/stretching/profile
```

### 13.3 UI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
components/stretching/
â”œâ”€â”€ index.ts                     # ê³µê°œ ì»´í¬ë„ŒíŠ¸ export
â”‚
â”œâ”€â”€ ExerciseCard.tsx             # W2-020: ìš´ë™ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ SessionPlayer.tsx            # W2-021: ì„¸ì…˜ í”Œë ˆì´ì–´
â”œâ”€â”€ Timer.tsx                    # W2-022: íƒ€ì´ë¨¸ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ BreathingGuide.tsx           # W2-023: í˜¸í¡ ê°€ì´ë“œ
â”œâ”€â”€ SafetyWarning.tsx            # W2-024: ì•ˆì „ ê²½ê³  ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ WeeklyPlanView.tsx           # W2-025: ì£¼ê°„ í”Œëœ ë·°
â”œâ”€â”€ ProgressTracker.tsx          # W2-026: ì§„í–‰ ì¶”ì  ë·°
â”œâ”€â”€ SportSelector.tsx            # W2-019: ìŠ¤í¬ì¸  ì„ íƒ UI
â”œâ”€â”€ StretchingList.tsx           # W2-027: ìŠ¤íŠ¸ë ˆì¹­ ëª©ë¡ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ PostureRoutineCard.tsx       # W2-028: ìì„¸êµì • ë£¨í‹´ ì¹´ë“œ
â”œâ”€â”€ PNFGuide.tsx                 # W2-029: PNF ê¸°ë²• ì•ˆë‚´
â””â”€â”€ MedicalDisclaimer.tsx        # W2-030: ì˜ë£Œ ë©´ì±… ì‹œìŠ¤í…œ
```

### 13.4 í˜ì´ì§€ êµ¬ì¡°

```
app/(main)/stretching/
â”œâ”€â”€ page.tsx                     # W2-018: ìŠ¤íŠ¸ë ˆì¹­ í™ˆ í˜ì´ì§€
â”œâ”€â”€ posture/
â”‚   â””â”€â”€ page.tsx                 # ìì„¸êµì • ìŠ¤íŠ¸ë ˆì¹­
â”œâ”€â”€ sport/
â”‚   â””â”€â”€ page.tsx                 # ìŠ¤í¬ì¸  ìŠ¤íŠ¸ë ˆì¹­
â”œâ”€â”€ session/
â”‚   â””â”€â”€ [id]/
â”‚       â””â”€â”€ page.tsx             # ì„¸ì…˜ ì‹¤í–‰ í˜ì´ì§€
â””â”€â”€ history/
    â””â”€â”€ page.tsx                 # ê¸°ë¡ í˜ì´ì§€
```

### 13.5 DB ë§ˆì´ê·¸ë ˆì´ì…˜

```
supabase/migrations/
â”œâ”€â”€ 20260121_stretching_exercises.sql      # W2-002: ìš´ë™ í…Œì´ë¸”
â”œâ”€â”€ 20260121_stretching_prescriptions.sql  # W2-002: ì²˜ë°© í…Œì´ë¸”
â”œâ”€â”€ 20260121_stretching_sessions.sql       # W2-002: ì„¸ì…˜ í…Œì´ë¸”
â”œâ”€â”€ 20260121_stretching_user_profiles.sql  # W2-002: í”„ë¡œí•„ í…Œì´ë¸”
â””â”€â”€ 20260121_stretching_seed.sql           # W2-003: ì‹œë“œ ë°ì´í„°
```

---

## 14. ì°¸ê³  ìë£Œ

### ê°€ì´ë“œë¼ì¸

- ACSM Guidelines for Exercise Testing and Prescription (11th ed.)
- NSCA Essentials of Strength Training and Conditioning (4th ed.)
- NASM Corrective Exercise Specialist Guidelines

### í•™ìˆ  ìë£Œ

- Janda, V. (1983). "Muscle Function Testing"
- Myers, T. (2020). "Anatomy Trains" (4th ed.)
- Behm, D.G. et al. (2016). "Acute effects of muscle stretching"
- Kay, A.D. & Blazevich, A.J. (2012). "Effect of acute static stretch"
- Sharman, M.J. et al. (2006). "PNF Stretching: Mechanisms"

### ê´€ë ¨ ë¬¸ì„œ

- [exercise-physiology.md](../principles/exercise-physiology.md)
- [body-mechanics.md](../principles/body-mechanics.md)
- [ADR-047: W-2 ê³ ê¸‰ ìŠ¤íŠ¸ë ˆì¹­](../adr/ADR-047-w2-advanced-stretching.md) - **í•µì‹¬ ADR**: ìŠ¤íŠ¸ë ˆì¹­ ì•„í‚¤í…ì²˜
- [ADR-031: ìš´ë™ ëª¨ë“ˆ ì•„í‚¤í…ì²˜](../adr/ADR-031-workout-module.md)
- [SDD-BODY-ANALYSIS](./SDD-BODY-ANALYSIS.md)

---

**Version**: 1.5 | **Created**: 2026-01-21 | **Updated**: 2026-01-24 | **Author**: Claude Code

### ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| 1.0 | 2026-01-21 | ì´ˆê¸° ë²„ì „ - 30ê°œ P3 ì›ì, 57.5ì‹œê°„ |
| 1.1 | 2026-01-23 | P3 í•µì‹¬ ì›ì 5ê°œ ìƒì„¸ ì •ì˜ ì¶”ê°€ (W2-006,007,008,010,013) - ì…ì¶œë ¥ ìŠ¤í™, ì„±ê³µ ê¸°ì¤€, ì•Œê³ ë¦¬ì¦˜ ê°œìš” |
| 1.2 | 2026-01-23 | Section 8 Mock ë°ì´í„° ì¶”ê°€ (ì…ë ¥/ì¶œë ¥ Mock, ê²½ê³„ê°’, Fallback), Section 9 í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ í‘œ ì¶”ê°€ (24 ë‹¨ìœ„ + 10 í†µí•© + 12 ì—ëŸ¬) |
| 1.3 | 2026-01-23 | Section 7.5 ë¹„í•µì‹¬ ì›ì 12ê°œ ì„±ê³µ ê¸°ì¤€ ì¶”ê°€ (W2-001~005, W2-009, W2-011~012, W2-014~017), Section 11 ìš´ë™ ì•ˆì „ ê°€ì´ë“œ ì¶”ê°€ (ê¸ˆê¸°ì‚¬í•­, Red Flags, ë©´ì±…ì¡°í•­), Section 12 êµ¬í˜„ íŒŒì¼ ê²½ë¡œ ëª…ì‹œ |
| 1.4 | 2026-01-23 | **100% ì™„ì„±**: Section 2.6 C-2 Janda Cross Syndrome í†µí•©, Section 2.7 ìŠ¤í¬ì¸ ë³„ ìŠ¤íŠ¸ë ˆì¹­ ë§¤í•‘, Section 7 P3 ì›ì ë¶„í•´ (12ê°œ, 19h), Section 8 Mock ë°ì´í„° (UCS/LCS, 5 ìŠ¤í¬ì¸ , 20ê°œ ìš´ë™), Section 9 ì¸í„°í˜ì´ìŠ¤ ì •ì˜ (TypeScript), Section 10 í…ŒìŠ¤íŠ¸ ì „ëµ (W-2.1~W-2.12 ì»¤ë²„ë¦¬ì§€), Section 11-13 ë¬¸ì„œ êµ¬ì¡° ì •ë¦¬ |
| 1.5 | 2026-01-24 | **C-2 ì²´í˜•ë¶„ì„ ì—°ë™ ë³´ì™„**: Section 2.7 ì²´í˜•ë³„ ìŠ¤íŠ¸ë ˆì¹­ ì¶”ì²œ ë§¤í•‘ ì¶”ê°€ (SHR ê¸°ë°˜ ì—­ì‚¼ê°í˜•/ê· í˜•/ì‚¼ê°í˜• ì²´í˜•ë³„ í”„ë¡œí† ì½œ), Section 2.7.4 ì²´í˜•-ìì„¸ ë³µí•© ë¶„ì„ í†µí•© ë¡œì§ ì¶”ê°€, ê¸°ì¡´ ìŠ¤í¬ì¸ ë³„ ë§¤í•‘ì€ Section 2.8ë¡œ ì´ë™ |

```typescript
// tests/lib/stretching/posture-prescription.test.ts

import { describe, it, expect } from 'vitest';
import {
  prescribePostureStretching,
  POSTURE_PROTOCOLS,
} from '@/lib/stretching/posture-prescription';
import {
  mockPostureAnalysisStandard,
  mockPostureAnalysisSevere,
  mockUserProfileStandard,
  mockUserProfileSeniorWithConditions,
} from './factories/stretching-mocks';

describe('prescribePostureStretching', () => {
  // W2-U01: ìƒë¶€êµì°¨ì¦í›„êµ° ì²˜ë°©
  it('should prescribe stretches for upper cross syndrome', () => {
    const prescription = prescribePostureStretching(
      mockPostureAnalysisStandard,
      mockUserProfileStandard
    );

    expect(prescription.stretches.length).toBeGreaterThan(0);

    // ëŒ€í‰ê·¼ ìŠ¤íŠ¸ë ˆì¹­ í¬í•¨ í™•ì¸
    const hasChestStretch = prescription.stretches.some(s =>
      s.exercise.targetMuscles.includes('pectoralis_major')
    );
    expect(hasChestStretch).toBe(true);
  });

  // W2-U06: ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§
  it('should filter exercises with contraindications', () => {
    const prescription = prescribePostureStretching(
      mockPostureAnalysisStandard,
      mockUserProfileSeniorWithConditions
    );

    // ë””ìŠ¤í¬ íƒˆì¶œ ê¸ˆê¸° ìš´ë™ ì œì™¸ í™•ì¸
    const hasContraindicatedExercise = prescription.stretches.some(s =>
      s.exercise.contraindications.includes('disc_herniation')
    );
    expect(hasContraindicatedExercise).toBe(false);
  });

  // W2-U07: ê³ ë ¹ì ì‹œê°„ ì¡°ì •
  it('should adjust duration for seniors', () => {
    const prescription = prescribePostureStretching(
      mockPostureAnalysisStandard,
      mockUserProfileSeniorWithConditions
    );

    // 30-60ì´ˆ ë²”ìœ„ í™•ì¸
    const staticStretches = prescription.stretches.filter(
      s => s.exercise.durationUnit === 'seconds'
    );
    for (const stretch of staticStretches) {
      expect(stretch.adjustedDuration).toBeGreaterThanOrEqual(30);
      expect(stretch.adjustedDuration).toBeLessThanOrEqual(60);
    }
  });

  // W2-U05: ì‹¬ê°í•œ ë¶ˆê· í˜• - ì „ë¬¸ê°€ ìƒë‹´ ê¶Œê³ 
  it('should add warning for severe imbalance', () => {
    const prescription = prescribePostureStretching(
      mockPostureAnalysisSevere,
      mockUserProfileStandard
    );

    expect(prescription.warnings.some(w => w.includes('ë¬¼ë¦¬ì¹˜ë£Œì‚¬'))).toBe(true);
    expect(prescription.professionalReferral).toBe(true);
  });

  // W2-U24: ì˜ë£Œ ë©´ì±…ì¡°í•­ í¬í•¨ í™•ì¸
  it('should include medical disclaimer', () => {
    const prescription = prescribePostureStretching(
      mockPostureAnalysisStandard,
      mockUserProfileStandard
    );

    expect(prescription.medicalDisclaimer).toBeDefined();
    expect(prescription.medicalDisclaimer.length).toBeGreaterThan(0);
  });
});

describe('POSTURE_PROTOCOLS', () => {
  it('should have stretches for all imbalance types', () => {
    const imbalanceTypes = [
      'upper_cross', 'lower_cross', 'forward_head',
      'rounded_shoulder', 'pelvic_tilt_ant', 'pelvic_tilt_post',
      'sway_back', 'flat_back',
    ];

    for (const type of imbalanceTypes) {
      expect(POSTURE_PROTOCOLS[type]).toBeDefined();
      expect(POSTURE_PROTOCOLS[type].stretches.length).toBeGreaterThan(0);
    }
  });
});
```

### 9.3 API í…ŒìŠ¤íŠ¸ êµ¬í˜„ ì˜ˆì‹œ

```typescript
// tests/api/stretching/prescribe-posture.test.ts

import { describe, it, expect, vi } from 'vitest';
import { POST } from '@/app/api/v2/stretching/prescribe/posture/route';
import { createMockRequest } from '../../utils/mock-request';

vi.mock('@clerk/nextjs/server', () => ({
  auth: () => Promise.resolve({ userId: 'user_123' }),
}));

vi.mock('@/lib/supabase/server', () => ({
  createClerkSupabaseClientSsr: () => ({
    from: vi.fn().mockReturnThis(),
    select: vi.fn().mockReturnThis(),
    eq: vi.fn().mockReturnThis(),
    single: vi.fn().mockResolvedValue({
      data: {
        id: 'assessment_123',
        angles: { cva: 42, thoracicKyphosis: 45 },
        imbalances: [{ type: 'upper_cross', severity: 'moderate' }],
      },
      error: null,
    }),
    insert: vi.fn().mockReturnThis(),
  }),
}));

describe('POST /api/v2/stretching/prescribe/posture', () => {
  // W2-I01: ìì„¸ ì²˜ë°© API ì„±ê³µ
  it('should return prescription for valid assessment', async () => {
    const request = createMockRequest({
      method: 'POST',
      body: { postureAssessmentId: 'assessment_123' },
    });

    const response = await POST(request);
    const data = await response.json();

    expect(response.status).toBe(200);
    expect(data.success).toBe(true);
    expect(data.data.stretches).toBeDefined();
    expect(data.data.stretches.length).toBeGreaterThan(0);
  });

  // W2-E01: ì¸ì¦ ì—†ìŒ
  it('should return 401 for unauthenticated request', async () => {
    vi.mocked(auth).mockResolvedValueOnce({ userId: null });

    const request = createMockRequest({
      method: 'POST',
      body: { postureAssessmentId: 'assessment_123' },
    });

    const response = await POST(request);
    expect(response.status).toBe(401);
  });

  // W2-E03: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” assessment
  it('should return 404 for non-existent assessment', async () => {
    vi.mocked(createClerkSupabaseClientSsr).mockReturnValueOnce({
      from: vi.fn().mockReturnThis(),
      select: vi.fn().mockReturnThis(),
      eq: vi.fn().mockReturnThis(),
      single: vi.fn().mockResolvedValue({ data: null, error: { code: 'PGRST116' } }),
    });

    const request = createMockRequest({
      method: 'POST',
      body: { postureAssessmentId: 'nonexistent' },
    });

    const response = await POST(request);
    expect(response.status).toBe(404);
  });

  // W2-E07: Rate Limit ì´ˆê³¼
  it('should return 429 when rate limit exceeded', async () => {
    // Rate limit mock
    vi.mocked(checkRateLimit).mockResolvedValueOnce({ success: false });

    const request = createMockRequest({
      method: 'POST',
      body: { postureAssessmentId: 'assessment_123' },
    });

    const response = await POST(request);
    expect(response.status).toBe(429);
  });
});
```

#### ê³ ë ¹ì (65ì„¸ ì´ìƒ)

- ìœ ì§€ ì‹œê°„ 20% ê°ì†Œ (30ì´ˆ â†’ 24ì´ˆ)
- ì„¸íŠ¸ ìˆ˜ ê°ì†Œ (3ì„¸íŠ¸ â†’ 2ì„¸íŠ¸)
- íœ´ì‹ ì‹œê°„ ì¦ê°€ (30ì´ˆ â†’ 45ì´ˆ)
- ì˜ì ë˜ëŠ” ë²½ ì§€ì§€ í™œìš©

#### ì²­ì†Œë…„ (18ì„¸ ë¯¸ë§Œ)

- ê³¼ì‹ ì „ ìš´ë™ ì œí•œ
- ì„±ì¥íŒ ë¶€í•˜ ìš´ë™ ì£¼ì˜
- ê°ë… í•˜ì— ìˆ˜í–‰ ê¶Œì¥

### 11.5 ë©´ì±… ì¡°í•­

> **ì˜ë£Œ ë©´ì±… ì¡°í•­**
>
> ë³¸ ìŠ¤íŠ¸ë ˆì¹­ ì¶”ì²œì€ ì¼ë°˜ì ì¸ ìš´ë™ ê°€ì´ë“œì´ë©°, ê°œì¸ì˜ ê±´ê°• ìƒíƒœì— ë”°ë¼ ì í•©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ê¸°ì¡´ ì§ˆí™˜ì´ ìˆëŠ” ê²½ìš° ë°˜ë“œì‹œ ì „ë¬¸ì˜ ìƒë‹´ í›„ ì‹¤ì‹œí•˜ì„¸ìš”.
>
> - ì´ í”„ë¡œê·¸ë¨ì€ ì˜ë£Œ ì§„ë‹¨ì´ë‚˜ ë¬¼ë¦¬ì¹˜ë£Œë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
> - AI ê¸°ë°˜ ìì„¸ ë¶„ì„ì€ ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì§„ë‹¨ì€ ì „ë¬¸ê°€ì—ê²Œ ë°›ìœ¼ì„¸ìš”.
> - ì‹¬ê°í•œ ìì„¸ ë¶ˆê· í˜•(CVA < 40Â° ë“±)ì€ ë¬¼ë¦¬ì¹˜ë£Œì‚¬ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
> - í†µì¦ì´ ë°œìƒí•˜ë©´ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³ , ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.

---

## 12. êµ¬í˜„ íŒŒì¼ ê²½ë¡œ

### 12.1 ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
lib/stretching/
â”œâ”€â”€ index.ts                     # ê³µê°œ API (Barrel Export)
â”œâ”€â”€ types.ts                     # íƒ€ì… ì •ì˜ (W2-001)
â”‚
â”œâ”€â”€ prescription/
â”‚   â”œâ”€â”€ posture-prescription.ts  # W2-006: ìì„¸ ê¸°ë°˜ ì²˜ë°© ë¡œì§
â”‚   â””â”€â”€ sports-prescription.ts   # W2-007: ìŠ¤í¬ì¸  ê¸°ë°˜ ì²˜ë°© ë¡œì§
â”‚
â”œâ”€â”€ planning/
â”‚   â””â”€â”€ weekly-planner.ts        # W2-010: ì£¼ê°„ í”Œëœ ìƒì„±
â”‚
â”œâ”€â”€ protocols/
â”‚   â”œâ”€â”€ posture-protocols.ts     # W2-004: ìì„¸ í”„ë¡œí† ì½œ ë°ì´í„°
â”‚   â”œâ”€â”€ sports-protocols.ts      # W2-005: ìŠ¤í¬ì¸  í”„ë¡œí† ì½œ ë°ì´í„°
â”‚   â””â”€â”€ pnf-protocol.ts          # W2-011: PNF í”„ë¡œí† ì½œ
â”‚
â”œâ”€â”€ adjustments/
â”‚   â””â”€â”€ age-adjustment.ts        # W2-009: ì—°ë ¹ë³„ ì¡°ì • ë¡œì§
â”‚
â”œâ”€â”€ safety/
â”‚   â”œâ”€â”€ contraindication-filter.ts  # W2-008: ê¸ˆê¸°ì‚¬í•­ í•„í„°ë§
â”‚   â”œâ”€â”€ contraindication-map.ts     # ê¸ˆê¸°ì‚¬í•­ ë§¤í•‘ ë°ì´í„°
â”‚   â”œâ”€â”€ safety-check.ts             # W2-012: ì•ˆì „ ì²´í¬ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ disclaimers.ts              # ì˜ë£Œ ë©´ì±…ì¡°í•­
â”‚
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ muscle-groups.ts         # ê·¼ìœ¡êµ° ì •ì˜ (ìƒìˆ˜)
â”‚   â”œâ”€â”€ stretch-db.ts            # ìŠ¤íŠ¸ë ˆì¹­ DB ì¡°íšŒ ìœ í‹¸
â”‚   â””â”€â”€ difficulty-scale.ts      # ë‚œì´ë„ ì¡°ì • ë¡œì§
â”‚
â””â”€â”€ __tests__/
    â”œâ”€â”€ posture-prescription.test.ts
    â”œâ”€â”€ sports-prescription.test.ts
    â”œâ”€â”€ contraindication-filter.test.ts
    â”œâ”€â”€ weekly-planner.test.ts
    â”œâ”€â”€ age-adjustment.test.ts
    â”œâ”€â”€ pnf-protocol.test.ts
    â””â”€â”€ safety-check.test.ts
```

### 12.2 API ë¼ìš°íŠ¸ êµ¬ì¡°

```
app/api/v2/stretching/
â”œâ”€â”€ prescribe/
â”‚   â”œâ”€â”€ posture/
â”‚   â”‚   â””â”€â”€ route.ts             # W2-013: POST /api/v2/stretching/prescribe/posture
â”‚   â””â”€â”€ sport/
â”‚       â””â”€â”€ route.ts             # W2-014: POST /api/v2/stretching/prescribe/sport
â”‚
â”œâ”€â”€ plan/
â”‚   â””â”€â”€ weekly/
â”‚       â””â”€â”€ route.ts             # W2-015: GET/POST /api/v2/stretching/plan/weekly
â”‚
â”œâ”€â”€ session/
â”‚   â”œâ”€â”€ route.ts                 # W2-016: POST /api/v2/stretching/session
â”‚   â”œâ”€â”€ [id]/
â”‚   â”‚   â””â”€â”€ route.ts             # W2-016: PATCH /api/v2/stretching/session/[id]
â”‚   â””â”€â”€ history/
â”‚       â””â”€â”€ route.ts             # W2-016: GET /api/v2/stretching/session/history
â”‚
â””â”€â”€ profile/
    â””â”€â”€ route.ts                 # W2-017: GET/PUT /api/v2/stretching/profile
```

### 12.3 UI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
components/stretching/
â”œâ”€â”€ index.ts                     # ê³µê°œ ì»´í¬ë„ŒíŠ¸ export
â”‚
â”œâ”€â”€ ExerciseCard.tsx             # W2-020: ìš´ë™ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ SessionPlayer.tsx            # W2-021: ì„¸ì…˜ í”Œë ˆì´ì–´
â”œâ”€â”€ Timer.tsx                    # W2-022: íƒ€ì´ë¨¸ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ BreathingGuide.tsx           # W2-023: í˜¸í¡ ê°€ì´ë“œ
â”œâ”€â”€ SafetyWarning.tsx            # W2-024: ì•ˆì „ ê²½ê³  ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ WeeklyPlanView.tsx           # W2-025: ì£¼ê°„ í”Œëœ ë·°
â”œâ”€â”€ ProgressTracker.tsx          # W2-026: ì§„í–‰ ì¶”ì  ë·°
â”œâ”€â”€ SportSelector.tsx            # W2-019: ìŠ¤í¬ì¸  ì„ íƒ UI
â””â”€â”€ MedicalDisclaimer.tsx        # W2-030: ì˜ë£Œ ë©´ì±… ì‹œìŠ¤í…œ
```

### 12.4 í˜ì´ì§€ êµ¬ì¡°

```
app/(main)/stretching/
â”œâ”€â”€ page.tsx                     # W2-018: ìŠ¤íŠ¸ë ˆì¹­ í™ˆ í˜ì´ì§€
â”œâ”€â”€ posture/
â”‚   â””â”€â”€ page.tsx                 # ìì„¸êµì • ìŠ¤íŠ¸ë ˆì¹­
â”œâ”€â”€ sport/
â”‚   â””â”€â”€ page.tsx                 # ìŠ¤í¬ì¸  ìŠ¤íŠ¸ë ˆì¹­
â”œâ”€â”€ session/
â”‚   â””â”€â”€ [id]/
â”‚       â””â”€â”€ page.tsx             # ì„¸ì…˜ ì‹¤í–‰ í˜ì´ì§€
â””â”€â”€ history/
    â””â”€â”€ page.tsx                 # ê¸°ë¡ í˜ì´ì§€
```

### 12.5 DB ë§ˆì´ê·¸ë ˆì´ì…˜

```
supabase/migrations/
â”œâ”€â”€ 20260121_stretching_exercises.sql      # W2-002: ìš´ë™ í…Œì´ë¸”
â”œâ”€â”€ 20260121_stretching_prescriptions.sql  # W2-002: ì²˜ë°© í…Œì´ë¸”
â”œâ”€â”€ 20260121_stretching_sessions.sql       # W2-002: ì„¸ì…˜ í…Œì´ë¸”
â”œâ”€â”€ 20260121_stretching_user_profiles.sql  # W2-002: í”„ë¡œí•„ í…Œì´ë¸”
â””â”€â”€ 20260121_stretching_seed.sql           # W2-003: ì‹œë“œ ë°ì´í„°
```

---

## 13. ì°¸ê³  ìë£Œ

### ê°€ì´ë“œë¼ì¸

- ACSM Guidelines for Exercise Testing and Prescription (11th ed.)
- NSCA Essentials of Strength Training and Conditioning (4th ed.)
- NASM Corrective Exercise Specialist Guidelines

### í•™ìˆ  ìë£Œ

- Janda, V. (1983). "Muscle Function Testing"
- Myers, T. (2020). "Anatomy Trains" (4th ed.)
- Behm, D.G. et al. (2016). "Acute effects of muscle stretching"
- Kay, A.D. & Blazevich, A.J. (2012). "Effect of acute static stretch"
- Sharman, M.J. et al. (2006). "PNF Stretching: Mechanisms"

### ê´€ë ¨ ë¬¸ì„œ

- [exercise-physiology.md](../principles/exercise-physiology.md)
- [body-mechanics.md](../principles/body-mechanics.md)
- [ADR-047: W-2 ê³ ê¸‰ ìŠ¤íŠ¸ë ˆì¹­](../adr/ADR-047-w2-advanced-stretching.md) - **í•µì‹¬ ADR**: ìŠ¤íŠ¸ë ˆì¹­ ì•„í‚¤í…ì²˜
- [ADR-031: ìš´ë™ ëª¨ë“ˆ ì•„í‚¤í…ì²˜](../adr/ADR-031-workout-module.md)
- [SDD-BODY-ANALYSIS](./SDD-BODY-ANALYSIS.md)

---

**Version**: 1.4 | **Created**: 2026-01-21 | **Updated**: 2026-01-24 | **Author**: Claude Code

### ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| 1.0 | 2026-01-21 | ì´ˆê¸° ë²„ì „ - 30ê°œ P3 ì›ì, 57.5ì‹œê°„ |
| 1.1 | 2026-01-23 | P3 í•µì‹¬ ì›ì 5ê°œ ìƒì„¸ ì •ì˜ ì¶”ê°€ (W2-006,007,008,010,013) - ì…ì¶œë ¥ ìŠ¤í™, ì„±ê³µ ê¸°ì¤€, ì•Œê³ ë¦¬ì¦˜ ê°œìš” |
| 1.2 | 2026-01-23 | Section 8 Mock ë°ì´í„° ì¶”ê°€ (ì…ë ¥/ì¶œë ¥ Mock, ê²½ê³„ê°’, Fallback), Section 9 í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ í‘œ ì¶”ê°€ (24 ë‹¨ìœ„ + 10 í†µí•© + 12 ì—ëŸ¬) |
| 1.3 | 2026-01-23 | Section 7.5 ë¹„í•µì‹¬ ì›ì 12ê°œ ì„±ê³µ ê¸°ì¤€ ì¶”ê°€ (W2-001~005, W2-009, W2-011~012, W2-014~017), Section 11 ìš´ë™ ì•ˆì „ ê°€ì´ë“œ ì¶”ê°€ (ê¸ˆê¸°ì‚¬í•­, Red Flags, ë©´ì±…ì¡°í•­), Section 12 êµ¬í˜„ íŒŒì¼ ê²½ë¡œ ëª…ì‹œ |
| 1.4 | 2026-01-24 | **êµ¬í˜„ ì¼ì • ì„¹ì…˜ ì¶”ê°€ (14ì ˆ)** - 2026 Q3, P1 ìš°ì„ ìˆœìœ„, C-2 ì˜ì¡´ì„± ëª…ì‹œ |

---

## 14. êµ¬í˜„ ì¼ì • (Implementation Schedule)

### 14.1 ì¼ì • ê°œìš”

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ì˜ˆìƒ ë¶„ê¸°** | 2026 Q3 |
| **ìš°ì„ ìˆœìœ„** | P1 (ìš´ë™ ê³ ë„í™”) |
| **ì˜ˆìƒ ê¸°ê°„** | 6-8ì£¼ |

### 14.2 ì„ í–‰ ì¡°ê±´ (Prerequisites)

| ì„ í–‰ ëª¨ë“ˆ | ìƒíƒœ | ì˜ì¡´ì„± ì„¤ëª… |
|----------|------|------------|
| **C-2** (ì²´í˜•ë¶„ì„ v2) | Draft | ìì„¸ ë¶ˆê· í˜• ë°ì´í„° (`postureType`, `imbalance`) |
| **W-1** (ìš´ë™ ëª¨ë“ˆ) | âœ… Stable | ìš´ë™ DB êµ¬ì¡°, ì„¸ì…˜ ê´€ë¦¬ |

### 14.3 ë§ˆì¼ìŠ¤í†¤

| Phase | ê¸°ê°„ | ì£¼ìš” ì‘ì—… | ì‚°ì¶œë¬¼ |
|-------|------|----------|--------|
| **Phase 1** | 1ì£¼ | ìŠ¤íŠ¸ë ˆì¹­ DB ì„¤ê³„, 60ê°œ ìš´ë™ ì‹œë“œ | ë§ˆì´ê·¸ë ˆì´ì…˜, ì‹œë“œ ë°ì´í„° |
| **Phase 2** | 2ì£¼ | ìì„¸êµì • ì²˜ë°© ì—”ì§„ (Janda 5ìœ í˜•) | `lib/stretching/prescription-engine.ts` |
| **Phase 3** | 2ì£¼ | ìŠ¤í¬ì¸ ë³„ í”„ë¡œí† ì½œ (6ê°œ ìŠ¤í¬ì¸ ) | `lib/stretching/sport-protocol.ts` |
| **Phase 4** | 1ì£¼ | ì„¸ì…˜ ì‹¤í–‰ UI, íƒ€ì´ë¨¸, ì• ë‹ˆë©”ì´ì…˜ | ì»´í¬ë„ŒíŠ¸ |
| **Phase 5** | 1ì£¼ | ì§„í–‰ ì¶”ì , ê°œì¸í™” ì ì‘ | `lib/stretching/progress-tracker.ts` |
| **Buffer** | 1ì£¼ | QA, í…ŒìŠ¤íŠ¸, ì½˜í…ì¸  ê²€ìˆ˜ | - |

### 14.4 í›„í–‰ ëª¨ë“ˆ (Downstream)

| ëª¨ë“ˆ | ì‚¬ìš© í•„ë“œ | ì˜í–¥ |
|------|----------|------|
| **ëŒ€ì‹œë³´ë“œ** | `sessions`, `progress` | ìš´ë™ ê¸°ë¡ í†µí•© í‘œì‹œ |
| **ì›”ê°„ ë¦¬í¬íŠ¸** | `completionRate` | ìŠ¤íŠ¸ë ˆì¹­ ìŠµê´€ ë¶„ì„ |
| **ì½”ì¹˜ AI** | `prescription` | ë§ì¶¤ ìŠ¤íŠ¸ë ˆì¹­ ì¶”ì²œ ëŒ€í™” |

### 14.5 ìœ„í—˜ ìš”ì†Œ

| ìœ„í—˜ | ì˜í–¥ë„ | ëŒ€ì‘ |
|------|--------|------|
| C-2 ì§€ì—° ì‹œ | ë†’ìŒ | ì¼ë°˜ ìŠ¤íŠ¸ë ˆì¹­ ìš°ì„  ì¶œì‹œ, ìì„¸êµì •ì€ í›„ì† |
| ìš´ë™ ì½˜í…ì¸  ì œì‘ | ì¤‘ê°„ | í•µì‹¬ 30ê°œ ìš°ì„ , ë‚˜ë¨¸ì§€ ì ì§„ ì¶”ê°€ |
| PNF íƒ€ì´ë¨¸ ë³µì¡ë„ | ë‚®ìŒ | ê³ ì • íƒ€ì´ë¨¸ë¡œ MVP |
