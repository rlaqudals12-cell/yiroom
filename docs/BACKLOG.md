# 이룸 백로그 (Deferred Features & Tech Debt)

> **마지막 업데이트**: 2026-01-10
> **목적**: 비용, 복잡도, 우선순위로 보류된 기능 및 기술 부채 추적

---

## 1. 비용 이슈로 보류

### 1.1 Gemini 3 Pro 업그레이드

| 항목          | 내용                                         |
| ------------- | -------------------------------------------- |
| **현재**      | gemini-2.5-flash (무료/저가)                 |
| **목표**      | gemini-3-pro (유료, 최고 성능)               |
| **보류 사유** | Google Cloud Billing 미활성화                |
| **필요 작업** | Billing 활성화 → API 키 갱신 → 비용 모니터링 |
| **예상 비용** | 월 $50~200 (사용량 기반)                     |
| **우선순위**  | 중간 (MVP 완성 후)                           |

### 1.2 피부 나이 추정 고도화

| 항목          | 내용                                     |
| ------------- | ---------------------------------------- |
| **현재**      | "피부 활력도" (0-100 점수)               |
| **목표**      | 실제 피부 나이 추정 (의료급 정확도)      |
| **보류 사유** | NIST 연구 MAE 5~8년 오차, 의료 규제 복잡 |
| **대안**      | 활력도 점수 + 요인 분석 (현재 구현됨)    |
| **우선순위**  | 낮음                                     |

---

## 2. 복잡도 이슈로 보류

### 2.1 사진 기반 오버레이 (Phase 2) - 부분 완료

| 항목            | 내용                                                    |
| --------------- | ------------------------------------------------------- |
| **스펙**        | SDD-VISUAL-SKIN-REPORT.md §5.2                          |
| **기능**        | 사용자 얼굴 사진 위에 피부 존 오버레이                  |
| **현재 상태**   | 🟡 단순 버전 완료 (고정 SVG 좌표)                       |
| **컴포넌트**    | `PhotoOverlayMap.tsx` (224줄) - skin/result에서 사용 중 |
| **남은 작업**   | MediaPipe 얼굴 랜드마크 기반 정밀 오버레이 (Phase 2+)   |
| **테스트**      | ✅ 완료 (26개 테스트) - 2026-01-10                      |
| **예상 복잡도** | 85점 (full 전략) - MediaPipe 통합 시                    |
| **우선순위**    | 낮음 (현재 버전으로 MVP 가능)                           |

### 2.2 ~~Before/After 슬라이더~~ ✅ 완료

| 항목          | 내용                                             |
| ------------- | ------------------------------------------------ |
| **스펙**      | SDD-VISUAL-SKIN-REPORT.md §5.2                   |
| **기능**      | 이전/현재 피부 사진 비교 슬라이더                |
| **현재 상태** | ✅ 컴포넌트 + 테스트 완료                        |
| **컴포넌트**  | `BeforeAfterSlider.tsx` (415줄) + 테스트 (449줄) |
| **사용 위치** | `/analysis/{skin,body,hair,makeup}/compare`      |
| **완료일**    | 2026-01-10 (기존 구현 확인)                      |

### 2.3 ~~월별 트렌드 차트~~ ✅ 완료

| 항목          | 내용                                     |
| ------------- | ---------------------------------------- |
| **스펙**      | SDD-VISUAL-SKIN-REPORT.md §5.2           |
| **기능**      | 피부 점수 변화 월별 그래프               |
| **현재 상태** | ✅ 컴포넌트 구현 + DB 연동 완료          |
| **컴포넌트**  | `TrendChart.tsx` (244줄)                 |
| **연동 위치** | `skin/result/[id]/page.tsx:349-362, 601` |
| **완료일**    | 2026-01-10                               |

### 2.4 세부 존 확장 (Phase 3)

| 항목          | 내용                                                |
| ------------- | --------------------------------------------------- |
| **스펙**      | SDD-VISUAL-SKIN-REPORT.md §5.3                      |
| **현재**      | 6개 존 (forehead, tZone, eyes, cheeks, uZone, chin) |
| **목표**      | 12개 세부 존 (forehead_center/sides 등)             |
| **보류 사유** | Gemini 프롬프트 복잡도, 정확도 검증 필요            |
| **우선순위**  | 낮음 (장기)                                         |

### 2.5 피부 일기 (Phase 3)

| 항목          | 내용                                              |
| ------------- | ------------------------------------------------- |
| **기능**      | 일일 컨디션, 수면, 식단 기록 → 피부 상관관계 분석 |
| **보류 사유** | N-1 영양 모듈과 중복 가능성, 설계 재검토 필요     |
| **우선순위**  | 낮음 (장기)                                       |

### 2.6 미성년자 법정대리인 동의 시스템

| 항목          | 내용                                   |
| ------------- | -------------------------------------- |
| **스펙**      | SDD-VISUAL-SKIN-REPORT.md §4.2.4       |
| **현재**      | 14세 미만 기능 제한 (이미지 저장 불가) |
| **목표**      | 부모 계정 연동 → 대리 동의             |
| **보류 사유** | 법적 검토 필요, 복잡한 UX 플로우       |
| **우선순위**  | 낮음                                   |

---

## 3. 인프라/운영 보류 항목

### 3.1 Edge Function Cron 설정

| 항목          | 내용                                                      |
| ------------- | --------------------------------------------------------- |
| **기능**      | 만료된 이미지 동의 자동 삭제                              |
| **현재 상태** | Edge Function 코드 작성 완료 (`cleanup-expired-consents`) |
| **보류 사유** | Supabase pg_cron 설정 필요 (대시보드 작업)                |
| **필요 작업** | SQL 실행: `SELECT cron.schedule(...)`                     |
| **우선순위**  | 높음 (GDPR 준수)                                          |

### 3.2 ~~설정 페이지 마케팅 동의 토글~~ ✅ 완료

| 항목          | 내용                                                           |
| ------------- | -------------------------------------------------------------- |
| **기능**      | 설정 > 개인정보에서 마케팅 동의 On/Off                         |
| **현재 상태** | ✅ 구현 완료 (컴포넌트 + 테스트 43개)                          |
| **스펙**      | [SDD-MARKETING-TOGGLE-UI.md](specs/SDD-MARKETING-TOGGLE-UI.md) |
| **완료일**    | 2026-01-09                                                     |

### 3.3 TestFlight 배포

| 항목          | 내용                                    |
| ------------- | --------------------------------------- |
| **현재 상태** | EAS 빌드 설정 완료, DEPLOYMENT.md 작성  |
| **보류 사유** | Apple Developer 계정 키 연동 대기       |
| **필요 작업** | 계정 설정 → EAS 연결 → 내부 테스트 빌드 |
| **우선순위**  | 높음                                    |

### 3.4 ~~DB 마이그레이션 파일 정리~~ ✅ 완료

| 항목          | 내용                                                                   |
| ------------- | ---------------------------------------------------------------------- |
| **현재 상태** | ✅ 누락 테이블 확인 및 생성 완료                                       |
| **생성 파일** | `202601090200_hair_analyses.sql`                                       |
| **스펙**      | [SDD-DB-MIGRATION-MANAGEMENT.md](specs/SDD-DB-MIGRATION-MANAGEMENT.md) |
| **완료일**    | 2026-01-09                                                             |

---

## 4. 기술 부채

### 4.1 Storybook 버전 충돌

| 항목          | 내용                                         |
| ------------- | -------------------------------------------- |
| **문제**      | 8.x/10.x 버전 혼재로 일부 스토리 렌더링 오류 |
| **영향**      | 컴포넌트 문서화/테스트 제한                  |
| **해결 방안** | Storybook 10.x로 통일 후 스토리 재작성       |
| **우선순위**  | 낮음                                         |

### 4.2 ~~Lint 경고~~ ✅ 대폭 개선

| 항목          | 내용                                             |
| ------------- | ------------------------------------------------ |
| **현재**      | 16개 경고 (0 에러) - 68개에서 개선               |
| **남은 유형** | `no-img-element` (blob URL 사용으로 의도적)      |
| **개선 내용** | unused imports 제거, TODO 주석 정리 (2026-01-09) |
| **우선순위**  | 낮음 (현재 수준 유지)                            |

### 4.3 ~~AI Fallback 패턴 불일치~~ ✅ 확인 완료

| 항목          | 내용                                                                  |
| ------------- | --------------------------------------------------------------------- |
| **모범 사례** | `lib/products/services/ingredient-analysis.ts`                        |
| **현재 상태** | ✅ `lib/gemini.ts` 모든 함수 Mock Fallback 적용됨                     |
| **확인 내용** | 17개 catch 블록 중 15개 mock fallback (2개는 내부 유틸)               |
| **패턴**      | FORCE_MOCK → genAI null check → withRetry/withTimeout → mock fallback |
| **완료일**    | 2026-01-10                                                            |

### 4.4 타입 정의 일관성

| 항목          | 내용                                 |
| ------------- | ------------------------------------ |
| **문제**      | 일부 API 응답 타입 `any` 사용        |
| **영향**      | 타입 안전성 저하                     |
| **해결 방안** | strict 타입 정의 + 런타임 검증 (Zod) |
| **우선순위**  | 중간                                 |

---

## 5. Phase별 미완료 항목

### 5.1 Phase B: React Native Mobile

| 항목                    | 상태    | 보류 사유        |
| ----------------------- | ------- | ---------------- |
| Week 7: TestFlight 배포 | ⏳ 대기 | Apple 키 연동    |
| 푸시 알림 설정          | ⏳ 대기 | APNS 인증서 필요 |

### 5.2 Phase V: Visual Analysis

| 항목               | 상태    | 보류 사유    |
| ------------------ | ------- | ------------ |
| 사진 기반 오버레이 | ⏳ 보류 | 복잡도       |
| Before/After 비교  | ⏳ 보류 | Phase 2 의존 |

### 5.3 Launch 준비

| 항목               | 상태    | 보류 사유         |
| ------------------ | ------- | ----------------- |
| 브랜딩 로고 최종화 | ⏳ 대기 | Figma 디자인 필요 |
| 앱스토어 스크린샷  | ⏳ 대기 | 최종 UI 확정 후   |

---

## 6. 우선순위 요약

### 즉시 필요 (출시 전)

1. Edge Function Cron 설정 (GDPR) - SQL 준비됨, 대시보드 실행 필요
2. TestFlight 배포 설정 - Apple 키 대기
3. ~~마케팅 동의 토글 UI~~ ✅ 완료
4. ~~DB 마이그레이션 정리~~ ✅ 완료

### 출시 후 Phase 2

1. 사진 기반 오버레이 - 🟡 단순 버전 완료 (정밀 버전은 MediaPipe 필요)
2. ~~Before/After 슬라이더~~ ✅ 완료
3. Gemini 3 Pro 업그레이드

### 장기 계획

1. 세부 존 확장 (12개)
2. 피부 일기
3. 미성년자 대리 동의

---

## 7. 추가 보류 항목 (SDD 문서 기반)

### 7.1 바코드 스캔 확장

| Phase   | 기능                      | 조건        |
| ------- | ------------------------- | ----------- |
| Phase 2 | AI OCR 성분표 인식        | MAU 5,000+  |
| Phase 3 | 커뮤니티 제품 검증 시스템 | MAU 10,000+ |

**스펙**: SDD-BARCODE-SCAN.md §8

### 7.2 성분 분석 확장

| Phase   | 기능                           | 상태    |
| ------- | ------------------------------ | ------- |
| Phase 2 | 피부타입별 상세 분석           | ⏳ 보류 |
| Phase 2 | 배합목적 분류 (보습/유연/장벽) | ⏳ 보류 |
| Phase 3 | AI 성분 요약 키워드            | ⏳ 보류 |
| Phase 3 | 성분 비율 시각화 차트          | ⏳ 보류 |

**스펙**: SDD-INGREDIENT-ANALYSIS.md

### 7.3 약관동의 확장

| 항목                 | 보류 사유                 |
| -------------------- | ------------------------- |
| 모바일 앱 약관동의   | 별도 Phase (Mobile)       |
| 제3자 정보 제공 동의 | 어필리에이트 확장 시 검토 |

**스펙**: SDD-TERMS-AGREEMENT.md §3 OUT

### 7.4 뷰티 UX 추가 개선

| 항목           | 레퍼런스    | 우선순위 |
| -------------- | ----------- | -------- |
| 빠른 배송 표시 | 무신사 뷰티 | 낮음     |
| 브랜드 컬렉션  | 무신사 뷰티 | 낮음     |

**스펙**: SDD-BEAUTY-UX-IMPROVEMENTS.md §향후 과제

### 7.5 크로스 모듈 인사이트 확장

| Phase   | 기능                              | 상태    |
| ------- | --------------------------------- | ------- |
| Phase 2 | AI 코치 + 헤어/메이크업 통합 코칭 | ⏳ 보류 |
| Phase 2 | 뷰티-영양 상관관계 주간 리포트    | ⏳ 보류 |
| Phase 2 | 뷰티 보조 영양제 추천 연동        | ⏳ 보류 |

**스펙**: cross-module-insights-hair-makeup.md §8

### 7.6 ~~코드 내 TODO~~ ✅ 우선순위 정리 완료

| 위치                                  | 내용                         | 우선순위 |
| ------------------------------------- | ---------------------------- | -------- |
| `lib/analytics/stats.ts:248`          | 이탈률(bounceRate) 계산 로직 | P2       |
| `app/api/analyze/skin/route.ts:124`   | 다각도 분석 지원             | P2       |
| `app/api/analyze/skin/route.ts:133`   | 비대칭 감지 AI 분석          | P2       |
| `app/api/analyze/makeup/route.ts:179` | 메이크업 분석 배지 시스템    | P3       |
| `app/api/analyze/hair/route.ts:168`   | 헤어 분석 배지 시스템        | P3       |

> **정리 완료** (2026-01-09): TODO 주석을 P2/P3 우선순위 주석으로 변환

---

## 8. 주의사항 및 리스크

### 8.1 법적 리스크 (즉시 조치 필요)

| 리스크                    | 영향               | 현재 상태                 | 필요 조치         |
| ------------------------- | ------------------ | ------------------------- | ----------------- |
| **GDPR 자동 삭제 미설정** | 벌금 €2천만/매출4% | Edge Function 코드만 있음 | pg_cron 설정 필수 |
| **이미지 동의 만료 처리** | 데이터 보유 위반   | 수동 삭제만 가능          | Cron Job 활성화   |

### 8.2 운영 리스크

| 리스크                       | 영향             | 완화 방안                    |
| ---------------------------- | ---------------- | ---------------------------- |
| **모바일-웹 동의 불일치**    | 사용자 혼란      | 동일 API 사용, 동기화 테스트 |
| **약관 버전 변경 시 재동의** | 서비스 접근 차단 | 사전 공지, 점진적 롤아웃     |
| **DB 마이그레이션 실패**     | 배포 중단        | 스테이징 환경 검증 필수      |

### 8.3 기술 리스크

| 리스크                    | 영향         | 완화 방안              |
| ------------------------- | ------------ | ---------------------- |
| **Gemini API 중단**       | AI 분석 불가 | Mock Fallback 검증     |
| **Supabase Storage 용량** | 비용 증가    | 이미지 압축, 자동 삭제 |
| **Apple 심사 거절**       | 출시 지연    | 체크리스트 사전 검토   |

### 8.4 의존성 주의

```
Phase 2 (사진 오버레이) ─┬─► Phase 1 (이미지 동의) ✅ 완료
                        └─► MediaPipe 통합 (미시작)

TestFlight 배포 ─────────► Apple Developer 키 (대기 중)

Gemini 3 Pro ────────────► Google Billing 활성화 (미완료)
```

---

## 9. 관련 문서

| 문서                                                                   | 설명                        |
| ---------------------------------------------------------------------- | --------------------------- |
| [PROGRESS.md](PROGRESS.md)                                             | 전체 진행 상황              |
| [SDD-VISUAL-SKIN-REPORT.md](specs/SDD-VISUAL-SKIN-REPORT.md)           | 시각적 피부 리포트 스펙     |
| [SDD-TERMS-AGREEMENT.md](SDD-TERMS-AGREEMENT.md)                       | 약관동의 스펙               |
| [SDD-MARKETING-TOGGLE-UI.md](specs/SDD-MARKETING-TOGGLE-UI.md)         | 마케팅 토글 UI 스펙 ✨ NEW  |
| [SDD-DB-MIGRATION-MANAGEMENT.md](specs/SDD-DB-MIGRATION-MANAGEMENT.md) | DB 마이그레이션 관리 ✨ NEW |
| [SDD-INGREDIENT-ANALYSIS.md](SDD-INGREDIENT-ANALYSIS.md)               | 성분 분석 스펙              |
| [SDD-BARCODE-SCAN.md](SDD-BARCODE-SCAN.md)                             | 바코드 스캔 스펙            |
| [ROADMAP-LAUNCH.md](ROADMAP-LAUNCH.md)                                 | 출시 로드맵                 |

---

## 10. 변경 이력

| 버전 | 날짜       | 변경 내용                                                          |
| ---- | ---------- | ------------------------------------------------------------------ |
| 1.8  | 2026-01-10 | PhotoOverlayMap 단순 버전 완료 확인 (224줄, 테스트 미작성)         |
| 1.7  | 2026-01-10 | Before/After 슬라이더 완료 확인 (415줄 + 테스트 449줄)             |
| 1.6  | 2026-01-10 | AI Fallback 패턴 검증 완료 (17개 함수 모두 mock fallback 적용됨)   |
| 1.5  | 2026-01-10 | 월별 트렌드 차트 완료 표시 (TrendChart.tsx + DB 연동)              |
| 1.4  | 2026-01-09 | Lint 경고 68→16개 개선, TODO→P2/P3 우선순위 정리, 테스트 실패 수정 |
| 1.3  | 2026-01-08 | 마케팅 토글 UI, DB 마이그레이션 관리 스펙 추가                     |
| 1.2  | 2026-01-08 | 크로스 모듈 인사이트 확장 추가, 코드 내 TODO 5건 추가              |
| 1.1  | 2026-01-08 | SDD 문서 기반 보류 항목 추가, 주의사항/리스크 섹션 추가            |
| 1.0  | 2026-01-08 | 최초 작성                                                          |

---

**Version**: 1.8
**Created**: 2026-01-08
**Updated**: 2026-01-10
