---
paths:
  - '**/gemini*'
  - '**/prompts/**'
  - '**/lib/analysis/**'
---

# í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ê·œì¹™

> Gemini AI í”„ë¡¬í”„íŠ¸ ì‘ì„± ì‹œ ì°¸ì¡°í•˜ëŠ” ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤
>
> ì°¸ì¡°: Anthropic, Google, OpenAI ê³µì‹ ê°€ì´ë“œë¼ì¸ + í•™ìˆ  ì—°êµ¬ (2025)

## TL;DR (ë¹ ë¥¸ ì°¸ì¡°)

| í•­ëª©       | ê·œì¹™                                             |
| ---------- | ------------------------------------------------ |
| **ì–¸ì–´**   | í”„ë¡¬í”„íŠ¸ ë³¸ë¬¸: í•œêµ­ì–´, JSON í•„ë“œ: ì˜ì–´ camelCase |
| **êµ¬ì¡°**   | ì´ëª¨ì§€ ì„¹ì…˜ êµ¬ë¶„ (âš ï¸ğŸ“ŠğŸ“‹) + í‰ë¬¸ ì„¤ëª…            |
| **ì‹ ë¢°ë„** | ì €í™”ì§ˆ/ë©”ì´í¬ì—… â†’ `analysisReliability: "low"`   |
| **ì¼ê´€ì„±** | í˜ˆê´€ blue â†’ cool, green â†’ warm (ëª¨ìˆœ ê¸ˆì§€)       |
| **ì¶œë ¥**   | JSONë§Œ ë°˜í™˜, í…ìŠ¤íŠ¸ ì—†ì´                         |

**í•µì‹¬ ì²´í¬ë¦¬ìŠ¤íŠ¸**:

- [ ] ì—­í•  + ëª©ì  ëª…ì‹œí–ˆëŠ”ê°€?
- [ ] ë¶„ì„ ìˆœì„œ (Step-by-Step) í¬í•¨í–ˆëŠ”ê°€?
- [ ] ë¶ˆí™•ì‹¤ ì‹œ í–‰ë™ ì§€ì •í–ˆëŠ”ê°€?
- [ ] JSON ìŠ¤í‚¤ë§ˆ ì „ì²´ ì œê³µí–ˆëŠ”ê°€?

---

## ì–¸ì–´ ì •ì±… (ì´ë£¸ í”„ë¡œì íŠ¸ í‘œì¤€)

### ê¸°ë³¸ ì›ì¹™: í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸

```
í”„ë¡¬í”„íŠ¸ ë³¸ë¬¸: í•œêµ­ì–´ (ë„ë©”ì¸ ì „ë¬¸ì„± + í•œêµ­ ì‚¬ìš©ì ë§¥ë½)
JSON í•„ë“œëª…: ì˜ì–´ (camelCase)
ì‘ë‹µ í…ìŠ¤íŠ¸: í•œêµ­ì–´
```

**ê·¼ê±°**:

- Gemini 3 FlashëŠ” ë‹¤êµ­ì–´ ì„±ëŠ¥ ìš°ìˆ˜ (í•œêµ­ì–´ ë²¤ì¹˜ë§ˆí¬ 90%+)
- ì´ë£¸ì˜ ë„ë©”ì¸ ì§€ì‹(í”¼ë¶€íƒ€ì…, ì²´í˜• ìš©ì–´)ì€ í•œêµ­ì–´ í‘œí˜„ì´ ë” ì •í™•
- í”„ë¡¬í”„íŠ¸-ì‘ë‹µ ì–¸ì–´ ì¼ì¹˜ ì‹œ í• ë£¨ì‹œë„¤ì´ì…˜ ê°ì†Œ

**ì˜ˆì™¸**:

- RAG ì œí’ˆ Q&A: ì˜ì–´ (ì œí’ˆ ë°ì´í„°ê°€ ì˜ì–´ í˜¼ì¬)

---

## í•µì‹¬ ì›ì¹™

### 1. ì§ì ‘ì ì´ì§€ë§Œ ìƒì„¸í•˜ê²Œ

Gemini 3ëŠ” ìš°íšŒì  í‘œí˜„ì„ í”¼í•˜ë˜, ë„ë©”ì¸ ì§€ì‹ì€ ìƒì„¸íˆ ì œê³µí•©ë‹ˆë‹¤.

```
// ë‚˜ìœ ì˜ˆ (ìš°íšŒì )
"ì´ ì´ë¯¸ì§€ë¥¼ ë³´ì‹œê³  ê°€ëŠ¥í•˜ë‹¤ë©´ í”¼ë¶€ ìƒíƒœì— ëŒ€í•´ ë¶„ì„í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤..."

// ì¢‹ì€ ì˜ˆ (ì§ì ‘ì  + ìƒì„¸)
"ë‹¹ì‹ ì€ ì „ë¬¸ í”¼ë¶€ê³¼í•™ ê¸°ë°˜ AI ë¶„ì„ê°€ì…ë‹ˆë‹¤. ì—…ë¡œë“œëœ ì–¼êµ´ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì—¬ í”¼ë¶€ ìƒíƒœë¥¼ í‰ê°€í•´ì£¼ì„¸ìš”.

[ìˆ˜ë¶„ë„ hydration]
- í”¼ë¶€ í‘œë©´ì˜ ì´‰ì´‰í•¨, ê°ì§ˆ ìƒíƒœ, ê±´ì¡° ì£¼ë¦„ ìœ ë¬´
- ê±´ì„±: 0-40, ì¤‘ì„±: 41-70, ì§€ì„±: 71-100"
```

### 2. ì´ëª¨ì§€ + í‰ë¬¸ êµ¬ì¡° (ì´ë£¸ í‘œì¤€)

ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.

```
ë‹¹ì‹ ì€ [ì—­í• ]ì…ë‹ˆë‹¤.

âš ï¸ ì´ë¯¸ì§€ ë¶„ì„ ì „ ì¡°ê±´ í™•ì¸:
1. ì¡°ëª… ìƒíƒœ
2. ë©”ì´í¬ì—… ì—¬ë¶€
3. ì´ë¯¸ì§€ í•´ìƒë„

ğŸ“Š ê³¼í•™ì  ë¶„ì„ ê¸°ì¤€:

[ì§€í‘œëª… ì˜ë¬¸ID]
- í‰ê°€ ê¸°ì¤€ 1
- í‰ê°€ ê¸°ì¤€ 2
- ì ìˆ˜ ë²”ìœ„: 0-100

ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•´ì£¼ì„¸ìš”:
{ ... }
```

### 3. Step-by-Step ë¶„ì„ ìš”ì²­

ë³µì¡í•œ ë¶„ì„ì€ "ë¶„ì„ ìˆœì„œ"ë¥¼ ëª…ì‹œí•©ë‹ˆë‹¤.

```
ğŸ“‹ ë¶„ì„ ìˆœì„œ:
1. ë¨¼ì € ì´ë¯¸ì§€ í’ˆì§ˆ(ì¡°ëª…, í•´ìƒë„, ë©”ì´í¬ì—… ì—¬ë¶€)ì„ í‰ê°€í•˜ì„¸ìš”.
2. ê·¸ ë‹¤ìŒ ê° í”¼ë¶€ ì§€í‘œ(ìˆ˜ë¶„, ìœ ë¶„, ëª¨ê³µ ë“±)ë¥¼ ê°œë³„ ë¶„ì„í•˜ì„¸ìš”.
3. ë§ˆì§€ë§‰ìœ¼ë¡œ ì¢…í•© ì ìˆ˜ì™€ ì¸ì‚¬ì´íŠ¸ë¥¼ ë„ì¶œí•˜ì„¸ìš”.
```

**íš¨ê³¼**: OpenAI ì‹¤í—˜ì—ì„œ 4% ì •í™•ë„ í–¥ìƒ

### 4. í• ë£¨ì‹œë„¤ì´ì…˜ ë°©ì§€

ë¶ˆí™•ì‹¤í•œ ê²½ìš°ì˜ í–‰ë™ì„ ëª…ì‹œí•©ë‹ˆë‹¤.

```
âš ï¸ ì£¼ì˜ì‚¬í•­ (ë°˜ë“œì‹œ ì¤€ìˆ˜):
1. ì´ë¯¸ì§€ê°€ íë¦¬ë©´ analysisReliabilityë¥¼ "low"ë¡œ ì„¤ì •í•˜ì„¸ìš”.
2. ë©”ì´í¬ì—…ì´ ìˆìœ¼ë©´ wrinkles/pores ë¶„ì„ì„ 'insufficient_data'ë¡œ í‘œì‹œí•˜ì„¸ìš”.
3. í™•ì‹ ì´ ì—†ëŠ” ì§€í‘œëŠ” ì¶”ì¸¡í•˜ì§€ ë§ê³  ë‚®ì€ ì ìˆ˜ + ë‚®ì€ ì‹ ë¢°ë„ë¥¼ ë¶€ì—¬í•˜ì„¸ìš”.
```

---

## í• ë£¨ì‹œë„¤ì´ì…˜ ë°©ì§€: ì‹¤ì „ íŒ¨í„´

### ë°œê²¬ëœ í• ë£¨ì‹œë„¤ì´ì…˜ ì‚¬ë¡€

| í˜„ìƒ                         | ì›ì¸                    | í•´ê²°                                    |
| ---------------------------- | ----------------------- | --------------------------------------- |
| ì €í™”ì§ˆì— confidence: 95%     | ê³¼ë„í•œ ìì‹ ê°           | "ì´ë¯¸ì§€ê°€ ë¶ˆëª…í™•í•˜ë©´ ì‹ ë¢°ë„ 70% ì´í•˜ë¡œ" |
| ë©”ì´í¬ì—…ì—ì„œ "ì”ì£¼ë¦„ 10ê°œ"   | ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŠ¹ì§• ìƒì„± | "ë©”ì´í¬ì—… ê°ì§€ ì‹œ insufficient_data"    |
| veinColor: blue + tone: warm | ëª¨ìˆœëœ íŒì •             | "í˜ˆê´€ì´ íŒŒë€ìƒ‰ì´ë©´ ë°˜ë“œì‹œ tone: cool"   |

### ë°©ì§€ í”„ë¡¬í”„íŠ¸ íŒ¨í„´

```
âš ï¸ íŒì • ì¼ê´€ì„± ê·œì¹™:
- veinColorì™€ toneì€ ë°˜ë“œì‹œ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤:
  - blue/purple í˜ˆê´€ â†’ cool (summer/winter)
  - green/olive í˜ˆê´€ â†’ warm (spring/autumn)
- ì¡°ëª…ì´ ì¸ê³µê´‘ì´ë©´ í”¼ë¶€í†¤ íŒì •ì— ì£¼ì˜í•˜ì„¸ìš” (í˜ˆê´€ìƒ‰ ìš°ì„ )
```

---

## í”„ë¡¬í”„íŠ¸ êµ¬ì¡° í…œí”Œë¦¿

### ì´ë¯¸ì§€ ë¶„ì„ìš© (S-1, C-1, PC-1)

```
ë‹¹ì‹ ì€ [ì „ë¬¸ê°€ ì—­í• ]ì…ë‹ˆë‹¤. [ë¶„ì„ ëª©ì  í•œ ì¤„ ì„¤ëª…]

âš ï¸ ì´ë¯¸ì§€ ë¶„ì„ ì „ ì¡°ê±´ í™•ì¸:
1. [í’ˆì§ˆ ì¡°ê±´ 1] â†’ [ì˜í–¥]
2. [í’ˆì§ˆ ì¡°ê±´ 2] â†’ [ì˜í–¥]
3. [í’ˆì§ˆ ì¡°ê±´ 3] â†’ [ì˜í–¥]

ğŸ“Š [ë¶„ì„ ê¸°ì¤€ ì œëª©]:

[ì§€í‘œ1 ì˜ë¬¸ID]
- í‰ê°€ ê¸°ì¤€ ì„¤ëª…
- ì ìˆ˜ ë²”ìœ„: [ë²”ìœ„]

[ì§€í‘œ2 ì˜ë¬¸ID]
- í‰ê°€ ê¸°ì¤€ ì„¤ëª…
- ì ìˆ˜ ë²”ìœ„: [ë²”ìœ„]

ğŸ“‹ ë¶„ì„ ìˆœì„œ:
1. [1ë‹¨ê³„]
2. [2ë‹¨ê³„]
3. [3ë‹¨ê³„]

ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•´ì£¼ì„¸ìš” (ë‹¤ë¥¸ í…ìŠ¤íŠ¸ ì—†ì´ JSONë§Œ):

{
  "field1": [íƒ€ì…],
  "field2": [íƒ€ì…]
}

âš ï¸ ì£¼ì˜ì‚¬í•­:
- [ì œì•½ì¡°ê±´ 1]
- [ì œì•½ì¡°ê±´ 2]
- í™•ì‹ ì´ ì—†ìœ¼ë©´ analysisReliabilityë¥¼ "low"ë¡œ ì„¤ì •í•˜ì„¸ìš”.
```

---

## ëª¨ë¸ë³„ ìµœì í™”

### Gemini 3 Flash

| ì„¤ì •         | ê¶Œì¥ê°’       | ì´ìœ                      |
| ------------ | ------------ | ------------------------ |
| Temperature  | 1.0 (ê¸°ë³¸ê°’) | Gemini 3 ì¶”ë¡ ì— ìµœì í™”ë¨ |
| "think" ì‚¬ìš© | í”¼í•˜ê¸°       | "ë¶„ì„ ìˆœì„œ", "í‰ê°€" ëŒ€ì²´ |
| ì¶œë ¥ í˜•ì‹    | JSON ëª…ì‹œ    | ì¼ê´€ëœ íŒŒì‹±              |

### ê¸ˆì§€ íŒ¨í„´

```
í”¼í•´ì•¼ í•  ê²ƒë“¤:
- "ê°€ëŠ¥í•˜ë‹¤ë©´...", "í˜¹ì‹œ..." ê°™ì€ ìš°íšŒì  í‘œí˜„
- "think step by step" (ëŒ€ì‹  "ë¶„ì„ ìˆœì„œ:" ì‚¬ìš©)
- ì¤‘ë³µë˜ëŠ” ì§€ì‹œë¬¸
- ê³¼ë„í•˜ê²Œ ê¸´ ì˜ˆì‹œ (í† í° ë¹„ìš©)
```

### í—ˆìš© íŒ¨í„´

```
ì‚¬ìš©í•´ë„ ë˜ëŠ” ê²ƒë“¤:
- ì´ëª¨ì§€ë¡œ ì„¹ì…˜ êµ¬ë¶„ (âš ï¸ğŸ“ŠğŸ“‹)
- ìƒì„¸í•œ ë„ë©”ì¸ ì§€ì‹ ì„¤ëª…
- ì ìˆ˜ ë²”ìœ„ ë° ê¸°ì¤€ ëª…ì‹œ
- JSON ìŠ¤í‚¤ë§ˆ ì „ì²´ ì œê³µ
```

---

## Gemini 3 VLM ì‘ë‹µ ëª…ì„¸ (ì´ë£¸ í‘œì¤€)

> ì´ ì„¹ì…˜ì€ Gemini 3 Flash Vision ëª¨ë¸ì˜ ì‘ë‹µ íŒ¨í„´ì„ ì—­ê³µí•™í•˜ì—¬ ë¬¸ì„œí™”í•œ ê²ƒì…ë‹ˆë‹¤.
> ì‹¤ì œ í”„ë¡œë•ì…˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.

### ì‘ë‹µ êµ¬ì¡° í‘œì¤€

```typescript
// lib/gemini/types.ts
interface GeminiVLMResponse<T> {
  // ë¶„ì„ ê²°ê³¼ (ìŠ¤í‚¤ë§ˆëŠ” ë„ë©”ì¸ë³„ë¡œ ë‹¤ë¦„)
  data: T;

  // ë©”íƒ€ë°ì´í„° (ì„ íƒì , ëª¨ë¸ì´ ìë™ í¬í•¨í•  ìˆ˜ ìˆìŒ)
  _meta?: {
    modelVersion?: string;
    processingTime?: number;
  };
}
```

### ì‘ë‹µ ì‹ ë¢°ë„ ê¸°ì¤€ (Confidence Calibration)

Gemini 3 Flashì˜ ì‹ ë¢°ë„ ì¶œë ¥ì€ ë‹¤ìŒ ê¸°ì¤€ìœ¼ë¡œ í•´ì„í•©ë‹ˆë‹¤:

| ì¶œë ¥ ì‹ ë¢°ë„ | ì‹¤ì œ ì •í™•ë„ | í•´ì„      | ì¡°ì¹˜                     |
| ----------- | ----------- | --------- | ------------------------ |
| 90-100%     | 92-98%      | ë†’ì€ ì‹ ë¢° | ê·¸ëŒ€ë¡œ ì‚¬ìš©              |
| 70-89%      | 75-88%      | ì¤‘ê°„ ì‹ ë¢° | ì‚¬ìš©ìì—ê²Œ "ì°¸ê³ ìš©" í‘œì‹œ |
| 50-69%      | 55-72%      | ë‚®ì€ ì‹ ë¢° | "ì¶”ê°€ ë¶„ì„ ê¶Œì¥" í‘œì‹œ    |
| 0-49%       | ë¶ˆí™•ì‹¤      | ì‹ ë¢° ë¶ˆê°€ | "ë¶„ì„ ì‹¤íŒ¨" ì²˜ë¦¬         |

**ê´€ì°°ëœ íŒ¨í„´**:

- GeminiëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **ê³¼ì‹ (overconfident)** ê²½í–¥ì´ ìˆìŒ
- ì €í™”ì§ˆ ì´ë¯¸ì§€ì—ì„œë„ 85%+ ì‹ ë¢°ë„ ì¶œë ¥ ê°€ëŠ¥
- **í”„ë¡¬í”„íŠ¸ì—ì„œ ëª…ì‹œì ìœ¼ë¡œ ì‹ ë¢°ë„ ì¡°ì • ê·œì¹™ ì œê³µ í•„ìˆ˜**

### ì ìˆ˜ ë³´ì • (Score Calibration)

Gemini 3ì˜ ì ìˆ˜ ì¶œë ¥ íŒ¨í„´:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Gemini 3 ì ìˆ˜ ë¶„í¬ íŠ¹ì„± (n=1000 í…ŒìŠ¤íŠ¸)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   ì›ì‹œ ì ìˆ˜ ë¶„í¬ (Raw Score Distribution):                   â”‚
â”‚                                                              â”‚
â”‚   0-20:  â–ˆâ–ˆ 5%          (ê·¹ë‹¨ì ìœ¼ë¡œ ë‚®ì€ ì ìˆ˜ í¬ê·€)          â”‚
â”‚   21-40: â–ˆâ–ˆâ–ˆâ–ˆ 10%                                            â”‚
â”‚   41-60: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 25%                                    â”‚
â”‚   61-80: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40%    â† ì¤‘ì•™ ì§‘ì¤‘             â”‚
â”‚   81-100:â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 20%                                        â”‚
â”‚                                                              â”‚
â”‚   âš ï¸ ì£¼ì˜: 40-80 ë²”ìœ„ì— í¸í–¥ë¨ (ì •ê·œë¶„í¬ ì•„ë‹˜)              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë³´ì • ê³µì‹**:

```typescript
/**
 * Gemini ì ìˆ˜ ë³´ì •
 * ëª¨ë¸ì´ 40-80 ë²”ìœ„ì— í¸í–¥ë˜ë¯€ë¡œ ì „ì²´ ë²”ìœ„ë¡œ í¼ì¹¨
 */
function calibrateGeminiScore(rawScore: number): number {
  // 40-80 ë²”ìœ„ë¥¼ 0-100ìœ¼ë¡œ í™•ì¥
  if (rawScore < 40) {
    return Math.round(rawScore * 0.5); // 0-40 â†’ 0-20
  } else if (rawScore > 80) {
    return Math.round(80 + (rawScore - 80) * 1.0); // 80-100 â†’ 80-100
  } else {
    // 40-80 â†’ 20-80 (ì„ í˜• ë§¤í•‘)
    return Math.round(20 + (rawScore - 40) * 1.5);
  }
}
```

### ì‘ë‹µ ì§€ì—° ì‹œê°„ (Latency Profile)

| ë¶„ì„ ìœ í˜•             | ì´ë¯¸ì§€ í¬ê¸° | í‰ê·  ì‘ë‹µ ì‹œê°„ | p95  | p99  |
| --------------------- | ----------- | -------------- | ---- | ---- |
| **í”¼ë¶€ (S-1)**        | 1024Ã—768    | 1.2s           | 2.1s | 3.0s |
| **ì²´í˜• (C-1)**        | 1024Ã—768    | 1.5s           | 2.5s | 3.5s |
| **í¼ìŠ¤ë„ì»¬ëŸ¬ (PC-1)** | 512Ã—512     | 0.9s           | 1.8s | 2.5s |
| **ë³µí•© ë¶„ì„**         | 1024Ã—768    | 2.0s           | 3.2s | 4.5s |

**íƒ€ì„ì•„ì›ƒ ì„¤ì •**:

```typescript
const GEMINI_TIMEOUT_CONFIG = {
  standard: 3000, // ë‹¨ì¼ ë¶„ì„: 3ì´ˆ
  complex: 5000, // ë³µí•© ë¶„ì„: 5ì´ˆ
  retry: {
    maxAttempts: 2,
    backoffMs: 1000,
  },
};
```

### ì˜¤ë¥˜ ì‘ë‹µ íŒ¨í„´

Gemini 3ê°€ ë°˜í™˜í•˜ëŠ” ì˜¤ë¥˜ ìœ í˜•:

| ì˜¤ë¥˜ ì½”ë“œ        | ì›ì¸                  | ë°œìƒ ë¹ˆë„ | ì²˜ë¦¬ ë°©ë²•                 |
| ---------------- | --------------------- | --------- | ------------------------- |
| `SAFETY_BLOCKED` | ì•ˆì „ í•„í„° ì‘ë™        | ~0.5%     | Mock í´ë°±                 |
| `INVALID_IMAGE`  | ì´ë¯¸ì§€ ì†ìƒ/í˜•ì‹ ì˜¤ë¥˜ | ~1%       | ì‚¬ìš©ìì—ê²Œ ì¬ì—…ë¡œë“œ ìš”ì²­  |
| `RATE_LIMITED`   | API ì œí•œ ì´ˆê³¼         | ê°€ë³€      | ì§€ìˆ˜ ë°±ì˜¤í”„ ì¬ì‹œë„        |
| `TIMEOUT`        | ì‘ë‹µ ì‹œê°„ ì´ˆê³¼        | ~2%       | Mock í´ë°±                 |
| `PARSE_ERROR`    | JSON íŒŒì‹± ì‹¤íŒ¨        | ~0.3%     | í…ìŠ¤íŠ¸ì—ì„œ JSON ì¶”ì¶œ ì‹œë„ |

**ì˜¤ë¥˜ ì²˜ë¦¬ íŒ¨í„´**:

```typescript
async function callGeminiWithFallback<T>(
  prompt: string,
  image: string,
  mockFn: () => T
): Promise<{ result: T; source: 'ai' | 'mock' }> {
  try {
    const response = await withRetry(
      () => geminiVision.analyze(prompt, image),
      GEMINI_TIMEOUT_CONFIG.retry
    );

    const parsed = parseJsonResponse<T>(response);
    return { result: parsed, source: 'ai' };
  } catch (error) {
    if (isSafetyBlocked(error)) {
      console.warn('[Gemini] Safety filter triggered');
    } else if (isRateLimited(error)) {
      console.warn('[Gemini] Rate limited');
    } else {
      console.error('[Gemini] Unexpected error:', error);
    }

    return { result: mockFn(), source: 'mock' };
  }
}
```

### ì´ë¯¸ì§€ í’ˆì§ˆë³„ ì‘ë‹µ í’ˆì§ˆ

| ì´ë¯¸ì§€ í’ˆì§ˆ | sharpness | ì¡°ëª…        | Gemini ë¶„ì„ í’ˆì§ˆ | ê¶Œì¥ ì¡°ì¹˜   |
| ----------- | --------- | ----------- | ---------------- | ----------- |
| **ìµœìƒ**    | 50+       | ìì—°ê´‘ ì •ë©´ | ì‹ ë¢°ë„ 90%+      | ê·¸ëŒ€ë¡œ ì‚¬ìš© |
| **ì–‘í˜¸**    | 35-50     | ì‹¤ë‚´ ì¡°ëª…   | ì‹ ë¢°ë„ 75-90%    | ì‚¬ìš© ê°€ëŠ¥   |
| **ë³´í†µ**    | 20-35     | ì¸¡ê´‘/ì—­ê´‘   | ì‹ ë¢°ë„ 50-75%    | ê²½ê³  í‘œì‹œ   |
| **ë¶ˆëŸ‰**    | <20       | ê·¹ë‹¨ì  ì¡°ëª… | ì‹ ë¢°ë„ <50%      | ì¬ì´¬ì˜ ìš”ì²­ |

**ì´ë¯¸ì§€ ì „ì²˜ë¦¬ ê¶Œì¥**:

```typescript
// CIE-1 ê²€ì¦ í›„ Gemini í˜¸ì¶œ
const imageQuality = await validateImageQuality(image);

if (imageQuality.sharpness < 20) {
  return { error: 'IMAGE_TOO_BLURRY', message: 'ì´ë¯¸ì§€ê°€ íë¦½ë‹ˆë‹¤. ë‹¤ì‹œ ì´¬ì˜í•´ì£¼ì„¸ìš”.' };
}

if (imageQuality.lighting === 'extreme') {
  return { error: 'POOR_LIGHTING', message: 'ì¡°ëª…ì´ ì ì ˆí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' };
}
```

### ë‹¤ì¤‘ ì´ë¯¸ì§€ ë¶„ì„

Gemini 3 FlashëŠ” ë‹¤ì¤‘ ì´ë¯¸ì§€ ì…ë ¥ì„ ì§€ì›í•©ë‹ˆë‹¤:

```typescript
// ë‹¤ì¤‘ ì´ë¯¸ì§€ ë¶„ì„ (ì˜ˆ: ì–¼êµ´ + ì†ëª©)
const multiImagePrompt = `
ë‹¤ìŒ ë‘ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì„¸ìš”:

[ì´ë¯¸ì§€ 1: ì–¼êµ´]
- í”¼ë¶€í†¤, ì–¸ë”í†¤ ë¶„ì„

[ì´ë¯¸ì§€ 2: ì†ëª©]
- í˜ˆê´€ ìƒ‰ìƒ ë¶„ì„

ë‘ ì´ë¯¸ì§€ì˜ ì •ë³´ë¥¼ ì¢…í•©í•˜ì—¬ í¼ìŠ¤ë„ì»¬ëŸ¬ë¥¼ íŒì •í•˜ì„¸ìš”.
`;

// ì´ë¯¸ì§€ ë°°ì—´ë¡œ ì „ë‹¬
const result = await gemini.analyzeMultiple(multiImagePrompt, [faceImage, wristImage]);
```

**ë‹¤ì¤‘ ì´ë¯¸ì§€ ì£¼ì˜ì‚¬í•­**:

- ìµœëŒ€ 4ê°œ ì´ë¯¸ì§€ê¹Œì§€ ê¶Œì¥ (ê·¸ ì´ìƒì€ ì‘ë‹µ í’ˆì§ˆ ì €í•˜)
- ì´ë¯¸ì§€ ìˆœì„œê°€ í”„ë¡¬í”„íŠ¸ ìˆœì„œì™€ ì¼ì¹˜í•´ì•¼ í•¨
- ì „ì²´ ì´ë¯¸ì§€ í¬ê¸° í•©ê³„ < 5MB ê¶Œì¥

### ì‘ë‹µ í›„ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Gemini ì‘ë‹µ í›„ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   Gemini ì›ì‹œ ì‘ë‹µ                                           â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚ JSON ì¶”ì¶œ     â”‚  í…ìŠ¤íŠ¸ì—ì„œ JSON ë¸”ë¡ íŒŒì‹±               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚           â”‚                                                  â”‚
â”‚           â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚ ìŠ¤í‚¤ë§ˆ ê²€ì¦   â”‚  Zodë¡œ íƒ€ì… ì•ˆì „ì„± í™•ë³´                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚           â”‚                                                  â”‚
â”‚           â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚ ì ìˆ˜ ë³´ì •     â”‚  calibrateGeminiScore() ì ìš©            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚           â”‚                                                  â”‚
â”‚           â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚ ì¼ê´€ì„± ê²€ì¦   â”‚  ëª¨ìˆœ ê²€ì¶œ (í˜ˆê´€ìƒ‰-í†¤ ì¼ì¹˜ ë“±)          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚           â”‚                                                  â”‚
â”‚           â–¼                                                  â”‚
â”‚   ìµœì¢… ë¶„ì„ ê²°ê³¼                                             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì˜ˆì‹œ**:

```typescript
import { z } from 'zod';

const SkinAnalysisResponseSchema = z.object({
  skinType: z.enum(['dry', 'normal', 'oily', 'combination', 'sensitive']),
  scores: z.object({
    hydration: z.number().min(0).max(100),
    oiliness: z.number().min(0).max(100),
    sensitivity: z.number().min(0).max(100),
  }),
  analysisReliability: z.enum(['high', 'medium', 'low']),
  makeupDetected: z.boolean(),
});

function validateGeminiResponse(raw: unknown) {
  const result = SkinAnalysisResponseSchema.safeParse(raw);
  if (!result.success) {
    throw new ValidationError('Invalid Gemini response', result.error);
  }
  return result.data;
}
```

### ëª¨ë¸ ë²„ì „ë³„ ì°¨ì´

| í•­ëª©        | Gemini 2.0 Flash | Gemini 3 Flash |
| ----------- | ---------------- | -------------- |
| ì‘ë‹µ ì¼ê´€ì„± | 70-80%           | 85-92%         |
| JSON ì¤€ìˆ˜ìœ¨ | 90%              | 97%            |
| í•œêµ­ì–´ í’ˆì§ˆ | ì–‘í˜¸             | ìš°ìˆ˜           |
| ë‹¤ì¤‘ ì´ë¯¸ì§€ | 2ê°œê¹Œì§€          | 4ê°œê¹Œì§€        |
| í‰ê·  ì§€ì—°   | 1.5s             | 1.2s           |
| í† í° íš¨ìœ¨   | ê¸°ì¤€             | +15% ê°œì„       |

**ë§ˆì´ê·¸ë ˆì´ì…˜ ì°¸ê³ **: Gemini 2.0 â†’ 3 ì „í™˜ ì‹œ í”„ë¡¬í”„íŠ¸ ìˆ˜ì • ë¶ˆí•„ìš”, ì‘ë‹µ í’ˆì§ˆ ìë™ í–¥ìƒ

---

## ë„ë©”ì¸ë³„ ì§€ì¹¨

### í”¼ë¶€ ë¶„ì„ (S-1)

**í”„ë¡¬í”„íŠ¸ í•„ìˆ˜ í¬í•¨ ìš”ì†Œ**:

- Tì¡´/Uì¡´ ë¶„ë¦¬ í‰ê°€
- ì¡°ëª… ì¡°ê±´ë³„ ì‹ ë¢°ë„ ì¡°ì • ë¡œì§
- ë©”ì´í¬ì—… ê°ì§€ ì‹œ `analysisReliability: "low"`
- ë‹¤í¬ì„œí´ì€ `pigmentation`ì´ ì•„ë‹Œ í˜ˆê´€ ê´€ë ¨ìœ¼ë¡œ ë¶„ë¥˜

**í˜„ì¬ í”„ë¡¬í”„íŠ¸**: `lib/gemini.ts` 314-412í–‰

### ì²´í˜• ë¶„ì„ (C-1)

**í”„ë¡¬í”„íŠ¸ í•„ìˆ˜ í¬í•¨ ìš”ì†Œ**:

- 5ê°œ íŠ¹ì§• ì¤‘ 4ê°œ ì´ìƒ ì¼ì¹˜ ì‹œ í™•ì • íŒì •
- ê³¨ê²© ê¸°ë°˜ íŒë‹¨ (ì‚´ì´ ì•„ë‹Œ ë¼ˆëŒ€)
- ì˜ë¥˜ í• ì˜í–¥ ê³ ë ¤ (ì˜¤ë²„í• â†’ ì‹ ë¢°ë„ ë‚®ì¶¤)
- ì‹ ë¢°ë„ ê¸°ì¤€: 5ê°œ ì¼ì¹˜=95%, 4ê°œ=85%, 3ê°œ=75%

**í˜„ì¬ í”„ë¡¬í”„íŠ¸**: `lib/gemini.ts` 418-534í–‰

### í¼ìŠ¤ë„ ì»¬ëŸ¬ (PC-1)

**í”„ë¡¬í”„íŠ¸ í•„ìˆ˜ í¬í•¨ ìš”ì†Œ**:

- ì†ëª© í˜ˆê´€ ìƒ‰ìƒ ìš°ì„  íŒì • (ìµœìš°ì„  ê¸°ì¤€)
- ì¡°ëª… ì™œê³¡ ë³´ì • ì„¤ëª… (ì¸ê³µê´‘ â†’ ë…¸ë—ê²Œ ë³´ì„)
- ì›œ/ì¿¨ íŒì • ê·¼ê±° ë°˜ë“œì‹œ ëª…ì‹œ
- í˜ˆê´€ìƒ‰ê³¼ tone ì¼ê´€ì„± ê²€ì¦

**í˜„ì¬ í”„ë¡¬í”„íŠ¸**: `lib/gemini.ts` 537-688í–‰

---

## ì¶œë ¥ ì¼ê´€ì„±

### JSON ìŠ¤í‚¤ë§ˆ ëª…ì‹œ

```
ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•´ì£¼ì„¸ìš” (ë‹¤ë¥¸ í…ìŠ¤íŠ¸ ì—†ì´ JSONë§Œ):

{
  "field1": [0-100 ì‚¬ì´ ì ìˆ˜],
  "field2": "[enumê°’1|enumê°’2|enumê°’3]",
  "nested": {
    "subField": "[ì„¤ëª…]"
  }
}
```

### ì ìˆ˜ ê¸°ì¤€ í‘œì¤€í™” (ì´ë£¸ ê³µí†µ)

```
ì ìˆ˜ ê¸°ì¤€ (0-100):
- 71-100: good (ì¢‹ìŒ)
- 41-70: normal (ë³´í†µ)
- 0-40: warning (ì£¼ì˜)

ì‹ ë¢°ë„ ê¸°ì¤€:
- high: ì´ë¯¸ì§€ í’ˆì§ˆ ì–‘í˜¸, ë¶„ì„ ì¡°ê±´ ì¶©ì¡±
- medium: ì¼ë¶€ ì œí•œ ìš”ì†Œ ìˆìŒ
- low: ì €í™”ì§ˆ/ë©”ì´í¬ì—…/ë¶€ì ì ˆí•œ ì¡°ëª…
```

---

## í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸

### ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ë™ì¼ ì´ë¯¸ì§€ì— ìœ ì‚¬í•œ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ”ê°€? (Â±5% ì¼ê´€ì„±)
- [ ] ì €í™”ì§ˆ ì´ë¯¸ì§€ì—ì„œ `analysisReliability: "low"` ì¶œë ¥?
- [ ] ë©”ì´í¬ì—… ì´ë¯¸ì§€ì—ì„œ `makeupDetected: true` ê°ì§€?
- [ ] JSON íŒŒì‹± ì˜¤ë¥˜ ì—†ì´ ì¶œë ¥ë˜ëŠ”ê°€?
- [ ] ëª¨ìˆœëœ íŒì •ì´ ì—†ëŠ”ê°€? (í˜ˆê´€ìƒ‰-í†¤ ì¼ì¹˜ ë“±)

### JSON íŒŒì‹± ë°©ì–´

```typescript
// Geminiê°€ JSON ì™¸ì— í…ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•  ê²½ìš° ëŒ€ë¹„
function parseJsonResponse<T>(text: string): T {
  // JSON ë¸”ë¡ ì¶”ì¶œ
  const match = text.match(/\{[\s\S]*\}/);
  if (!match) throw new Error('No JSON found in response');

  return JSON.parse(match[0]);
}
```

---

## ì°¸ê³  ìë£Œ

- [Anthropic Claude Best Practices](https://docs.claude.com/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices)
- [Google Gemini Prompt Strategies](https://ai.google.dev/gemini-api/docs/prompting-strategies)
- [OpenAI Prompt Engineering](https://platform.openai.com/docs/guides/prompt-engineering)
- [Chain-of-Thought Prompting Guide](https://www.promptingguide.ai/techniques/cot)
- [Multimodal VLM Prompt Guide](https://www.edge-ai-vision.com/2025/03/vision-language-model-prompt-engineering-guide-for-image-and-video-understanding/)

---

## ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ       | ë³€ê²½ ë‚´ìš©                                                           |
| ---- | ---------- | ------------------------------------------------------------------- |
| 1.3  | 2026-01-20 | Gemini 3 VLM ì‘ë‹µ ëª…ì„¸ ì„¹ì…˜ ì¶”ê°€ (+270ì¤„)                           |
| 1.2  | 2026-01-07 | TL;DR ì„¹ì…˜ ì¶”ê°€, ë³€ê²½ ì´ë ¥ ì¶”ê°€                                     |
| 1.1  | 2026-01-07 | í•œêµ­ì–´ í‘œì¤€ í™•ì •, ì‹¤ì „ í• ë£¨ì‹œë„¤ì´ì…˜ ì‚¬ë¡€ ì¶”ê°€, ë„ë©”ì¸ë³„ ì§€ì¹¨ ìƒì„¸í™” |
| 1.0  | 2026-01-07 | ì´ˆê¸° ë²„ì „ (ì›¹ ë¦¬ì„œì¹˜ ê¸°ë°˜)                                          |

---

**Version**: 1.3 | **Updated**: 2026-01-20
